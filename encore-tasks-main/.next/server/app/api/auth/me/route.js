/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/me/route";
exports.ids = ["app/api/auth/me/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fme%2Froute&page=%2Fapi%2Fauth%2Fme%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fme%2Froute.ts&appDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fme%2Froute&page=%2Fapi%2Fauth%2Fme%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fme%2Froute.ts&appDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var E_Projects_encore_tasks_encore_tasks_main_src_app_api_auth_me_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/auth/me/route.ts */ \"(rsc)/./src/app/api/auth/me/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([E_Projects_encore_tasks_encore_tasks_main_src_app_api_auth_me_route_ts__WEBPACK_IMPORTED_MODULE_3__]);\nE_Projects_encore_tasks_encore_tasks_main_src_app_api_auth_me_route_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/me/route\",\n        pathname: \"/api/auth/me\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/me/route\"\n    },\n    resolvedPagePath: \"E:\\\\Projects\\\\encore-tasks\\\\encore-tasks-main\\\\src\\\\app\\\\api\\\\auth\\\\me\\\\route.ts\",\n    nextConfigOutput,\n    userland: E_Projects_encore_tasks_encore_tasks_main_src_app_api_auth_me_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGbWUlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZtZSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZtZSUyRnJvdXRlLnRzJmFwcERpcj1FJTNBJTVDUHJvamVjdHMlNUNlbmNvcmUtdGFza3MlNUNlbmNvcmUtdGFza3MtbWFpbiU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RSUzQSU1Q1Byb2plY3RzJTVDZW5jb3JlLXRhc2tzJTVDZW5jb3JlLXRhc2tzLW1haW4maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ2dDO0FBQzdHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRixxQyIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJFOlxcXFxQcm9qZWN0c1xcXFxlbmNvcmUtdGFza3NcXFxcZW5jb3JlLXRhc2tzLW1haW5cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxtZVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9tZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvbWVcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvbWUvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJFOlxcXFxQcm9qZWN0c1xcXFxlbmNvcmUtdGFza3NcXFxcZW5jb3JlLXRhc2tzLW1haW5cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxtZVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fme%2Froute&page=%2Fapi%2Fauth%2Fme%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fme%2Froute.ts&appDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/auth/me/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/auth/me/route.ts ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n/* harmony import */ var _lib_database_adapter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/database-adapter */ \"(rsc)/./src/lib/database-adapter.ts\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_3__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_auth__WEBPACK_IMPORTED_MODULE_1__, _lib_database_adapter__WEBPACK_IMPORTED_MODULE_2__]);\n([_lib_auth__WEBPACK_IMPORTED_MODULE_1__, _lib_database_adapter__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\nconst databaseAdapter = _lib_database_adapter__WEBPACK_IMPORTED_MODULE_2__.dbAdapter;\n\n// Получение текущего пользователя\nasync function GET(request) {\n    try {\n        console.log('API /auth/me: Starting authentication verification');\n        const authResult = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.verifyAuth)(request);\n        console.log('API /auth/me: Auth result:', authResult.success ? 'success' : 'failed', authResult.error || '');\n        if (!authResult.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: authResult.error\n            }, {\n                status: 401\n            });\n        }\n        const { userId } = authResult.user;\n        console.log('API /auth/me: Getting user by ID:', userId);\n        const user = await databaseAdapter.getUserById(userId);\n        console.log('API /auth/me: User found:', user ? 'yes' : 'no');\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Пользователь не найден'\n            }, {\n                status: 404\n            });\n        }\n        // Преобразование в формат API с правильной типизацией\n        const userResult = {\n            id: user.id,\n            name: user.name,\n            email: user.email,\n            role: user.role,\n            status: 'active',\n            avatar: user.avatar || null,\n            createdAt: user.created_at,\n            updatedAt: user.updated_at\n        };\n        // Generate ETag based on user data\n        const etag = (0,crypto__WEBPACK_IMPORTED_MODULE_3__.createHash)('md5').update(JSON.stringify(userResult)).digest('hex');\n        // Check if client has cached version\n        const clientETag = request.headers.get('if-none-match');\n        if (clientETag === etag) {\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n                status: 304\n            });\n        }\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            user: userResult\n        });\n        // Set caching headers\n        response.headers.set('ETag', etag);\n        response.headers.set('Cache-Control', 'private, max-age=300, must-revalidate'); // 5 minutes\n        response.headers.set('Vary', 'Authorization, Cookie');\n        return response;\n    } catch (error) {\n        console.error('❌ API /auth/me: Critical error occurred:', error);\n        console.error('❌ API /auth/me: Error stack:', error instanceof Error ? error.stack : 'No stack trace');\n        console.error('❌ API /auth/me: Error message:', error instanceof Error ? error.message : String(error));\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Внутренняя ошибка сервера'\n        }, {\n            status: 500\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hdXRoL21lL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF3RDtBQUNoQjtBQUNXO0FBRW5ELE1BQU1HLGtCQUFrQkQsNERBQVNBO0FBQ0c7QUFFcEMsa0NBQWtDO0FBQzNCLGVBQWVHLElBQUlDLE9BQW9CO0lBQzVDLElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDO1FBQ1osTUFBTUMsYUFBYSxNQUFNUixxREFBVUEsQ0FBQ0s7UUFDcENDLFFBQVFDLEdBQUcsQ0FBQyw4QkFBOEJDLFdBQVdDLE9BQU8sR0FBRyxZQUFZLFVBQVVELFdBQVdFLEtBQUssSUFBSTtRQUV6RyxJQUFJLENBQUNGLFdBQVdDLE9BQU8sRUFBRTtZQUN2QixPQUFPVixxREFBWUEsQ0FBQ1ksSUFBSSxDQUN0QjtnQkFBRUQsT0FBT0YsV0FBV0UsS0FBSztZQUFDLEdBQzFCO2dCQUFFRSxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNLEVBQUVDLE1BQU0sRUFBRSxHQUFHTCxXQUFXTSxJQUFJO1FBQ2xDUixRQUFRQyxHQUFHLENBQUMscUNBQXFDTTtRQUNqRCxNQUFNQyxPQUFPLE1BQU1aLGdCQUFnQmEsV0FBVyxDQUFDRjtRQUMvQ1AsUUFBUUMsR0FBRyxDQUFDLDZCQUE2Qk8sT0FBTyxRQUFRO1FBRXhELElBQUksQ0FBQ0EsTUFBTTtZQUNULE9BQU9mLHFEQUFZQSxDQUFDWSxJQUFJLENBQ3RCO2dCQUFFRCxPQUFPO1lBQXlCLEdBQ2xDO2dCQUFFRSxRQUFRO1lBQUk7UUFFbEI7UUFFQSxzREFBc0Q7UUFDdEQsTUFBTUksYUFBYTtZQUNqQkMsSUFBSUgsS0FBS0csRUFBRTtZQUNYQyxNQUFNSixLQUFLSSxJQUFJO1lBQ2ZDLE9BQU9MLEtBQUtLLEtBQUs7WUFDakJDLE1BQU1OLEtBQUtNLElBQUk7WUFDZlIsUUFBUTtZQUNSUyxRQUFRUCxLQUFLTyxNQUFNLElBQUk7WUFDdkJDLFdBQVdSLEtBQUtTLFVBQVU7WUFDMUJDLFdBQVdWLEtBQUtXLFVBQVU7UUFDNUI7UUFFQSxtQ0FBbUM7UUFDbEMsTUFBTUMsT0FBT3ZCLGtEQUFVQSxDQUFDLE9BQ3JCd0IsTUFBTSxDQUFDQyxLQUFLQyxTQUFTLENBQUNiLGFBQ3RCYyxNQUFNLENBQUM7UUFFWCxxQ0FBcUM7UUFDckMsTUFBTUMsYUFBYTFCLFFBQVEyQixPQUFPLENBQUNDLEdBQUcsQ0FBQztRQUN2QyxJQUFJRixlQUFlTCxNQUFNO1lBQ3ZCLE9BQU8sSUFBSTNCLHFEQUFZQSxDQUFDLE1BQU07Z0JBQUVhLFFBQVE7WUFBSTtRQUM5QztRQUVBLE1BQU1zQixXQUFXbkMscURBQVlBLENBQUNZLElBQUksQ0FBQztZQUFFRyxNQUFNRTtRQUFXO1FBRXRELHNCQUFzQjtRQUN0QmtCLFNBQVNGLE9BQU8sQ0FBQ0csR0FBRyxDQUFDLFFBQVFUO1FBQzdCUSxTQUFTRixPQUFPLENBQUNHLEdBQUcsQ0FBQyxpQkFBaUIsMENBQTBDLFlBQVk7UUFDNUZELFNBQVNGLE9BQU8sQ0FBQ0csR0FBRyxDQUFDLFFBQVE7UUFFN0IsT0FBT0Q7SUFFVCxFQUFFLE9BQU94QixPQUFPO1FBQ2RKLFFBQVFJLEtBQUssQ0FBQyw0Q0FBNENBO1FBQzFESixRQUFRSSxLQUFLLENBQUMsZ0NBQWdDQSxpQkFBaUIwQixRQUFRMUIsTUFBTTJCLEtBQUssR0FBRztRQUNyRi9CLFFBQVFJLEtBQUssQ0FBQyxrQ0FBa0NBLGlCQUFpQjBCLFFBQVExQixNQUFNNEIsT0FBTyxHQUFHQyxPQUFPN0I7UUFDaEcsT0FBT1gscURBQVlBLENBQUNZLElBQUksQ0FDdEI7WUFBRUQsT0FBTztRQUE0QixHQUNyQztZQUFFRSxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsiRTpcXFByb2plY3RzXFxlbmNvcmUtdGFza3NcXGVuY29yZS10YXNrcy1tYWluXFxzcmNcXGFwcFxcYXBpXFxhdXRoXFxtZVxccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IHZlcmlmeUF1dGggfSBmcm9tICdAL2xpYi9hdXRoJztcbmltcG9ydCB7IGRiQWRhcHRlciB9IGZyb20gJ0AvbGliL2RhdGFiYXNlLWFkYXB0ZXInO1xuXG5jb25zdCBkYXRhYmFzZUFkYXB0ZXIgPSBkYkFkYXB0ZXI7XG5pbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnY3J5cHRvJztcblxuLy8g0J/QvtC70YPRh9C10L3QuNC1INGC0LXQutGD0YnQtdCz0L4g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ0FQSSAvYXV0aC9tZTogU3RhcnRpbmcgYXV0aGVudGljYXRpb24gdmVyaWZpY2F0aW9uJyk7XG4gICAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IHZlcmlmeUF1dGgocmVxdWVzdCk7XG4gICAgY29uc29sZS5sb2coJ0FQSSAvYXV0aC9tZTogQXV0aCByZXN1bHQ6JywgYXV0aFJlc3VsdC5zdWNjZXNzID8gJ3N1Y2Nlc3MnIDogJ2ZhaWxlZCcsIGF1dGhSZXN1bHQuZXJyb3IgfHwgJycpO1xuICAgIFxuICAgIGlmICghYXV0aFJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IGF1dGhSZXN1bHQuZXJyb3IgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHsgdXNlcklkIH0gPSBhdXRoUmVzdWx0LnVzZXIhO1xuICAgIGNvbnNvbGUubG9nKCdBUEkgL2F1dGgvbWU6IEdldHRpbmcgdXNlciBieSBJRDonLCB1c2VySWQpO1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBkYXRhYmFzZUFkYXB0ZXIuZ2V0VXNlckJ5SWQodXNlcklkKTtcbiAgICBjb25zb2xlLmxvZygnQVBJIC9hdXRoL21lOiBVc2VyIGZvdW5kOicsIHVzZXIgPyAneWVzJyA6ICdubycpO1xuICAgIFxuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAn0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC90LUg0L3QsNC50LTQtdC9JyB9LFxuICAgICAgICB7IHN0YXR1czogNDA0IH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8g0J/RgNC10L7QsdGA0LDQt9C+0LLQsNC90LjQtSDQsiDRhNC+0YDQvNCw0YIgQVBJINGBINC/0YDQsNCy0LjQu9GM0L3QvtC5INGC0LjQv9C40LfQsNGG0LjQtdC5XG4gICAgY29uc3QgdXNlclJlc3VsdCA9IHtcbiAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICByb2xlOiB1c2VyLnJvbGUsXG4gICAgICBzdGF0dXM6ICdhY3RpdmUnLFxuICAgICAgYXZhdGFyOiB1c2VyLmF2YXRhciB8fCBudWxsLFxuICAgICAgY3JlYXRlZEF0OiB1c2VyLmNyZWF0ZWRfYXQsXG4gICAgICB1cGRhdGVkQXQ6IHVzZXIudXBkYXRlZF9hdFxuICAgIH07XG5cbiAgICAvLyBHZW5lcmF0ZSBFVGFnIGJhc2VkIG9uIHVzZXIgZGF0YVxuICAgICBjb25zdCBldGFnID0gY3JlYXRlSGFzaCgnbWQ1JylcbiAgICAgICAudXBkYXRlKEpTT04uc3RyaW5naWZ5KHVzZXJSZXN1bHQpKVxuICAgICAgIC5kaWdlc3QoJ2hleCcpO1xuXG4gICAgLy8gQ2hlY2sgaWYgY2xpZW50IGhhcyBjYWNoZWQgdmVyc2lvblxuICAgIGNvbnN0IGNsaWVudEVUYWcgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdpZi1ub25lLW1hdGNoJyk7XG4gICAgaWYgKGNsaWVudEVUYWcgPT09IGV0YWcpIHtcbiAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKG51bGwsIHsgc3RhdHVzOiAzMDQgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UuanNvbih7IHVzZXI6IHVzZXJSZXN1bHQgfSk7XG4gICAgXG4gICAgLy8gU2V0IGNhY2hpbmcgaGVhZGVyc1xuICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdFVGFnJywgZXRhZyk7XG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCAncHJpdmF0ZSwgbWF4LWFnZT0zMDAsIG11c3QtcmV2YWxpZGF0ZScpOyAvLyA1IG1pbnV0ZXNcbiAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnVmFyeScsICdBdXRob3JpemF0aW9uLCBDb29raWUnKTtcbiAgICBcbiAgICByZXR1cm4gcmVzcG9uc2U7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgQVBJIC9hdXRoL21lOiBDcml0aWNhbCBlcnJvciBvY2N1cnJlZDonLCBlcnJvcik7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEFQSSAvYXV0aC9tZTogRXJyb3Igc3RhY2s6JywgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogJ05vIHN0YWNrIHRyYWNlJyk7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEFQSSAvYXV0aC9tZTogRXJyb3IgbWVzc2FnZTonLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcikpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICfQktC90YPRgtGA0LXQvdC90Y/RjyDQvtGI0LjQsdC60LAg0YHQtdGA0LLQtdGA0LAnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInZlcmlmeUF1dGgiLCJkYkFkYXB0ZXIiLCJkYXRhYmFzZUFkYXB0ZXIiLCJjcmVhdGVIYXNoIiwiR0VUIiwicmVxdWVzdCIsImNvbnNvbGUiLCJsb2ciLCJhdXRoUmVzdWx0Iiwic3VjY2VzcyIsImVycm9yIiwianNvbiIsInN0YXR1cyIsInVzZXJJZCIsInVzZXIiLCJnZXRVc2VyQnlJZCIsInVzZXJSZXN1bHQiLCJpZCIsIm5hbWUiLCJlbWFpbCIsInJvbGUiLCJhdmF0YXIiLCJjcmVhdGVkQXQiLCJjcmVhdGVkX2F0IiwidXBkYXRlZEF0IiwidXBkYXRlZF9hdCIsImV0YWciLCJ1cGRhdGUiLCJKU09OIiwic3RyaW5naWZ5IiwiZGlnZXN0IiwiY2xpZW50RVRhZyIsImhlYWRlcnMiLCJnZXQiLCJyZXNwb25zZSIsInNldCIsIkVycm9yIiwic3RhY2siLCJtZXNzYWdlIiwiU3RyaW5nIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/me/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/adapters/postgresql-adapter.ts":
/*!************************************************!*\
  !*** ./src/lib/adapters/postgresql-adapter.ts ***!
  \************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PostgreSQLAdapter: () => (/* binding */ PostgreSQLAdapter)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm/v4.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([pg__WEBPACK_IMPORTED_MODULE_0__]);\npg__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// =====================================================\n// POSTGRESQL ADAPTER FOR ENCORE TASKS\n// =====================================================\n\n\n\nclass PostgreSQLAdapter {\n    constructor(){\n        this.isInitialized = false;\n        this.pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n            host: process.env.DB_HOST || 'localhost',\n            port: parseInt(process.env.DB_PORT || '5432'),\n            database: process.env.DB_NAME || 'encore_tasks',\n            user: process.env.DB_USER || 'encore_user',\n            password: process.env.DB_PASSWORD || 'encore_password',\n            ssl: process.env.DB_SSL === 'true' ? {\n                rejectUnauthorized: false\n            } : false,\n            max: parseInt(process.env.DB_POOL_MAX || '20'),\n            idleTimeoutMillis: parseInt(process.env.DB_IDLE_TIMEOUT || '30000'),\n            connectionTimeoutMillis: parseInt(process.env.DB_CONNECTION_TIMEOUT || '2000')\n        });\n    }\n    async initialize() {\n        try {\n            // Test connection\n            const client = await this.pool.connect();\n            await client.query('SELECT NOW()');\n            client.release();\n            this.isInitialized = true;\n            console.log('✅ PostgreSQL adapter initialized successfully');\n        } catch (error) {\n            console.error('❌ PostgreSQL adapter initialization failed:', error);\n            throw error;\n        }\n    }\n    isConnected() {\n        return this.isInitialized;\n    }\n    async executeRawQuery(query, params = []) {\n        const client = await this.pool.connect();\n        try {\n            const result = await client.query(query, params);\n            return result;\n        } finally{\n            client.release();\n        }\n    }\n    async query(sql, params) {\n        return this.executeRawQuery(sql, params);\n    }\n    // =====================================================\n    // USER OPERATIONS\n    // =====================================================\n    async createUser(userData) {\n        const { email, password, name, role = 'user' } = userData;\n        const hashedPassword = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(password, 12);\n        const id = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n        const query = `\n      INSERT INTO users (id, email, password_hash, name, role, created_at, updated_at)\n      VALUES ($1, $2, $3, $4, $5, NOW(), NOW())\n      RETURNING id, email, name, role, created_at, updated_at\n    `;\n        const result = await this.executeRawQuery(query, [\n            id,\n            email,\n            hashedPassword,\n            name,\n            role\n        ]);\n        return result.rows[0];\n    }\n    async getUserById(id) {\n        const query = 'SELECT id, email, name, role, created_at, updated_at FROM users WHERE id = $1';\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rows[0] || null;\n    }\n    async getUserByEmail(email) {\n        const query = 'SELECT * FROM users WHERE email = $1';\n        const result = await this.executeRawQuery(query, [\n            email\n        ]);\n        return result.rows[0] || null;\n    }\n    async updateUser(id, userData) {\n        const fields = [];\n        const values = [];\n        let paramIndex = 1;\n        for (const [key, value] of Object.entries(userData)){\n            if (key === 'password') {\n                fields.push(`password_hash = $${paramIndex}`);\n                values.push(await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(value, 12));\n            } else if (key !== 'id') {\n                fields.push(`${key} = $${paramIndex}`);\n                values.push(value);\n            }\n            paramIndex++;\n        }\n        if (fields.length === 0) {\n            throw new Error('No fields to update');\n        }\n        fields.push(`updated_at = NOW()`);\n        values.push(id);\n        const query = `\n      UPDATE users \n      SET ${fields.join(', ')}\n      WHERE id = $${paramIndex}\n      RETURNING id, email, name, role, created_at, updated_at\n    `;\n        const result = await this.executeRawQuery(query, values);\n        return result.rows[0];\n    }\n    async deleteUser(id) {\n        const query = 'DELETE FROM users WHERE id = $1';\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    async getAllUsers() {\n        const query = 'SELECT id, email, name, role, created_at, updated_at FROM users ORDER BY created_at DESC';\n        const result = await this.executeRawQuery(query);\n        return result.rows;\n    }\n    // =====================================================\n    // SESSION OPERATIONS\n    // =====================================================\n    async createSession(sessionData) {\n        const { userId, user_id, token, expiresAt, expires_at } = sessionData;\n        const id = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n        // Поддерживаем оба формата названий полей\n        const userIdValue = userId || user_id;\n        const expiresAtValue = expiresAt || expires_at;\n        const query = `\n      INSERT INTO sessions (id, user_id, token, expires_at, created_at)\n      VALUES ($1, $2, $3, $4, NOW())\n      RETURNING *\n    `;\n        const result = await this.executeRawQuery(query, [\n            id,\n            userIdValue,\n            token,\n            expiresAtValue\n        ]);\n        return result.rows[0];\n    }\n    async getSessionByToken(token) {\n        const query = `\n      SELECT s.*, u.id as user_id, u.email, u.name, u.role\n      FROM sessions s\n      JOIN users u ON s.user_id = u.id\n      WHERE s.token = $1 AND s.expires_at > NOW()\n    `;\n        const result = await this.executeRawQuery(query, [\n            token\n        ]);\n        return result.rows[0] || null;\n    }\n    async deleteSession(token) {\n        const query = 'DELETE FROM sessions WHERE token = $1';\n        const result = await this.executeRawQuery(query, [\n            token\n        ]);\n        return result.rowCount > 0;\n    }\n    async deleteUserSessions(userId) {\n        const query = 'DELETE FROM sessions WHERE user_id = $1';\n        const result = await this.executeRawQuery(query, [\n            userId\n        ]);\n        return result.rowCount > 0;\n    }\n    // =====================================================\n    // PROJECT OPERATIONS\n    // =====================================================\n    async createProject(projectData) {\n        const { name, description, created_by, color, icon_url } = projectData;\n        const id = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n        const query = `\n      INSERT INTO projects (id, name, description, creator_id, color, icon, created_at, updated_at)\n      VALUES ($1, $2, $3, $4, $5, $6, NOW(), NOW())\n      RETURNING *\n    `;\n        const result = await this.executeRawQuery(query, [\n            id,\n            name,\n            description,\n            created_by,\n            color,\n            icon_url\n        ]);\n        return result.rows[0];\n    }\n    async getProjectById(id) {\n        const query = `\n      SELECT p.*, u.name as owner_name\n      FROM projects p\n      JOIN users u ON p.creator_id = u.id\n      WHERE p.id = $1\n    `;\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rows[0] || null;\n    }\n    async getUserProjects(userId) {\n        const query = `\n      SELECT p.*, u.name as owner_name\n      FROM projects p\n      JOIN users u ON p.creator_id = u.id\n      WHERE p.creator_id = $1\n      ORDER BY p.created_at DESC\n    `;\n        const result = await this.executeRawQuery(query, [\n            userId\n        ]);\n        return result.rows;\n    }\n    async updateProject(id, projectData) {\n        const fields = [];\n        const values = [];\n        let paramIndex = 1;\n        for (const [key, value] of Object.entries(projectData)){\n            if (key !== 'id') {\n                fields.push(`${key} = $${paramIndex}`);\n                values.push(value);\n                paramIndex++;\n            }\n        }\n        if (fields.length === 0) {\n            throw new Error('No fields to update');\n        }\n        fields.push(`updated_at = NOW()`);\n        values.push(id);\n        const query = `\n      UPDATE projects \n      SET ${fields.join(', ')}\n      WHERE id = $${paramIndex}\n      RETURNING *\n    `;\n        const result = await this.executeRawQuery(query, values);\n        return result.rows[0];\n    }\n    async deleteProject(id) {\n        const query = 'DELETE FROM projects WHERE id = $1';\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    // =====================================================\n    // BOARD OPERATIONS\n    // =====================================================\n    async createBoard(boardData) {\n        const { name, description, projectId, position } = boardData;\n        const id = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n        const query = `\n      INSERT INTO boards (id, name, description, project_id, created_at, updated_at)\n      VALUES ($1, $2, $3, $4, NOW(), NOW())\n      RETURNING *\n    `;\n        const result = await this.executeRawQuery(query, [\n            id,\n            name,\n            description,\n            projectId\n        ]);\n        return result.rows[0];\n    }\n    async getBoardById(id) {\n        const query = 'SELECT * FROM boards WHERE id = $1';\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rows[0] || null;\n    }\n    async getProjectBoards(projectId) {\n        const query = 'SELECT * FROM boards WHERE project_id = $1 ORDER BY created_at ASC';\n        const result = await this.executeRawQuery(query, [\n            projectId\n        ]);\n        return result.rows;\n    }\n    async updateBoard(id, updates) {\n        const fields = [];\n        const values = [];\n        let paramIndex = 1;\n        for (const [key, value] of Object.entries(updates)){\n            if (key !== 'id') {\n                fields.push(`${key} = $${paramIndex}`);\n                values.push(value);\n                paramIndex++;\n            }\n        }\n        if (fields.length === 0) {\n            throw new Error('No fields to update');\n        }\n        fields.push(`updated_at = NOW()`);\n        values.push(id);\n        const query = `\n      UPDATE boards \n      SET ${fields.join(', ')}\n      WHERE id = $${paramIndex}\n      RETURNING *\n    `;\n        const result = await this.executeRawQuery(query, values);\n        return result.rows[0];\n    }\n    async deleteBoard(id) {\n        const query = 'DELETE FROM boards WHERE id = $1';\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    // =====================================================\n    // COLUMN OPERATIONS\n    // =====================================================\n    async createColumn(columnData) {\n        const { name, boardId, position } = columnData;\n        const id = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n        const query = `\n      INSERT INTO columns (id, title, board_id, position, created_at, updated_at)\n      VALUES ($1, $2, $3, $4, NOW(), NOW())\n      RETURNING *\n    `;\n        const result = await this.executeRawQuery(query, [\n            id,\n            name,\n            boardId,\n            position || 0\n        ]);\n        return result.rows[0];\n    }\n    async getColumnById(id) {\n        const query = 'SELECT * FROM columns WHERE id = $1';\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rows[0] || null;\n    }\n    async getBoardColumns(boardId) {\n        const query = 'SELECT * FROM columns WHERE board_id = $1 ORDER BY position ASC, created_at ASC';\n        const result = await this.executeRawQuery(query, [\n            boardId\n        ]);\n        return result.rows;\n    }\n    async updateColumn(id, updates) {\n        const fields = [];\n        const values = [];\n        let paramIndex = 1;\n        for (const [key, value] of Object.entries(updates)){\n            if (key !== 'id') {\n                fields.push(`${key} = $${paramIndex}`);\n                values.push(value);\n                paramIndex++;\n            }\n        }\n        if (fields.length === 0) {\n            throw new Error('No fields to update');\n        }\n        fields.push(`updated_at = NOW()`);\n        values.push(id);\n        const query = `\n      UPDATE columns \n      SET ${fields.join(', ')}\n      WHERE id = $${paramIndex}\n      RETURNING *\n    `;\n        const result = await this.executeRawQuery(query, values);\n        return result.rows[0];\n    }\n    async deleteColumn(id) {\n        const query = 'DELETE FROM columns WHERE id = $1';\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    // =====================================================\n    // TASK OPERATIONS\n    // =====================================================\n    async createTask(taskData) {\n        const { title, description, columnId, projectId, assigneeId, priority, dueDate, position } = taskData;\n        const id = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n        const query = `\n      INSERT INTO tasks (id, title, description, column_id, project_id, assignee_id, priority, due_date, position, status, created_at, updated_at)\n      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, 'todo', NOW(), NOW())\n      RETURNING *\n    `;\n        const result = await this.executeRawQuery(query, [\n            id,\n            title,\n            description,\n            columnId,\n            projectId,\n            assigneeId,\n            priority || 'medium',\n            dueDate,\n            position || 0\n        ]);\n        return result.rows[0];\n    }\n    async getTaskById(id) {\n        const query = `\n      SELECT t.*, u.name as assignee_name, c.name as column_name\n      FROM tasks t\n      LEFT JOIN users u ON t.assignee_id = u.id\n      LEFT JOIN columns c ON t.column_id = c.id\n      WHERE t.id = $1\n    `;\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rows[0] || null;\n    }\n    async getProjectTasks(projectId) {\n        const query = `\n      SELECT t.*, u.name as assignee_name, c.name as column_name\n      FROM tasks t\n      LEFT JOIN users u ON t.assignee_id = u.id\n      LEFT JOIN columns c ON t.column_id = c.id\n      WHERE t.project_id = $1\n      ORDER BY t.position ASC, t.created_at ASC\n    `;\n        const result = await this.executeRawQuery(query, [\n            projectId\n        ]);\n        return result.rows;\n    }\n    async getBoardTasks(boardId) {\n        const query = `\n      SELECT t.*, u.name as assignee_name, c.name as column_name\n      FROM tasks t\n      LEFT JOIN users u ON t.assignee_id = u.id\n      LEFT JOIN columns c ON t.column_id = c.id\n      WHERE c.board_id = $1\n      ORDER BY t.position ASC, t.created_at ASC\n    `;\n        const result = await this.executeRawQuery(query, [\n            boardId\n        ]);\n        return result.rows;\n    }\n    async getColumnTasks(columnId) {\n        const query = `\n      SELECT t.*, u.name as assignee_name\n      FROM tasks t\n      LEFT JOIN users u ON t.assignee_id = u.id\n      WHERE t.column_id = $1\n      ORDER BY t.position ASC, t.created_at ASC\n    `;\n        const result = await this.executeRawQuery(query, [\n            columnId\n        ]);\n        return result.rows;\n    }\n    async updateTask(id, updates) {\n        const fields = [];\n        const values = [];\n        let paramIndex = 1;\n        for (const [key, value] of Object.entries(updates)){\n            if (key !== 'id') {\n                fields.push(`${key} = $${paramIndex}`);\n                values.push(value);\n                paramIndex++;\n            }\n        }\n        if (fields.length === 0) {\n            throw new Error('No fields to update');\n        }\n        fields.push(`updated_at = NOW()`);\n        values.push(id);\n        const query = `\n      UPDATE tasks \n      SET ${fields.join(', ')}\n      WHERE id = $${paramIndex}\n      RETURNING *\n    `;\n        const result = await this.executeRawQuery(query, values);\n        return result.rows[0];\n    }\n    async deleteTask(id) {\n        const query = 'DELETE FROM tasks WHERE id = $1';\n        const result = await this.executeRawQuery(query, [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    // =====================================================\n    // PROJECT ACCESS OPERATIONS\n    // =====================================================\n    async hasProjectAccess(userId, projectId) {\n        // Check if user is the creator of the project\n        const query = `\n      SELECT 1 FROM projects \n      WHERE id = $1 AND creator_id = $2\n    `;\n        const result = await this.executeRawQuery(query, [\n            projectId,\n            userId\n        ]);\n        return result.rows.length > 0;\n    }\n    async close() {\n        await this.pool.end();\n        this.isInitialized = false;\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FkYXB0ZXJzL3Bvc3RncmVzcWwtYWRhcHRlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLHdEQUF3RDtBQUN4RCxzQ0FBc0M7QUFDdEMsd0RBQXdEO0FBRWxCO0FBQ1I7QUFDTTtBQUU3QixNQUFNSTtJQUlYQyxhQUFjO2FBRk5DLGdCQUFnQjtRQUd0QixJQUFJLENBQUNDLElBQUksR0FBRyxJQUFJUCxvQ0FBSUEsQ0FBQztZQUNuQlEsTUFBTUMsUUFBUUMsR0FBRyxDQUFDQyxPQUFPLElBQUk7WUFDN0JDLE1BQU1DLFNBQVNKLFFBQVFDLEdBQUcsQ0FBQ0ksT0FBTyxJQUFJO1lBQ3RDQyxVQUFVTixRQUFRQyxHQUFHLENBQUNNLE9BQU8sSUFBSTtZQUNqQ0MsTUFBTVIsUUFBUUMsR0FBRyxDQUFDUSxPQUFPLElBQUk7WUFDN0JDLFVBQVVWLFFBQVFDLEdBQUcsQ0FBQ1UsV0FBVyxJQUFJO1lBQ3JDQyxLQUFLWixRQUFRQyxHQUFHLENBQUNZLE1BQU0sS0FBSyxTQUFTO2dCQUFFQyxvQkFBb0I7WUFBTSxJQUFJO1lBQ3JFQyxLQUFLWCxTQUFTSixRQUFRQyxHQUFHLENBQUNlLFdBQVcsSUFBSTtZQUN6Q0MsbUJBQW1CYixTQUFTSixRQUFRQyxHQUFHLENBQUNpQixlQUFlLElBQUk7WUFDM0RDLHlCQUF5QmYsU0FBU0osUUFBUUMsR0FBRyxDQUFDbUIscUJBQXFCLElBQUk7UUFDekU7SUFDRjtJQUVBLE1BQU1DLGFBQTRCO1FBQ2hDLElBQUk7WUFDRixrQkFBa0I7WUFDbEIsTUFBTUMsU0FBUyxNQUFNLElBQUksQ0FBQ3hCLElBQUksQ0FBQ3lCLE9BQU87WUFDdEMsTUFBTUQsT0FBT0UsS0FBSyxDQUFDO1lBQ25CRixPQUFPRyxPQUFPO1lBQ2QsSUFBSSxDQUFDNUIsYUFBYSxHQUFHO1lBQ3JCNkIsUUFBUUMsR0FBRyxDQUFDO1FBQ2QsRUFBRSxPQUFPQyxPQUFPO1lBQ2RGLFFBQVFFLEtBQUssQ0FBQywrQ0FBK0NBO1lB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Q3ZCO0FBQ0YiLCJzb3VyY2VzIjpbIkU6XFxQcm9qZWN0c1xcZW5jb3JlLXRhc2tzXFxlbmNvcmUtdGFza3MtbWFpblxcc3JjXFxsaWJcXGFkYXB0ZXJzXFxwb3N0Z3Jlc3FsLWFkYXB0ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBPU1RHUkVTUUwgQURBUFRFUiBGT1IgRU5DT1JFIFRBU0tTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgeyBQb29sLCBQb29sQ2xpZW50IH0gZnJvbSAncGcnO1xuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcyc7XG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcblxuZXhwb3J0IGNsYXNzIFBvc3RncmVTUUxBZGFwdGVyIHtcbiAgcHJpdmF0ZSBwb29sOiBQb29sO1xuICBwcml2YXRlIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnBvb2wgPSBuZXcgUG9vbCh7XG4gICAgICBob3N0OiBwcm9jZXNzLmVudi5EQl9IT1NUIHx8ICdsb2NhbGhvc3QnLFxuICAgICAgcG9ydDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREJfUE9SVCB8fCAnNTQzMicpLFxuICAgICAgZGF0YWJhc2U6IHByb2Nlc3MuZW52LkRCX05BTUUgfHwgJ2VuY29yZV90YXNrcycsXG4gICAgICB1c2VyOiBwcm9jZXNzLmVudi5EQl9VU0VSIHx8ICdlbmNvcmVfdXNlcicsXG4gICAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuREJfUEFTU1dPUkQgfHwgJ2VuY29yZV9wYXNzd29yZCcsXG4gICAgICBzc2w6IHByb2Nlc3MuZW52LkRCX1NTTCA9PT0gJ3RydWUnID8geyByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlIH0gOiBmYWxzZSxcbiAgICAgIG1heDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREJfUE9PTF9NQVggfHwgJzIwJyksXG4gICAgICBpZGxlVGltZW91dE1pbGxpczogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREJfSURMRV9USU1FT1VUIHx8ICczMDAwMCcpLFxuICAgICAgY29ubmVjdGlvblRpbWVvdXRNaWxsaXM6IHBhcnNlSW50KHByb2Nlc3MuZW52LkRCX0NPTk5FQ1RJT05fVElNRU9VVCB8fCAnMjAwMCcpLFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVGVzdCBjb25uZWN0aW9uXG4gICAgICBjb25zdCBjbGllbnQgPSBhd2FpdCB0aGlzLnBvb2wuY29ubmVjdCgpO1xuICAgICAgYXdhaXQgY2xpZW50LnF1ZXJ5KCdTRUxFQ1QgTk9XKCknKTtcbiAgICAgIGNsaWVudC5yZWxlYXNlKCk7XG4gICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgY29uc29sZS5sb2coJ+KchSBQb3N0Z3JlU1FMIGFkYXB0ZXIgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBQb3N0Z3JlU1FMIGFkYXB0ZXIgaW5pdGlhbGl6YXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGlzQ29ubmVjdGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmlzSW5pdGlhbGl6ZWQ7XG4gIH1cblxuICBhc3luYyBleGVjdXRlUmF3UXVlcnkocXVlcnk6IHN0cmluZywgcGFyYW1zOiBhbnlbXSA9IFtdKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBjbGllbnQgPSBhd2FpdCB0aGlzLnBvb2wuY29ubmVjdCgpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkocXVlcnksIHBhcmFtcyk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gZmluYWxseSB7XG4gICAgICBjbGllbnQucmVsZWFzZSgpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHF1ZXJ5KHNxbDogc3RyaW5nLCBwYXJhbXM/OiB1bmtub3duW10pOiBQcm9taXNlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLmV4ZWN1dGVSYXdRdWVyeShzcWwsIHBhcmFtcyBhcyBhbnlbXSk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBVU0VSIE9QRVJBVElPTlNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBjcmVhdGVVc2VyKHVzZXJEYXRhOiB7XG4gICAgZW1haWw6IHN0cmluZztcbiAgICBwYXNzd29yZDogc3RyaW5nO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICByb2xlPzogc3RyaW5nO1xuICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCwgbmFtZSwgcm9sZSA9ICd1c2VyJyB9ID0gdXNlckRhdGE7XG4gICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTIpO1xuICAgIGNvbnN0IGlkID0gdXVpZHY0KCk7XG5cbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIElOU0VSVCBJTlRPIHVzZXJzIChpZCwgZW1haWwsIHBhc3N3b3JkX2hhc2gsIG5hbWUsIHJvbGUsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQpXG4gICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCAkNSwgTk9XKCksIE5PVygpKVxuICAgICAgUkVUVVJOSU5HIGlkLCBlbWFpbCwgbmFtZSwgcm9sZSwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdFxuICAgIGA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgW2lkLCBlbWFpbCwgaGFzaGVkUGFzc3dvcmQsIG5hbWUsIHJvbGVdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH1cblxuICBhc3luYyBnZXRVc2VyQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBxdWVyeSA9ICdTRUxFQ1QgaWQsIGVtYWlsLCBuYW1lLCByb2xlLCBjcmVhdGVkX2F0LCB1cGRhdGVkX2F0IEZST00gdXNlcnMgV0hFUkUgaWQgPSAkMSc7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlUmF3UXVlcnkocXVlcnksIFtpZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xuICB9XG5cbiAgYXN5bmMgZ2V0VXNlckJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgcXVlcnkgPSAnU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSBlbWFpbCA9ICQxJztcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgW2VtYWlsXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdIHx8IG51bGw7XG4gIH1cblxuICBhc3luYyB1cGRhdGVVc2VyKGlkOiBzdHJpbmcsIHVzZXJEYXRhOiBQYXJ0aWFsPGFueT4pOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IGZpZWxkcyA9IFtdO1xuICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgIGxldCBwYXJhbUluZGV4ID0gMTtcblxuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHVzZXJEYXRhKSkge1xuICAgICAgaWYgKGtleSA9PT0gJ3Bhc3N3b3JkJykge1xuICAgICAgICBmaWVsZHMucHVzaChgcGFzc3dvcmRfaGFzaCA9ICQke3BhcmFtSW5kZXh9YCk7XG4gICAgICAgIHZhbHVlcy5wdXNoKGF3YWl0IGJjcnlwdC5oYXNoKHZhbHVlIGFzIHN0cmluZywgMTIpKTtcbiAgICAgIH0gZWxzZSBpZiAoa2V5ICE9PSAnaWQnKSB7XG4gICAgICAgIGZpZWxkcy5wdXNoKGAke2tleX0gPSAkJHtwYXJhbUluZGV4fWApO1xuICAgICAgICB2YWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICB9XG4gICAgICBwYXJhbUluZGV4Kys7XG4gICAgfVxuXG4gICAgaWYgKGZpZWxkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gZmllbGRzIHRvIHVwZGF0ZScpO1xuICAgIH1cblxuICAgIGZpZWxkcy5wdXNoKGB1cGRhdGVkX2F0ID0gTk9XKClgKTtcbiAgICB2YWx1ZXMucHVzaChpZCk7XG5cbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIFVQREFURSB1c2VycyBcbiAgICAgIFNFVCAke2ZpZWxkcy5qb2luKCcsICcpfVxuICAgICAgV0hFUkUgaWQgPSAkJHtwYXJhbUluZGV4fVxuICAgICAgUkVUVVJOSU5HIGlkLCBlbWFpbCwgbmFtZSwgcm9sZSwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdFxuICAgIGA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgdmFsdWVzKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH1cblxuICBhc3luYyBkZWxldGVVc2VyKGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBxdWVyeSA9ICdERUxFVEUgRlJPTSB1c2VycyBXSEVSRSBpZCA9ICQxJztcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgW2lkXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dDb3VudCA+IDA7XG4gIH1cblxuICBhc3luYyBnZXRBbGxVc2VycygpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgY29uc3QgcXVlcnkgPSAnU0VMRUNUIGlkLCBlbWFpbCwgbmFtZSwgcm9sZSwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdCBGUk9NIHVzZXJzIE9SREVSIEJZIGNyZWF0ZWRfYXQgREVTQyc7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlUmF3UXVlcnkocXVlcnkpO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFNFU1NJT04gT1BFUkFUSU9OU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGFzeW5jIGNyZWF0ZVNlc3Npb24oc2Vzc2lvbkRhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgeyB1c2VySWQsIHVzZXJfaWQsIHRva2VuLCBleHBpcmVzQXQsIGV4cGlyZXNfYXQgfSA9IHNlc3Npb25EYXRhO1xuICAgIGNvbnN0IGlkID0gdXVpZHY0KCk7XG4gICAgXG4gICAgLy8g0J/QvtC00LTQtdGA0LbQuNCy0LDQtdC8INC+0LHQsCDRhNC+0YDQvNCw0YLQsCDQvdCw0LfQstCw0L3QuNC5INC/0L7Qu9C10LlcbiAgICBjb25zdCB1c2VySWRWYWx1ZSA9IHVzZXJJZCB8fCB1c2VyX2lkO1xuICAgIGNvbnN0IGV4cGlyZXNBdFZhbHVlID0gZXhwaXJlc0F0IHx8IGV4cGlyZXNfYXQ7XG5cbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIElOU0VSVCBJTlRPIHNlc3Npb25zIChpZCwgdXNlcl9pZCwgdG9rZW4sIGV4cGlyZXNfYXQsIGNyZWF0ZWRfYXQpXG4gICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCBOT1coKSlcbiAgICAgIFJFVFVSTklORyAqXG4gICAgYDtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbaWQsIHVzZXJJZFZhbHVlLCB0b2tlbiwgZXhwaXJlc0F0VmFsdWVdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH1cblxuICBhc3luYyBnZXRTZXNzaW9uQnlUb2tlbih0b2tlbjogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIFNFTEVDVCBzLiosIHUuaWQgYXMgdXNlcl9pZCwgdS5lbWFpbCwgdS5uYW1lLCB1LnJvbGVcbiAgICAgIEZST00gc2Vzc2lvbnMgc1xuICAgICAgSk9JTiB1c2VycyB1IE9OIHMudXNlcl9pZCA9IHUuaWRcbiAgICAgIFdIRVJFIHMudG9rZW4gPSAkMSBBTkQgcy5leHBpcmVzX2F0ID4gTk9XKClcbiAgICBgO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbdG9rZW5dKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVNlc3Npb24odG9rZW46IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gJ0RFTEVURSBGUk9NIHNlc3Npb25zIFdIRVJFIHRva2VuID0gJDEnO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbdG9rZW5dKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVVzZXJTZXNzaW9ucyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gJ0RFTEVURSBGUk9NIHNlc3Npb25zIFdIRVJFIHVzZXJfaWQgPSAkMSc7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlUmF3UXVlcnkocXVlcnksIFt1c2VySWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFBST0pFQ1QgT1BFUkFUSU9OU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGFzeW5jIGNyZWF0ZVByb2plY3QocHJvamVjdERhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiwgY3JlYXRlZF9ieSwgY29sb3IsIGljb25fdXJsIH0gPSBwcm9qZWN0RGF0YTtcbiAgICBjb25zdCBpZCA9IHV1aWR2NCgpO1xuXG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBJTlNFUlQgSU5UTyBwcm9qZWN0cyAoaWQsIG5hbWUsIGRlc2NyaXB0aW9uLCBjcmVhdG9yX2lkLCBjb2xvciwgaWNvbiwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdClcbiAgICAgIFZBTFVFUyAoJDEsICQyLCAkMywgJDQsICQ1LCAkNiwgTk9XKCksIE5PVygpKVxuICAgICAgUkVUVVJOSU5HICpcbiAgICBgO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlUmF3UXVlcnkocXVlcnksIFtpZCwgbmFtZSwgZGVzY3JpcHRpb24sIGNyZWF0ZWRfYnksIGNvbG9yLCBpY29uX3VybF0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfVxuXG4gIGFzeW5jIGdldFByb2plY3RCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gYFxuICAgICAgU0VMRUNUIHAuKiwgdS5uYW1lIGFzIG93bmVyX25hbWVcbiAgICAgIEZST00gcHJvamVjdHMgcFxuICAgICAgSk9JTiB1c2VycyB1IE9OIHAuY3JlYXRvcl9pZCA9IHUuaWRcbiAgICAgIFdIRVJFIHAuaWQgPSAkMVxuICAgIGA7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlUmF3UXVlcnkocXVlcnksIFtpZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xuICB9XG5cbiAgYXN5bmMgZ2V0VXNlclByb2plY3RzKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gYFxuICAgICAgU0VMRUNUIHAuKiwgdS5uYW1lIGFzIG93bmVyX25hbWVcbiAgICAgIEZST00gcHJvamVjdHMgcFxuICAgICAgSk9JTiB1c2VycyB1IE9OIHAuY3JlYXRvcl9pZCA9IHUuaWRcbiAgICAgIFdIRVJFIHAuY3JlYXRvcl9pZCA9ICQxXG4gICAgICBPUkRFUiBCWSBwLmNyZWF0ZWRfYXQgREVTQ1xuICAgIGA7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlUmF3UXVlcnkocXVlcnksIFt1c2VySWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gIH1cblxuICBhc3luYyB1cGRhdGVQcm9qZWN0KGlkOiBzdHJpbmcsIHByb2plY3REYXRhOiBQYXJ0aWFsPGFueT4pOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IGZpZWxkcyA9IFtdO1xuICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgIGxldCBwYXJhbUluZGV4ID0gMTtcblxuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHByb2plY3REYXRhKSkge1xuICAgICAgaWYgKGtleSAhPT0gJ2lkJykge1xuICAgICAgICBmaWVsZHMucHVzaChgJHtrZXl9ID0gJCR7cGFyYW1JbmRleH1gKTtcbiAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICBwYXJhbUluZGV4Kys7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZpZWxkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gZmllbGRzIHRvIHVwZGF0ZScpO1xuICAgIH1cblxuICAgIGZpZWxkcy5wdXNoKGB1cGRhdGVkX2F0ID0gTk9XKClgKTtcbiAgICB2YWx1ZXMucHVzaChpZCk7XG5cbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIFVQREFURSBwcm9qZWN0cyBcbiAgICAgIFNFVCAke2ZpZWxkcy5qb2luKCcsICcpfVxuICAgICAgV0hFUkUgaWQgPSAkJHtwYXJhbUluZGV4fVxuICAgICAgUkVUVVJOSU5HICpcbiAgICBgO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlUmF3UXVlcnkocXVlcnksIHZhbHVlcyk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlUHJvamVjdChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgcXVlcnkgPSAnREVMRVRFIEZST00gcHJvamVjdHMgV0hFUkUgaWQgPSAkMSc7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlUmF3UXVlcnkocXVlcnksIFtpZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93Q291bnQgPiAwO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQk9BUkQgT1BFUkFUSU9OU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGFzeW5jIGNyZWF0ZUJvYXJkKGJvYXJkRGF0YTogYW55KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uLCBwcm9qZWN0SWQsIHBvc2l0aW9uIH0gPSBib2FyZERhdGE7XG4gICAgY29uc3QgaWQgPSB1dWlkdjQoKTtcblxuICAgIGNvbnN0IHF1ZXJ5ID0gYFxuICAgICAgSU5TRVJUIElOVE8gYm9hcmRzIChpZCwgbmFtZSwgZGVzY3JpcHRpb24sIHByb2plY3RfaWQsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQpXG4gICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCBOT1coKSwgTk9XKCkpXG4gICAgICBSRVRVUk5JTkcgKlxuICAgIGA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgW2lkLCBuYW1lLCBkZXNjcmlwdGlvbiwgcHJvamVjdElkXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9XG5cbiAgYXN5bmMgZ2V0Qm9hcmRCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gYm9hcmRzIFdIRVJFIGlkID0gJDEnO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbaWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGdldFByb2plY3RCb2FyZHMocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgY29uc3QgcXVlcnkgPSAnU0VMRUNUICogRlJPTSBib2FyZHMgV0hFUkUgcHJvamVjdF9pZCA9ICQxIE9SREVSIEJZIGNyZWF0ZWRfYXQgQVNDJztcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgW3Byb2plY3RJZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZUJvYXJkKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8YW55Pik6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgZmllbGRzID0gW107XG4gICAgY29uc3QgdmFsdWVzID0gW107XG4gICAgbGV0IHBhcmFtSW5kZXggPSAxO1xuXG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModXBkYXRlcykpIHtcbiAgICAgIGlmIChrZXkgIT09ICdpZCcpIHtcbiAgICAgICAgZmllbGRzLnB1c2goYCR7a2V5fSA9ICQke3BhcmFtSW5kZXh9YCk7XG4gICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgcGFyYW1JbmRleCsrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChmaWVsZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGZpZWxkcyB0byB1cGRhdGUnKTtcbiAgICB9XG5cbiAgICBmaWVsZHMucHVzaChgdXBkYXRlZF9hdCA9IE5PVygpYCk7XG4gICAgdmFsdWVzLnB1c2goaWQpO1xuXG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBVUERBVEUgYm9hcmRzIFxuICAgICAgU0VUICR7ZmllbGRzLmpvaW4oJywgJyl9XG4gICAgICBXSEVSRSBpZCA9ICQke3BhcmFtSW5kZXh9XG4gICAgICBSRVRVUk5JTkcgKlxuICAgIGA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgdmFsdWVzKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH1cblxuICBhc3luYyBkZWxldGVCb2FyZChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgcXVlcnkgPSAnREVMRVRFIEZST00gYm9hcmRzIFdIRVJFIGlkID0gJDEnO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbaWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIENPTFVNTiBPUEVSQVRJT05TXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgYXN5bmMgY3JlYXRlQ29sdW1uKGNvbHVtbkRhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgeyBuYW1lLCBib2FyZElkLCBwb3NpdGlvbiB9ID0gY29sdW1uRGF0YTtcbiAgICBjb25zdCBpZCA9IHV1aWR2NCgpO1xuXG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBJTlNFUlQgSU5UTyBjb2x1bW5zIChpZCwgdGl0bGUsIGJvYXJkX2lkLCBwb3NpdGlvbiwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdClcbiAgICAgIFZBTFVFUyAoJDEsICQyLCAkMywgJDQsIE5PVygpLCBOT1coKSlcbiAgICAgIFJFVFVSTklORyAqXG4gICAgYDtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbaWQsIG5hbWUsIGJvYXJkSWQsIHBvc2l0aW9uIHx8IDBdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH1cblxuICBhc3luYyBnZXRDb2x1bW5CeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gY29sdW1ucyBXSEVSRSBpZCA9ICQxJztcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgW2lkXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdIHx8IG51bGw7XG4gIH1cblxuICBhc3luYyBnZXRCb2FyZENvbHVtbnMoYm9hcmRJZDogc3RyaW5nKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gY29sdW1ucyBXSEVSRSBib2FyZF9pZCA9ICQxIE9SREVSIEJZIHBvc2l0aW9uIEFTQywgY3JlYXRlZF9hdCBBU0MnO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbYm9hcmRJZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZUNvbHVtbihpZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPGFueT4pOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IGZpZWxkcyA9IFtdO1xuICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgIGxldCBwYXJhbUluZGV4ID0gMTtcblxuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHVwZGF0ZXMpKSB7XG4gICAgICBpZiAoa2V5ICE9PSAnaWQnKSB7XG4gICAgICAgIGZpZWxkcy5wdXNoKGAke2tleX0gPSAkJHtwYXJhbUluZGV4fWApO1xuICAgICAgICB2YWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgIHBhcmFtSW5kZXgrKztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZmllbGRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBmaWVsZHMgdG8gdXBkYXRlJyk7XG4gICAgfVxuXG4gICAgZmllbGRzLnB1c2goYHVwZGF0ZWRfYXQgPSBOT1coKWApO1xuICAgIHZhbHVlcy5wdXNoKGlkKTtcblxuICAgIGNvbnN0IHF1ZXJ5ID0gYFxuICAgICAgVVBEQVRFIGNvbHVtbnMgXG4gICAgICBTRVQgJHtmaWVsZHMuam9pbignLCAnKX1cbiAgICAgIFdIRVJFIGlkID0gJCR7cGFyYW1JbmRleH1cbiAgICAgIFJFVFVSTklORyAqXG4gICAgYDtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCB2YWx1ZXMpO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZUNvbHVtbihpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgcXVlcnkgPSAnREVMRVRFIEZST00gY29sdW1ucyBXSEVSRSBpZCA9ICQxJztcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgW2lkXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dDb3VudCA+IDA7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBUQVNLIE9QRVJBVElPTlNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBjcmVhdGVUYXNrKHRhc2tEYXRhOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHsgdGl0bGUsIGRlc2NyaXB0aW9uLCBjb2x1bW5JZCwgcHJvamVjdElkLCBhc3NpZ25lZUlkLCBwcmlvcml0eSwgZHVlRGF0ZSwgcG9zaXRpb24gfSA9IHRhc2tEYXRhO1xuICAgIGNvbnN0IGlkID0gdXVpZHY0KCk7XG5cbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIElOU0VSVCBJTlRPIHRhc2tzIChpZCwgdGl0bGUsIGRlc2NyaXB0aW9uLCBjb2x1bW5faWQsIHByb2plY3RfaWQsIGFzc2lnbmVlX2lkLCBwcmlvcml0eSwgZHVlX2RhdGUsIHBvc2l0aW9uLCBzdGF0dXMsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQpXG4gICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCAkNSwgJDYsICQ3LCAkOCwgJDksICd0b2RvJywgTk9XKCksIE5PVygpKVxuICAgICAgUkVUVVJOSU5HICpcbiAgICBgO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlUmF3UXVlcnkocXVlcnksIFtcbiAgICAgIGlkLCB0aXRsZSwgZGVzY3JpcHRpb24sIGNvbHVtbklkLCBwcm9qZWN0SWQsIGFzc2lnbmVlSWQsIHByaW9yaXR5IHx8ICdtZWRpdW0nLCBkdWVEYXRlLCBwb3NpdGlvbiB8fCAwXG4gICAgXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9XG5cbiAgYXN5bmMgZ2V0VGFza0J5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBTRUxFQ1QgdC4qLCB1Lm5hbWUgYXMgYXNzaWduZWVfbmFtZSwgYy5uYW1lIGFzIGNvbHVtbl9uYW1lXG4gICAgICBGUk9NIHRhc2tzIHRcbiAgICAgIExFRlQgSk9JTiB1c2VycyB1IE9OIHQuYXNzaWduZWVfaWQgPSB1LmlkXG4gICAgICBMRUZUIEpPSU4gY29sdW1ucyBjIE9OIHQuY29sdW1uX2lkID0gYy5pZFxuICAgICAgV0hFUkUgdC5pZCA9ICQxXG4gICAgYDtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgW2lkXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdIHx8IG51bGw7XG4gIH1cblxuICBhc3luYyBnZXRQcm9qZWN0VGFza3MocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBTRUxFQ1QgdC4qLCB1Lm5hbWUgYXMgYXNzaWduZWVfbmFtZSwgYy5uYW1lIGFzIGNvbHVtbl9uYW1lXG4gICAgICBGUk9NIHRhc2tzIHRcbiAgICAgIExFRlQgSk9JTiB1c2VycyB1IE9OIHQuYXNzaWduZWVfaWQgPSB1LmlkXG4gICAgICBMRUZUIEpPSU4gY29sdW1ucyBjIE9OIHQuY29sdW1uX2lkID0gYy5pZFxuICAgICAgV0hFUkUgdC5wcm9qZWN0X2lkID0gJDFcbiAgICAgIE9SREVSIEJZIHQucG9zaXRpb24gQVNDLCB0LmNyZWF0ZWRfYXQgQVNDXG4gICAgYDtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgW3Byb2plY3RJZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfVxuXG4gIGFzeW5jIGdldEJvYXJkVGFza3MoYm9hcmRJZDogc3RyaW5nKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gYFxuICAgICAgU0VMRUNUIHQuKiwgdS5uYW1lIGFzIGFzc2lnbmVlX25hbWUsIGMubmFtZSBhcyBjb2x1bW5fbmFtZVxuICAgICAgRlJPTSB0YXNrcyB0XG4gICAgICBMRUZUIEpPSU4gdXNlcnMgdSBPTiB0LmFzc2lnbmVlX2lkID0gdS5pZFxuICAgICAgTEVGVCBKT0lOIGNvbHVtbnMgYyBPTiB0LmNvbHVtbl9pZCA9IGMuaWRcbiAgICAgIFdIRVJFIGMuYm9hcmRfaWQgPSAkMVxuICAgICAgT1JERVIgQlkgdC5wb3NpdGlvbiBBU0MsIHQuY3JlYXRlZF9hdCBBU0NcbiAgICBgO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbYm9hcmRJZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfVxuXG4gIGFzeW5jIGdldENvbHVtblRhc2tzKGNvbHVtbklkOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBTRUxFQ1QgdC4qLCB1Lm5hbWUgYXMgYXNzaWduZWVfbmFtZVxuICAgICAgRlJPTSB0YXNrcyB0XG4gICAgICBMRUZUIEpPSU4gdXNlcnMgdSBPTiB0LmFzc2lnbmVlX2lkID0gdS5pZFxuICAgICAgV0hFUkUgdC5jb2x1bW5faWQgPSAkMVxuICAgICAgT1JERVIgQlkgdC5wb3NpdGlvbiBBU0MsIHQuY3JlYXRlZF9hdCBBU0NcbiAgICBgO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbY29sdW1uSWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gIH1cblxuICBhc3luYyB1cGRhdGVUYXNrKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8YW55Pik6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3QgZmllbGRzID0gW107XG4gICAgY29uc3QgdmFsdWVzID0gW107XG4gICAgbGV0IHBhcmFtSW5kZXggPSAxO1xuXG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModXBkYXRlcykpIHtcbiAgICAgIGlmIChrZXkgIT09ICdpZCcpIHtcbiAgICAgICAgZmllbGRzLnB1c2goYCR7a2V5fSA9ICQke3BhcmFtSW5kZXh9YCk7XG4gICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgcGFyYW1JbmRleCsrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChmaWVsZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGZpZWxkcyB0byB1cGRhdGUnKTtcbiAgICB9XG5cbiAgICBmaWVsZHMucHVzaChgdXBkYXRlZF9hdCA9IE5PVygpYCk7XG4gICAgdmFsdWVzLnB1c2goaWQpO1xuXG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBVUERBVEUgdGFza3MgXG4gICAgICBTRVQgJHtmaWVsZHMuam9pbignLCAnKX1cbiAgICAgIFdIRVJFIGlkID0gJCR7cGFyYW1JbmRleH1cbiAgICAgIFJFVFVSTklORyAqXG4gICAgYDtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCB2YWx1ZXMpO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVRhc2soaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gJ0RFTEVURSBGUk9NIHRhc2tzIFdIRVJFIGlkID0gJDEnO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbaWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFBST0pFQ1QgQUNDRVNTIE9QRVJBVElPTlNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBoYXNQcm9qZWN0QWNjZXNzKHVzZXJJZDogc3RyaW5nLCBwcm9qZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIC8vIENoZWNrIGlmIHVzZXIgaXMgdGhlIGNyZWF0b3Igb2YgdGhlIHByb2plY3RcbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIFNFTEVDVCAxIEZST00gcHJvamVjdHMgXG4gICAgICBXSEVSRSBpZCA9ICQxIEFORCBjcmVhdG9yX2lkID0gJDJcbiAgICBgO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KHF1ZXJ5LCBbcHJvamVjdElkLCB1c2VySWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3MubGVuZ3RoID4gMDtcbiAgfVxuXG4gIGFzeW5jIGNsb3NlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMucG9vbC5lbmQoKTtcbiAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgfVxufSJdLCJuYW1lcyI6WyJQb29sIiwiYmNyeXB0IiwidjQiLCJ1dWlkdjQiLCJQb3N0Z3JlU1FMQWRhcHRlciIsImNvbnN0cnVjdG9yIiwiaXNJbml0aWFsaXplZCIsInBvb2wiLCJob3N0IiwicHJvY2VzcyIsImVudiIsIkRCX0hPU1QiLCJwb3J0IiwicGFyc2VJbnQiLCJEQl9QT1JUIiwiZGF0YWJhc2UiLCJEQl9OQU1FIiwidXNlciIsIkRCX1VTRVIiLCJwYXNzd29yZCIsIkRCX1BBU1NXT1JEIiwic3NsIiwiREJfU1NMIiwicmVqZWN0VW5hdXRob3JpemVkIiwibWF4IiwiREJfUE9PTF9NQVgiLCJpZGxlVGltZW91dE1pbGxpcyIsIkRCX0lETEVfVElNRU9VVCIsImNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzIiwiREJfQ09OTkVDVElPTl9USU1FT1VUIiwiaW5pdGlhbGl6ZSIsImNsaWVudCIsImNvbm5lY3QiLCJxdWVyeSIsInJlbGVhc2UiLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiLCJpc0Nvbm5lY3RlZCIsImV4ZWN1dGVSYXdRdWVyeSIsInBhcmFtcyIsInJlc3VsdCIsInNxbCIsImNyZWF0ZVVzZXIiLCJ1c2VyRGF0YSIsImVtYWlsIiwibmFtZSIsInJvbGUiLCJoYXNoZWRQYXNzd29yZCIsImhhc2giLCJpZCIsInJvd3MiLCJnZXRVc2VyQnlJZCIsImdldFVzZXJCeUVtYWlsIiwidXBkYXRlVXNlciIsImZpZWxkcyIsInZhbHVlcyIsInBhcmFtSW5kZXgiLCJrZXkiLCJ2YWx1ZSIsIk9iamVjdCIsImVudHJpZXMiLCJwdXNoIiwibGVuZ3RoIiwiRXJyb3IiLCJqb2luIiwiZGVsZXRlVXNlciIsInJvd0NvdW50IiwiZ2V0QWxsVXNlcnMiLCJjcmVhdGVTZXNzaW9uIiwic2Vzc2lvbkRhdGEiLCJ1c2VySWQiLCJ1c2VyX2lkIiwidG9rZW4iLCJleHBpcmVzQXQiLCJleHBpcmVzX2F0IiwidXNlcklkVmFsdWUiLCJleHBpcmVzQXRWYWx1ZSIsImdldFNlc3Npb25CeVRva2VuIiwiZGVsZXRlU2Vzc2lvbiIsImRlbGV0ZVVzZXJTZXNzaW9ucyIsImNyZWF0ZVByb2plY3QiLCJwcm9qZWN0RGF0YSIsImRlc2NyaXB0aW9uIiwiY3JlYXRlZF9ieSIsImNvbG9yIiwiaWNvbl91cmwiLCJnZXRQcm9qZWN0QnlJZCIsImdldFVzZXJQcm9qZWN0cyIsInVwZGF0ZVByb2plY3QiLCJkZWxldGVQcm9qZWN0IiwiY3JlYXRlQm9hcmQiLCJib2FyZERhdGEiLCJwcm9qZWN0SWQiLCJwb3NpdGlvbiIsImdldEJvYXJkQnlJZCIsImdldFByb2plY3RCb2FyZHMiLCJ1cGRhdGVCb2FyZCIsInVwZGF0ZXMiLCJkZWxldGVCb2FyZCIsImNyZWF0ZUNvbHVtbiIsImNvbHVtbkRhdGEiLCJib2FyZElkIiwiZ2V0Q29sdW1uQnlJZCIsImdldEJvYXJkQ29sdW1ucyIsInVwZGF0ZUNvbHVtbiIsImRlbGV0ZUNvbHVtbiIsImNyZWF0ZVRhc2siLCJ0YXNrRGF0YSIsInRpdGxlIiwiY29sdW1uSWQiLCJhc3NpZ25lZUlkIiwicHJpb3JpdHkiLCJkdWVEYXRlIiwiZ2V0VGFza0J5SWQiLCJnZXRQcm9qZWN0VGFza3MiLCJnZXRCb2FyZFRhc2tzIiwiZ2V0Q29sdW1uVGFza3MiLCJ1cGRhdGVUYXNrIiwiZGVsZXRlVGFzayIsImhhc1Byb2plY3RBY2Nlc3MiLCJjbG9zZSIsImVuZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/adapters/postgresql-adapter.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   requireAdmin: () => (/* binding */ requireAdmin),\n/* harmony export */   verifyAuth: () => (/* binding */ verifyAuth),\n/* harmony export */   verifyProjectAccess: () => (/* binding */ verifyProjectAccess)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _database_adapter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./database-adapter */ \"(rsc)/./src/lib/database-adapter.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_database_adapter__WEBPACK_IMPORTED_MODULE_1__]);\n_database_adapter__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nconst databaseAdapter = _database_adapter__WEBPACK_IMPORTED_MODULE_1__.dbAdapter;\nasync function verifyAuth(request) {\n    try {\n        // Отладка: показать все cookies\n        console.log('=== DEBUG COOKIES ===');\n        console.log('All cookies:', request.cookies.getAll());\n        console.log('Cookie names:', request.cookies.getAll().map((c)=>c.name));\n        console.log('auth-token cookie:', request.cookies.get('auth-token'));\n        console.log('auth-token-client cookie:', request.cookies.get('auth-token-client'));\n        console.log('Authorization header:', request.headers.get('authorization'));\n        // Получение токена из cookie или заголовка Authorization\n        const token = request.cookies.get('auth-token')?.value || request.cookies.get('auth-token-client')?.value || request.headers.get('authorization')?.replace('Bearer ', '');\n        console.log('Auth token found:', !!token);\n        console.log('Token value (first 20 chars):', token ? token.substring(0, 20) + '...' : 'null');\n        if (!token) {\n            console.log('No auth token found in cookies or headers');\n            return {\n                success: false,\n                error: 'Токен аутентификации не найден'\n            };\n        }\n        // Проверяем JWT токен\n        let decoded;\n        const jwtSecret = process.env.JWT_SECRET || 'your-secret-key';\n        try {\n            console.log('🔍 Проверяем JWT токен:', token.substring(0, 20) + '...');\n            decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, jwtSecret);\n            console.log('🔓 JWT токен успешно декодирован:', {\n                userId: decoded.userId,\n                email: decoded.email\n            });\n        } catch (error) {\n            console.log('❌ Ошибка декодирования JWT токена:', error);\n            console.log('🔑 Используемый JWT_SECRET:', jwtSecret);\n            return {\n                success: false,\n                error: 'Invalid token'\n            };\n        }\n        // Используем оптимизированный адаптер для работы с сессиями\n        await databaseAdapter.initialize();\n        try {\n            // Ищем сессию через адаптер\n            const session = await databaseAdapter.getSessionByToken(token);\n            console.log('Session found:', !!session);\n            console.log('Session object:', session);\n            console.log('Session userId:', session?.user_id);\n            if (!session) {\n                console.log('❌ Session not found in database for token');\n                return {\n                    success: false,\n                    error: 'Сессия не найдена или истекла'\n                };\n            }\n            // Verify that the JWT userId matches the session user_id\n            if (decoded.userId !== session.user_id) {\n                console.log('❌ JWT userId does not match session user_id');\n                return {\n                    success: false,\n                    error: 'Несоответствие данных токена и сессии'\n                };\n            }\n            // Получаем пользователя через адаптер\n            const user = await databaseAdapter.getUserById(session.user_id);\n            if (!user) {\n                return {\n                    success: false,\n                    error: 'Пользователь не найден'\n                };\n            }\n            // Проверяем статус одобрения пользователя\n            console.log('User data:', user);\n            console.log('User approval_status:', user.approval_status, 'type:', typeof user.approval_status);\n            console.log('User isApproved:', user.isApproved, 'type:', typeof user.isApproved);\n            console.log('User role:', user.role);\n            // Используем approval_status для SQLite или isApproved для других БД\n            const isApproved = user.approval_status !== undefined ? Boolean(user.approval_status) : user.isApproved !== undefined ? Boolean(user.isApproved) : true;\n            console.log('Final isApproved:', isApproved);\n            if (!isApproved && user.role !== 'admin') {\n                console.log('User not approved and not admin');\n                return {\n                    success: false,\n                    error: 'Пользователь не одобрен'\n                };\n            }\n            return {\n                success: true,\n                user: {\n                    userId: String(user.id),\n                    email: user.email,\n                    role: user.role,\n                    name: user.name\n                }\n            };\n        } catch (error) {\n            console.error('Auth error:', error);\n            return {\n                success: false,\n                error: 'Ошибка аутентификации'\n            };\n        }\n    } catch (error) {\n        console.error('Ошибка проверки аутентификации:', error);\n        return {\n            success: false,\n            error: 'Внутренняя ошибка сервера'\n        };\n    }\n}\n// Проверка прав доступа к проекту\nasync function verifyProjectAccess(userId, projectId, requiredRole) {\n    try {\n        await databaseAdapter.initialize();\n        // Получаем проекты через адаптер\n        const projects = await databaseAdapter.getAllProjects();\n        const project = projects.find((p)=>p.id === projectId);\n        if (!project) {\n            return {\n                hasAccess: false\n            };\n        }\n        // Проверяем, является ли пользователь владельцем\n        if (project.created_by === userId) {\n            return {\n                hasAccess: true,\n                userRole: 'owner'\n            };\n        }\n        // Получаем участников проекта через getUserProjects\n        const userProjects = await databaseAdapter.getUserProjects(userId);\n        const hasAccess = userProjects.some((p)=>p.id === projectId);\n        if (!hasAccess) {\n            return {\n                hasAccess: false\n            };\n        }\n        // Для упрощения, считаем что у пользователя есть доступ как участник\n        const userRole = 'member';\n        // Проверка требуемой роли\n        if (requiredRole) {\n            const roleHierarchy = {\n                owner: 3,\n                admin: 2,\n                member: 1\n            };\n            const userRoleLevel = roleHierarchy[userRole] || 0;\n            const requiredRoleLevel = roleHierarchy[requiredRole];\n            if (userRoleLevel < requiredRoleLevel) {\n                return {\n                    hasAccess: false,\n                    userRole\n                };\n            }\n        }\n        return {\n            hasAccess: true,\n            userRole\n        };\n    } catch (error) {\n        console.error('Ошибка проверки доступа к проекту:', error);\n        return {\n            hasAccess: false\n        };\n    }\n}\n// Middleware для проверки роли администратора\nasync function requireAdmin(request) {\n    const authResult = await verifyAuth(request);\n    if (!authResult.success) {\n        return {\n            success: false,\n            error: authResult.error\n        };\n    }\n    if (authResult.user.role !== 'admin') {\n        return {\n            success: false,\n            error: 'Требуются права администратора'\n        };\n    }\n    return {\n        success: true,\n        user: authResult.user\n    };\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNGO0FBRUEsOENBQThDO0FBQ3ZDLGVBQWVZLGFBQWF6RCxPQUFvQjtJQUNyRCxNQUFNMEQsYUFBYSxNQUFNM0QsV0FBV0M7SUFFcEMsSUFBSSxDQUFDMEQsV0FBVzVDLE9BQU8sRUFBRTtRQUN2QixPQUFPO1lBQUVBLFNBQVM7WUFBT0MsT0FBTzJDLFdBQVczQyxLQUFLO1FBQUM7SUFDbkQ7SUFFQSxJQUFJMkMsV0FBVzlCLElBQUksQ0FBRUksSUFBSSxLQUFLLFNBQVM7UUFDckMsT0FBTztZQUFFbEIsU0FBUztZQUFPQyxPQUFPO1FBQWlDO0lBQ25FO0lBRUEsT0FBTztRQUFFRCxTQUFTO1FBQU1jLE1BQU04QixXQUFXOUIsSUFBSTtJQUFDO0FBQ2hEIiwic291cmNlcyI6WyJFOlxcUHJvamVjdHNcXGVuY29yZS10YXNrc1xcZW5jb3JlLXRhc2tzLW1haW5cXHNyY1xcbGliXFxhdXRoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuaW1wb3J0IHsgZGJBZGFwdGVyIH0gZnJvbSAnLi9kYXRhYmFzZS1hZGFwdGVyJztcblxuY29uc3QgZGF0YWJhc2VBZGFwdGVyID0gZGJBZGFwdGVyO1xuXG5pbnRlcmZhY2UgQXV0aFJlc3VsdCB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIHVzZXI/OiB7XG4gICAgdXNlcklkOiBzdHJpbmc7XG4gICAgZW1haWw6IHN0cmluZztcbiAgICByb2xlOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICB9O1xuICBlcnJvcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUF1dGgocmVxdWVzdDogTmV4dFJlcXVlc3QpOiBQcm9taXNlPEF1dGhSZXN1bHQ+IHtcbiAgdHJ5IHtcbiAgICAvLyDQntGC0LvQsNC00LrQsDog0L/QvtC60LDQt9Cw0YLRjCDQstGB0LUgY29va2llc1xuICAgIGNvbnNvbGUubG9nKCc9PT0gREVCVUcgQ09PS0lFUyA9PT0nKTtcbiAgICBjb25zb2xlLmxvZygnQWxsIGNvb2tpZXM6JywgcmVxdWVzdC5jb29raWVzLmdldEFsbCgpKTtcbiAgICBjb25zb2xlLmxvZygnQ29va2llIG5hbWVzOicsIHJlcXVlc3QuY29va2llcy5nZXRBbGwoKS5tYXAoYyA9PiBjLm5hbWUpKTtcbiAgICBjb25zb2xlLmxvZygnYXV0aC10b2tlbiBjb29raWU6JywgcmVxdWVzdC5jb29raWVzLmdldCgnYXV0aC10b2tlbicpKTtcbiAgICBjb25zb2xlLmxvZygnYXV0aC10b2tlbi1jbGllbnQgY29va2llOicsIHJlcXVlc3QuY29va2llcy5nZXQoJ2F1dGgtdG9rZW4tY2xpZW50JykpO1xuICAgIGNvbnNvbGUubG9nKCdBdXRob3JpemF0aW9uIGhlYWRlcjonLCByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdhdXRob3JpemF0aW9uJykpO1xuICAgIFxuICAgIC8vINCf0L7Qu9GD0YfQtdC90LjQtSDRgtC+0LrQtdC90LAg0LjQtyBjb29raWUg0LjQu9C4INC30LDQs9C+0LvQvtCy0LrQsCBBdXRob3JpemF0aW9uXG4gICAgY29uc3QgdG9rZW4gPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KCdhdXRoLXRva2VuJyk/LnZhbHVlIHx8IFxuICAgICAgICAgICAgICAgICAgcmVxdWVzdC5jb29raWVzLmdldCgnYXV0aC10b2tlbi1jbGllbnQnKT8udmFsdWUgfHxcbiAgICAgICAgICAgICAgICAgIHJlcXVlc3QuaGVhZGVycy5nZXQoJ2F1dGhvcml6YXRpb24nKT8ucmVwbGFjZSgnQmVhcmVyICcsICcnKTtcblxuICAgIGNvbnNvbGUubG9nKCdBdXRoIHRva2VuIGZvdW5kOicsICEhdG9rZW4pO1xuICAgIGNvbnNvbGUubG9nKCdUb2tlbiB2YWx1ZSAoZmlyc3QgMjAgY2hhcnMpOicsIHRva2VuID8gdG9rZW4uc3Vic3RyaW5nKDAsIDIwKSArICcuLi4nIDogJ251bGwnKTtcbiAgICBpZiAoIXRva2VuKSB7XG4gICAgICBjb25zb2xlLmxvZygnTm8gYXV0aCB0b2tlbiBmb3VuZCBpbiBjb29raWVzIG9yIGhlYWRlcnMnKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ9Ci0L7QutC10L0g0LDRg9GC0LXQvdGC0LjRhNC40LrQsNGG0LjQuCDQvdC1INC90LDQudC00LXQvSdcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8g0J/RgNC+0LLQtdGA0Y/QtdC8IEpXVCDRgtC+0LrQtdC9XG4gICAgbGV0IGRlY29kZWQ6IGFueTtcbiAgICBjb25zdCBqd3RTZWNyZXQgPSBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICd5b3VyLXNlY3JldC1rZXknO1xuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSDQn9GA0L7QstC10YDRj9C10LwgSldUINGC0L7QutC10L06JywgdG9rZW4uc3Vic3RyaW5nKDAsIDIwKSArICcuLi4nKTtcbiAgICAgIGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBqd3RTZWNyZXQpO1xuICAgICAgY29uc29sZS5sb2coJ/CflJMgSldUINGC0L7QutC10L0g0YPRgdC/0LXRiNC90L4g0LTQtdC60L7QtNC40YDQvtCy0LDQvTonLCB7IHVzZXJJZDogZGVjb2RlZC51c2VySWQsIGVtYWlsOiBkZWNvZGVkLmVtYWlsIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZygn4p2MINCe0YjQuNCx0LrQsCDQtNC10LrQvtC00LjRgNC+0LLQsNC90LjRjyBKV1Qg0YLQvtC60LXQvdCwOicsIGVycm9yKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SRINCY0YHQv9C+0LvRjNC30YPQtdC80YvQuSBKV1RfU0VDUkVUOicsIGp3dFNlY3JldCk7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnZhbGlkIHRva2VuJyB9O1xuICAgIH1cblxuICAgIC8vINCY0YHQv9C+0LvRjNC30YPQtdC8INC+0L/RgtC40LzQuNC30LjRgNC+0LLQsNC90L3Ri9C5INCw0LTQsNC/0YLQtdGAINC00LvRjyDRgNCw0LHQvtGC0Ysg0YEg0YHQtdGB0YHQuNGP0LzQuFxuICAgIGF3YWl0IGRhdGFiYXNlQWRhcHRlci5pbml0aWFsaXplKCk7XG5cbiAgICB0cnkge1xuICAgICAgICAvLyDQmNGJ0LXQvCDRgdC10YHRgdC40Y4g0YfQtdGA0LXQtyDQsNC00LDQv9GC0LXRgFxuICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGRhdGFiYXNlQWRhcHRlci5nZXRTZXNzaW9uQnlUb2tlbih0b2tlbik7XG4gICAgICAgICBjb25zb2xlLmxvZygnU2Vzc2lvbiBmb3VuZDonLCAhIXNlc3Npb24pO1xuICAgICAgICAgY29uc29sZS5sb2coJ1Nlc3Npb24gb2JqZWN0OicsIHNlc3Npb24pO1xuICAgICAgICAgY29uc29sZS5sb2coJ1Nlc3Npb24gdXNlcklkOicsIHNlc3Npb24/LnVzZXJfaWQpO1xuXG4gICAgICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgICAgY29uc29sZS5sb2coJ+KdjCBTZXNzaW9uIG5vdCBmb3VuZCBpbiBkYXRhYmFzZSBmb3IgdG9rZW4nKTtcbiAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAn0KHQtdGB0YHQuNGPINC90LUg0L3QsNC50LTQtdC90LAg0LjQu9C4INC40YHRgtC10LrQu9CwJyB9O1xuICAgICAgICAgfVxuXG4gICAgICAgICAvLyBWZXJpZnkgdGhhdCB0aGUgSldUIHVzZXJJZCBtYXRjaGVzIHRoZSBzZXNzaW9uIHVzZXJfaWRcbiAgICAgICAgIGlmIChkZWNvZGVkLnVzZXJJZCAhPT0gc2Vzc2lvbi51c2VyX2lkKSB7XG4gICAgICAgICAgIGNvbnNvbGUubG9nKCfinYwgSldUIHVzZXJJZCBkb2VzIG5vdCBtYXRjaCBzZXNzaW9uIHVzZXJfaWQnKTtcbiAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAn0J3QtdGB0L7QvtGC0LLQtdGC0YHRgtCy0LjQtSDQtNCw0L3QvdGL0YUg0YLQvtC60LXQvdCwINC4INGB0LXRgdGB0LjQuCcgfTtcbiAgICAgICAgIH1cblxuICAgICAgIC8vINCf0L7Qu9GD0YfQsNC10Lwg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPINGH0LXRgNC10Lcg0LDQtNCw0L/RgtC10YBcbiAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgZGF0YWJhc2VBZGFwdGVyLmdldFVzZXJCeUlkKHNlc3Npb24udXNlcl9pZCk7XG5cbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICfQn9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0L3QtSDQvdCw0LnQtNC10L0nIH07XG4gICAgICB9XG5cbiAgICAgIC8vINCf0YDQvtCy0LXRgNGP0LXQvCDRgdGC0LDRgtGD0YEg0L7QtNC+0LHRgNC10L3QuNGPINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xuICAgICAgY29uc29sZS5sb2coJ1VzZXIgZGF0YTonLCB1c2VyKTtcbiAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFwcHJvdmFsX3N0YXR1czonLCB1c2VyLmFwcHJvdmFsX3N0YXR1cywgJ3R5cGU6JywgdHlwZW9mIHVzZXIuYXBwcm92YWxfc3RhdHVzKTtcbiAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGlzQXBwcm92ZWQ6JywgdXNlci5pc0FwcHJvdmVkLCAndHlwZTonLCB0eXBlb2YgdXNlci5pc0FwcHJvdmVkKTtcbiAgICAgIGNvbnNvbGUubG9nKCdVc2VyIHJvbGU6JywgdXNlci5yb2xlKTtcbiAgICAgIFxuICAgICAgLy8g0JjRgdC/0L7Qu9GM0LfRg9C10LwgYXBwcm92YWxfc3RhdHVzINC00LvRjyBTUUxpdGUg0LjQu9C4IGlzQXBwcm92ZWQg0LTQu9GPINC00YDRg9Cz0LjRhSDQkdCUXG4gICAgICBjb25zdCBpc0FwcHJvdmVkID0gdXNlci5hcHByb3ZhbF9zdGF0dXMgIT09IHVuZGVmaW5lZCA/IEJvb2xlYW4odXNlci5hcHByb3ZhbF9zdGF0dXMpIDogXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyLmlzQXBwcm92ZWQgIT09IHVuZGVmaW5lZCA/IEJvb2xlYW4odXNlci5pc0FwcHJvdmVkKSA6IHRydWU7XG4gICAgICBjb25zb2xlLmxvZygnRmluYWwgaXNBcHByb3ZlZDonLCBpc0FwcHJvdmVkKTtcbiAgICAgIFxuICAgICAgaWYgKCFpc0FwcHJvdmVkICYmIHVzZXIucm9sZSAhPT0gJ2FkbWluJykge1xuICAgICAgICBjb25zb2xlLmxvZygnVXNlciBub3QgYXBwcm92ZWQgYW5kIG5vdCBhZG1pbicpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAn0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC90LUg0L7QtNC+0LHRgNC10L0nXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICB1c2VySWQ6IFN0cmluZyh1c2VyLmlkKSxcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICByb2xlOiB1c2VyLnJvbGUsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dGggZXJyb3I6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAn0J7RiNC40LHQutCwINCw0YPRgtC10L3RgtC40YTQuNC60LDRhtC40LgnIH07XG4gICAgfVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign0J7RiNC40LHQutCwINC/0YDQvtCy0LXRgNC60Lgg0LDRg9GC0LXQvdGC0LjRhNC40LrQsNGG0LjQuDonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6ICfQktC90YPRgtGA0LXQvdC90Y/RjyDQvtGI0LjQsdC60LAg0YHQtdGA0LLQtdGA0LAnXG4gICAgfTtcbiAgfVxufVxuXG4vLyDQn9GA0L7QstC10YDQutCwINC/0YDQsNCyINC00L7RgdGC0YPQv9CwINC6INC/0YDQvtC10LrRgtGDXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5UHJvamVjdEFjY2VzcyhcbiAgdXNlcklkOiBzdHJpbmcsIFxuICBwcm9qZWN0SWQ6IHN0cmluZywgXG4gIHJlcXVpcmVkUm9sZT86ICdvd25lcicgfCAnYWRtaW4nIHwgJ21lbWJlcidcbik6IFByb21pc2U8eyBoYXNBY2Nlc3M6IGJvb2xlYW47IHVzZXJSb2xlPzogc3RyaW5nIH0+IHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBkYXRhYmFzZUFkYXB0ZXIuaW5pdGlhbGl6ZSgpO1xuXG4gICAgLy8g0J/QvtC70YPRh9Cw0LXQvCDQv9GA0L7QtdC60YLRiyDRh9C10YDQtdC3INCw0LTQsNC/0YLQtdGAXG4gICAgIGNvbnN0IHByb2plY3RzID0gYXdhaXQgZGF0YWJhc2VBZGFwdGVyLmdldEFsbFByb2plY3RzKCk7XG4gICAgIGNvbnN0IHByb2plY3QgPSBwcm9qZWN0cy5maW5kKHAgPT4gcC5pZCA9PT0gcHJvamVjdElkKTtcblxuICAgICBpZiAoIXByb2plY3QpIHtcbiAgICAgICByZXR1cm4geyBoYXNBY2Nlc3M6IGZhbHNlIH07XG4gICAgIH1cblxuICAgICAvLyDQn9GA0L7QstC10YDRj9C10LwsINGP0LLQu9GP0LXRgtGB0Y8g0LvQuCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0LLQu9Cw0LTQtdC70YzRhtC10LxcbiAgICAgaWYgKHByb2plY3QuY3JlYXRlZF9ieSA9PT0gdXNlcklkKSB7XG4gICAgICAgcmV0dXJuIHsgaGFzQWNjZXNzOiB0cnVlLCB1c2VyUm9sZTogJ293bmVyJyB9O1xuICAgICB9XG5cbiAgICAgLy8g0J/QvtC70YPRh9Cw0LXQvCDRg9GH0LDRgdGC0L3QuNC60L7QsiDQv9GA0L7QtdC60YLQsCDRh9C10YDQtdC3IGdldFVzZXJQcm9qZWN0c1xuICAgICBjb25zdCB1c2VyUHJvamVjdHMgPSBhd2FpdCBkYXRhYmFzZUFkYXB0ZXIuZ2V0VXNlclByb2plY3RzKHVzZXJJZCk7XG4gICAgIGNvbnN0IGhhc0FjY2VzcyA9IHVzZXJQcm9qZWN0cy5zb21lKChwOiBhbnkpID0+IHAuaWQgPT09IHByb2plY3RJZCk7XG5cbiAgICBpZiAoIWhhc0FjY2Vzcykge1xuICAgICAgIHJldHVybiB7IGhhc0FjY2VzczogZmFsc2UgfTtcbiAgICAgfVxuXG4gICAgIC8vINCU0LvRjyDRg9C/0YDQvtGJ0LXQvdC40Y8sINGB0YfQuNGC0LDQtdC8INGH0YLQviDRgyDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8g0LXRgdGC0Ywg0LTQvtGB0YLRg9C/INC60LDQuiDRg9GH0LDRgdGC0L3QuNC6XG4gICAgIGNvbnN0IHVzZXJSb2xlID0gJ21lbWJlcic7XG5cbiAgICAgLy8g0J/RgNC+0LLQtdGA0LrQsCDRgtGA0LXQsdGD0LXQvNC+0Lkg0YDQvtC70LhcbiAgICBpZiAocmVxdWlyZWRSb2xlKSB7XG4gICAgICBjb25zdCByb2xlSGllcmFyY2h5ID0geyBvd25lcjogMywgYWRtaW46IDIsIG1lbWJlcjogMSB9O1xuICAgICAgY29uc3QgdXNlclJvbGVMZXZlbCA9IHJvbGVIaWVyYXJjaHlbdXNlclJvbGUgYXMga2V5b2YgdHlwZW9mIHJvbGVIaWVyYXJjaHldIHx8IDA7XG4gICAgICBjb25zdCByZXF1aXJlZFJvbGVMZXZlbCA9IHJvbGVIaWVyYXJjaHlbcmVxdWlyZWRSb2xlXTtcbiAgICAgIFxuICAgICAgaWYgKHVzZXJSb2xlTGV2ZWwgPCByZXF1aXJlZFJvbGVMZXZlbCkge1xuICAgICAgICByZXR1cm4geyBoYXNBY2Nlc3M6IGZhbHNlLCB1c2VyUm9sZSB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7IGhhc0FjY2VzczogdHJ1ZSwgdXNlclJvbGUgfTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQv9GA0L7QstC10YDQutC4INC00L7RgdGC0YPQv9CwINC6INC/0YDQvtC10LrRgtGDOicsIGVycm9yKTtcbiAgICByZXR1cm4geyBoYXNBY2Nlc3M6IGZhbHNlIH07XG4gIH1cbn1cblxuLy8gTWlkZGxld2FyZSDQtNC70Y8g0L/RgNC+0LLQtdGA0LrQuCDRgNC+0LvQuCDQsNC00LzQuNC90LjRgdGC0YDQsNGC0L7RgNCwXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZUFkbWluKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCB2ZXJpZnlBdXRoKHJlcXVlc3QpO1xuICBcbiAgaWYgKCFhdXRoUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGF1dGhSZXN1bHQuZXJyb3IgfTtcbiAgfVxuXG4gIGlmIChhdXRoUmVzdWx0LnVzZXIhLnJvbGUgIT09ICdhZG1pbicpIHtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICfQotGA0LXQsdGD0Y7RgtGB0Y8g0L/RgNCw0LLQsCDQsNC00LzQuNC90LjRgdGC0YDQsNGC0L7RgNCwJyB9O1xuICB9XG5cbiAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgdXNlcjogYXV0aFJlc3VsdC51c2VyIH07XG59Il0sIm5hbWVzIjpbImp3dCIsImRiQWRhcHRlciIsImRhdGFiYXNlQWRhcHRlciIsInZlcmlmeUF1dGgiLCJyZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsImNvb2tpZXMiLCJnZXRBbGwiLCJtYXAiLCJjIiwibmFtZSIsImdldCIsImhlYWRlcnMiLCJ0b2tlbiIsInZhbHVlIiwicmVwbGFjZSIsInN1YnN0cmluZyIsInN1Y2Nlc3MiLCJlcnJvciIsImRlY29kZWQiLCJqd3RTZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsInZlcmlmeSIsInVzZXJJZCIsImVtYWlsIiwiaW5pdGlhbGl6ZSIsInNlc3Npb24iLCJnZXRTZXNzaW9uQnlUb2tlbiIsInVzZXJfaWQiLCJ1c2VyIiwiZ2V0VXNlckJ5SWQiLCJhcHByb3ZhbF9zdGF0dXMiLCJpc0FwcHJvdmVkIiwicm9sZSIsInVuZGVmaW5lZCIsIkJvb2xlYW4iLCJTdHJpbmciLCJpZCIsInZlcmlmeVByb2plY3RBY2Nlc3MiLCJwcm9qZWN0SWQiLCJyZXF1aXJlZFJvbGUiLCJwcm9qZWN0cyIsImdldEFsbFByb2plY3RzIiwicHJvamVjdCIsImZpbmQiLCJwIiwiaGFzQWNjZXNzIiwiY3JlYXRlZF9ieSIsInVzZXJSb2xlIiwidXNlclByb2plY3RzIiwiZ2V0VXNlclByb2plY3RzIiwic29tZSIsInJvbGVIaWVyYXJjaHkiLCJvd25lciIsImFkbWluIiwibWVtYmVyIiwidXNlclJvbGVMZXZlbCIsInJlcXVpcmVkUm9sZUxldmVsIiwicmVxdWlyZUFkbWluIiwiYXV0aFJlc3VsdCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/database-adapter.ts":
/*!*************************************!*\
  !*** ./src/lib/database-adapter.ts ***!
  \*************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DatabaseAdapter: () => (/* binding */ DatabaseAdapter),\n/* harmony export */   dbAdapter: () => (/* binding */ dbAdapter)\n/* harmony export */ });\n/* harmony import */ var _adapters_postgresql_adapter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./adapters/postgresql-adapter */ \"(rsc)/./src/lib/adapters/postgresql-adapter.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_adapters_postgresql_adapter__WEBPACK_IMPORTED_MODULE_0__]);\n_adapters_postgresql_adapter__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// =====================================================\n// POSTGRESQL DATABASE ADAPTER FOR ENCORE TASKS\n// =====================================================\n\nclass DatabaseAdapter {\n    constructor(){\n        this.isInitialized = false;\n        this.adapter = new _adapters_postgresql_adapter__WEBPACK_IMPORTED_MODULE_0__.PostgreSQLAdapter();\n    }\n    static getInstance() {\n        if (!DatabaseAdapter.instance) {\n            DatabaseAdapter.instance = new DatabaseAdapter();\n        }\n        return DatabaseAdapter.instance;\n    }\n    async initialize() {\n        try {\n            await this.adapter.initialize();\n            this.isInitialized = true;\n            console.log('✅ PostgreSQL connection established');\n        } catch (error) {\n            console.error('❌ PostgreSQL connection failed:', error);\n            throw new Error('Database initialization failed');\n        }\n    }\n    /**\n   * Проверка инициализации перед выполнением операций\n   */ async ensureInitialized() {\n        if (!this.isInitialized) {\n            await this.initialize();\n        }\n    }\n    isConnected() {\n        return this.adapter.isConnected();\n    }\n    getDatabaseType() {\n        return 'postgresql';\n    }\n    // =====================================================\n    // ОПЕРАЦИИ С ПОЛЬЗОВАТЕЛЯМИ\n    // =====================================================\n    // User operations\n    async createUser(userData) {\n        await this.ensureInitialized();\n        return this.adapter.createUser(userData);\n    }\n    async getUserById(id) {\n        await this.ensureInitialized();\n        return this.adapter.getUserById(id);\n    }\n    async getUserByEmail(email) {\n        await this.ensureInitialized();\n        return this.adapter.getUserByEmail(email);\n    }\n    async updateUser(id, userData) {\n        await this.ensureInitialized();\n        return this.adapter.updateUser(id, userData);\n    }\n    async deleteUser(id) {\n        await this.ensureInitialized();\n        return this.adapter.deleteUser(id);\n    }\n    async getAllUsers() {\n        await this.ensureInitialized();\n        return this.adapter.getAllUsers();\n    }\n    // Session operations\n    async createSession(sessionData) {\n        await this.ensureInitialized();\n        return this.adapter.createSession(sessionData);\n    }\n    async getSessionByToken(token) {\n        await this.ensureInitialized();\n        return this.adapter.getSessionByToken(token);\n    }\n    async deleteSession(token) {\n        await this.ensureInitialized();\n        return this.adapter.deleteSession(token);\n    }\n    async deleteUserSessions(userId) {\n        await this.ensureInitialized();\n        return this.adapter.deleteUserSessions(userId);\n    }\n    // Project operations\n    async createProject(projectData) {\n        await this.ensureInitialized();\n        return this.adapter.createProject(projectData);\n    }\n    async getProjectById(id) {\n        await this.ensureInitialized();\n        return this.adapter.getProjectById(id);\n    }\n    async getUserProjects(userId) {\n        await this.ensureInitialized();\n        return this.adapter.getUserProjects(userId);\n    }\n    async updateProject(id, projectData) {\n        await this.ensureInitialized();\n        return this.adapter.updateProject(id, projectData);\n    }\n    async deleteProject(id) {\n        await this.ensureInitialized();\n        return this.adapter.deleteProject(id);\n    }\n    // Board operations\n    async createBoard(boardData) {\n        await this.ensureInitialized();\n        return this.adapter.createBoard(boardData);\n    }\n    async getBoardById(id) {\n        await this.ensureInitialized();\n        return this.adapter.getBoardById(id);\n    }\n    async getProjectBoards(projectId) {\n        await this.ensureInitialized();\n        return this.adapter.getProjectBoards(projectId);\n    }\n    async updateBoard(id, updates) {\n        await this.ensureInitialized();\n        return this.adapter.updateBoard(id, updates);\n    }\n    async deleteBoard(id) {\n        await this.ensureInitialized();\n        return this.adapter.deleteBoard(id);\n    }\n    // Column operations\n    async createColumn(columnData) {\n        await this.ensureInitialized();\n        return this.adapter.createColumn(columnData);\n    }\n    async getColumnById(id) {\n        await this.ensureInitialized();\n        return this.adapter.getColumnById(id);\n    }\n    async getBoardColumns(boardId) {\n        await this.ensureInitialized();\n        return this.adapter.getBoardColumns(boardId);\n    }\n    async updateColumn(id, updates) {\n        await this.ensureInitialized();\n        return this.adapter.updateColumn(id, updates);\n    }\n    async deleteColumn(id) {\n        await this.ensureInitialized();\n        return this.adapter.deleteColumn(id);\n    }\n    // Task operations\n    async createTask(taskData) {\n        await this.ensureInitialized();\n        return this.adapter.createTask(taskData);\n    }\n    async getTaskById(id) {\n        await this.ensureInitialized();\n        return this.adapter.getTaskById(id);\n    }\n    async getProjectTasks(projectId) {\n        await this.ensureInitialized();\n        return this.adapter.getProjectTasks(projectId);\n    }\n    async getBoardTasks(boardId) {\n        await this.ensureInitialized();\n        return this.adapter.getBoardTasks(boardId);\n    }\n    async getColumnTasks(columnId) {\n        await this.ensureInitialized();\n        return this.adapter.getColumnTasks(columnId);\n    }\n    async updateTask(id, updates) {\n        await this.ensureInitialized();\n        return this.adapter.updateTask(id, updates);\n    }\n    async deleteTask(id) {\n        await this.ensureInitialized();\n        return this.adapter.deleteTask(id);\n    }\n    // =====================================================\n    // ACCESS CONTROL METHODS\n    // =====================================================\n    async hasProjectAccess(userId, projectId) {\n        await this.ensureInitialized();\n        return this.adapter.hasProjectAccess(userId, projectId);\n    }\n    /**\n   * Выполнение сырого SQL запроса (для совместимости с репозиториями)\n   */ async query(sql, params) {\n        await this.ensureInitialized();\n        const result = await this.adapter.query(sql, params);\n        return result.rows;\n    }\n    // Raw query execution\n    async executeRawQuery(query, params = []) {\n        await this.ensureInitialized();\n        return this.adapter.executeRawQuery(query, params);\n    }\n    async close() {\n        if (this.adapter) {\n            await this.adapter.close();\n        }\n    }\n}\n// Export singleton instance\nconst dbAdapter = new DatabaseAdapter();\n// Export class for getInstance() usage\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBaUIsRUFBb0I7UUFDMUUsTUFBTSxJQUFJLENBQUM3QixpQkFBaUI7UUFDNUIsT0FBTyxJQUFJLENBQUNSLE9BQU8sQ0FBQ3lELGdCQUFnQixDQUFDL0IsUUFBUVc7SUFDL0M7SUFFQTs7R0FFQyxHQUNELE1BQWFxQixNQUFNQyxHQUFXLEVBQUVDLE1BQWtCLEVBQXNCO1FBQ3RFLE1BQU0sSUFBSSxDQUFDcEQsaUJBQWlCO1FBQzVCLE1BQU1xRCxTQUFTLE1BQU0sSUFBSSxDQUFDN0QsT0FBTyxDQUFDMEQsS0FBSyxDQUFDQyxLQUFLQztRQUM3QyxPQUFPQyxPQUFPQyxJQUFJO0lBQ3BCO0lBRUEsc0JBQXNCO0lBQ3RCLE1BQU1DLGdCQUFnQkwsS0FBYSxFQUFFRSxTQUFnQixFQUFFLEVBQWdCO1FBQ3JFLE1BQU0sSUFBSSxDQUFDcEQsaUJBQWlCO1FBQzVCLE9BQU8sSUFBSSxDQUFDUixPQUFPLENBQUMrRCxlQUFlLENBQUNMLE9BQU9FO0lBQzdDO0lBRUEsTUFBTUksUUFBdUI7UUFDM0IsSUFBSSxJQUFJLENBQUNoRSxPQUFPLEVBQUU7WUFDaEIsTUFBTSxJQUFJLENBQUNBLE9BQU8sQ0FBQ2dFLEtBQUs7UUFDMUI7SUFDRjtBQUNGO0FBRUEsNEJBQTRCO0FBQ3JCLE1BQU1DLFlBQVksSUFBSXBFLGtCQUFrQjtBQUUvQyx1Q0FBdUM7QUFDWiIsInNvdXJjZXMiOlsiRTpcXFByb2plY3RzXFxlbmNvcmUtdGFza3NcXGVuY29yZS10YXNrcy1tYWluXFxzcmNcXGxpYlxcZGF0YWJhc2UtYWRhcHRlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUE9TVEdSRVNRTCBEQVRBQkFTRSBBREFQVEVSIEZPUiBFTkNPUkUgVEFTS1Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCB7IFVzZXIsIFByb2plY3QsIEJvYXJkLCBDb2x1bW4sIFRhc2ssIFNlc3Npb24gfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB7IFBvc3RncmVTUUxBZGFwdGVyIH0gZnJvbSAnLi9hZGFwdGVycy9wb3N0Z3Jlc3FsLWFkYXB0ZXInO1xuXG5jbGFzcyBEYXRhYmFzZUFkYXB0ZXIge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogRGF0YWJhc2VBZGFwdGVyO1xuICBwcml2YXRlIGFkYXB0ZXI6IFBvc3RncmVTUUxBZGFwdGVyO1xuICBwcml2YXRlIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmFkYXB0ZXIgPSBuZXcgUG9zdGdyZVNRTEFkYXB0ZXIoKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogRGF0YWJhc2VBZGFwdGVyIHtcbiAgICBpZiAoIURhdGFiYXNlQWRhcHRlci5pbnN0YW5jZSkge1xuICAgICAgRGF0YWJhc2VBZGFwdGVyLmluc3RhbmNlID0gbmV3IERhdGFiYXNlQWRhcHRlcigpO1xuICAgIH1cbiAgICByZXR1cm4gRGF0YWJhc2VBZGFwdGVyLmluc3RhbmNlO1xuICB9XG5cbiAgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5hZGFwdGVyLmluaXRpYWxpemUoKTtcbiAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICBjb25zb2xlLmxvZygn4pyFIFBvc3RncmVTUUwgY29ubmVjdGlvbiBlc3RhYmxpc2hlZCcpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgUG9zdGdyZVNRTCBjb25uZWN0aW9uIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIGluaXRpYWxpemF0aW9uIGZhaWxlZCcpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDQn9GA0L7QstC10YDQutCwINC40L3QuNGG0LjQsNC70LjQt9Cw0YbQuNC4INC/0LXRgNC10LQg0LLRi9C/0L7Qu9C90LXQvdC40LXQvCDQvtC/0LXRgNCw0YbQuNC5XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGVuc3VyZUluaXRpYWxpemVkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5pc0luaXRpYWxpemVkKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemUoKTtcbiAgICB9XG4gIH1cblxuICBpc0Nvbm5lY3RlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmlzQ29ubmVjdGVkKCk7XG4gIH1cblxuICBnZXREYXRhYmFzZVR5cGUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gJ3Bvc3RncmVzcWwnO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g0J7Qn9CV0KDQkNCm0JjQmCDQoSDQn9Ce0JvQrNCX0J7QktCQ0KLQldCb0K/QnNCYXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLy8gVXNlciBvcGVyYXRpb25zXG4gIGFzeW5jIGNyZWF0ZVVzZXIodXNlckRhdGE6IHtcbiAgICBlbWFpbDogc3RyaW5nO1xuICAgIHBhc3N3b3JkOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHJvbGU/OiBzdHJpbmc7XG4gIH0pOiBQcm9taXNlPGFueT4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmNyZWF0ZVVzZXIodXNlckRhdGEpO1xuICB9XG5cbiAgYXN5bmMgZ2V0VXNlckJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuZ2V0VXNlckJ5SWQoaWQpO1xuICB9XG5cbiAgYXN5bmMgZ2V0VXNlckJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuZ2V0VXNlckJ5RW1haWwoZW1haWwpO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlVXNlcihpZDogc3RyaW5nLCB1c2VyRGF0YTogUGFydGlhbDxhbnk+KTogUHJvbWlzZTxhbnk+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci51cGRhdGVVc2VyKGlkLCB1c2VyRGF0YSk7XG4gIH1cblxuICBhc3luYyBkZWxldGVVc2VyKGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5kZWxldGVVc2VyKGlkKTtcbiAgfVxuXG4gIGFzeW5jIGdldEFsbFVzZXJzKCk6IFByb21pc2U8YW55W10+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5nZXRBbGxVc2VycygpO1xuICB9XG5cbiAgLy8gU2Vzc2lvbiBvcGVyYXRpb25zXG4gIGFzeW5jIGNyZWF0ZVNlc3Npb24oc2Vzc2lvbkRhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihzZXNzaW9uRGF0YSk7XG4gIH1cblxuICBhc3luYyBnZXRTZXNzaW9uQnlUb2tlbih0b2tlbjogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5nZXRTZXNzaW9uQnlUb2tlbih0b2tlbik7XG4gIH1cblxuICBhc3luYyBkZWxldGVTZXNzaW9uKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5kZWxldGVTZXNzaW9uKHRva2VuKTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVVzZXJTZXNzaW9ucyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmRlbGV0ZVVzZXJTZXNzaW9ucyh1c2VySWQpO1xuICB9XG5cbiAgLy8gUHJvamVjdCBvcGVyYXRpb25zXG4gIGFzeW5jIGNyZWF0ZVByb2plY3QocHJvamVjdERhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuY3JlYXRlUHJvamVjdChwcm9qZWN0RGF0YSk7XG4gIH1cblxuICBhc3luYyBnZXRQcm9qZWN0QnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5nZXRQcm9qZWN0QnlJZChpZCk7XG4gIH1cblxuICBhc3luYyBnZXRVc2VyUHJvamVjdHModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuZ2V0VXNlclByb2plY3RzKHVzZXJJZCk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVQcm9qZWN0KGlkOiBzdHJpbmcsIHByb2plY3REYXRhOiBQYXJ0aWFsPGFueT4pOiBQcm9taXNlPGFueT4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLnVwZGF0ZVByb2plY3QoaWQsIHByb2plY3REYXRhKTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVByb2plY3QoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmRlbGV0ZVByb2plY3QoaWQpO1xuICB9XG5cbiAgLy8gQm9hcmQgb3BlcmF0aW9uc1xuICBhc3luYyBjcmVhdGVCb2FyZChib2FyZERhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuY3JlYXRlQm9hcmQoYm9hcmREYXRhKTtcbiAgfVxuXG4gIGFzeW5jIGdldEJvYXJkQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5nZXRCb2FyZEJ5SWQoaWQpO1xuICB9XG5cbiAgYXN5bmMgZ2V0UHJvamVjdEJvYXJkcyhwcm9qZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8YW55W10+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5nZXRQcm9qZWN0Qm9hcmRzKHByb2plY3RJZCk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVCb2FyZChpZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPGFueT4pOiBQcm9taXNlPGFueT4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLnVwZGF0ZUJvYXJkKGlkLCB1cGRhdGVzKTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZUJvYXJkKGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5kZWxldGVCb2FyZChpZCk7XG4gIH1cblxuICAvLyBDb2x1bW4gb3BlcmF0aW9uc1xuICBhc3luYyBjcmVhdGVDb2x1bW4oY29sdW1uRGF0YTogYW55KTogUHJvbWlzZTxhbnk+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5jcmVhdGVDb2x1bW4oY29sdW1uRGF0YSk7XG4gIH1cblxuICBhc3luYyBnZXRDb2x1bW5CeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmdldENvbHVtbkJ5SWQoaWQpO1xuICB9XG5cbiAgYXN5bmMgZ2V0Qm9hcmRDb2x1bW5zKGJvYXJkSWQ6IHN0cmluZyk6IFByb21pc2U8YW55W10+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5nZXRCb2FyZENvbHVtbnMoYm9hcmRJZCk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVDb2x1bW4oaWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxhbnk+KTogUHJvbWlzZTxhbnk+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci51cGRhdGVDb2x1bW4oaWQsIHVwZGF0ZXMpO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlQ29sdW1uKGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5kZWxldGVDb2x1bW4oaWQpO1xuICB9XG5cbiAgLy8gVGFzayBvcGVyYXRpb25zXG4gIGFzeW5jIGNyZWF0ZVRhc2sodGFza0RhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuY3JlYXRlVGFzayh0YXNrRGF0YSk7XG4gIH1cblxuICBhc3luYyBnZXRUYXNrQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5nZXRUYXNrQnlJZChpZCk7XG4gIH1cblxuICBhc3luYyBnZXRQcm9qZWN0VGFza3MocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIuZ2V0UHJvamVjdFRhc2tzKHByb2plY3RJZCk7XG4gIH1cblxuICBhc3luYyBnZXRCb2FyZFRhc2tzKGJvYXJkSWQ6IHN0cmluZyk6IFByb21pc2U8YW55W10+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5nZXRCb2FyZFRhc2tzKGJvYXJkSWQpO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q29sdW1uVGFza3MoY29sdW1uSWQ6IHN0cmluZyk6IFByb21pc2U8YW55W10+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5nZXRDb2x1bW5UYXNrcyhjb2x1bW5JZCk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVUYXNrKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8YW55Pik6IFByb21pc2U8YW55PiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmFkYXB0ZXIudXBkYXRlVGFzayhpZCwgdXBkYXRlcyk7XG4gIH1cblxuICBhc3luYyBkZWxldGVUYXNrKGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuYWRhcHRlci5kZWxldGVUYXNrKGlkKTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIEFDQ0VTUyBDT05UUk9MIE1FVEhPRFNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBoYXNQcm9qZWN0QWNjZXNzKHVzZXJJZDogc3RyaW5nLCBwcm9qZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmhhc1Byb2plY3RBY2Nlc3ModXNlcklkLCBwcm9qZWN0SWQpO1xuICB9XG5cbiAgLyoqXG4gICAqINCS0YvQv9C+0LvQvdC10L3QuNC1INGB0YvRgNC+0LPQviBTUUwg0LfQsNC/0YDQvtGB0LAgKNC00LvRjyDRgdC+0LLQvNC10YHRgtC40LzQvtGB0YLQuCDRgSDRgNC10L/QvtC30LjRgtC+0YDQuNGP0LzQuClcbiAgICovXG4gIHB1YmxpYyBhc3luYyBxdWVyeShzcWw6IHN0cmluZywgcGFyYW1zPzogdW5rbm93bltdKTogUHJvbWlzZTx1bmtub3duW10+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hZGFwdGVyLnF1ZXJ5KHNxbCwgcGFyYW1zKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gIH1cblxuICAvLyBSYXcgcXVlcnkgZXhlY3V0aW9uXG4gIGFzeW5jIGV4ZWN1dGVSYXdRdWVyeShxdWVyeTogc3RyaW5nLCBwYXJhbXM6IGFueVtdID0gW10pOiBQcm9taXNlPGFueT4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5hZGFwdGVyLmV4ZWN1dGVSYXdRdWVyeShxdWVyeSwgcGFyYW1zKTtcbiAgfVxuXG4gIGFzeW5jIGNsb3NlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLmFkYXB0ZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMuYWRhcHRlci5jbG9zZSgpO1xuICAgIH1cbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgZGJBZGFwdGVyID0gbmV3IERhdGFiYXNlQWRhcHRlcigpO1xuXG4vLyBFeHBvcnQgY2xhc3MgZm9yIGdldEluc3RhbmNlKCkgdXNhZ2VcbmV4cG9ydCB7IERhdGFiYXNlQWRhcHRlciB9O1xuIl0sIm5hbWVzIjpbIlBvc3RncmVTUUxBZGFwdGVyIiwiRGF0YWJhc2VBZGFwdGVyIiwiY29uc3RydWN0b3IiLCJpc0luaXRpYWxpemVkIiwiYWRhcHRlciIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJpbml0aWFsaXplIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwiRXJyb3IiLCJlbnN1cmVJbml0aWFsaXplZCIsImlzQ29ubmVjdGVkIiwiZ2V0RGF0YWJhc2VUeXBlIiwiY3JlYXRlVXNlciIsInVzZXJEYXRhIiwiZ2V0VXNlckJ5SWQiLCJpZCIsImdldFVzZXJCeUVtYWlsIiwiZW1haWwiLCJ1cGRhdGVVc2VyIiwiZGVsZXRlVXNlciIsImdldEFsbFVzZXJzIiwiY3JlYXRlU2Vzc2lvbiIsInNlc3Npb25EYXRhIiwiZ2V0U2Vzc2lvbkJ5VG9rZW4iLCJ0b2tlbiIsImRlbGV0ZVNlc3Npb24iLCJkZWxldGVVc2VyU2Vzc2lvbnMiLCJ1c2VySWQiLCJjcmVhdGVQcm9qZWN0IiwicHJvamVjdERhdGEiLCJnZXRQcm9qZWN0QnlJZCIsImdldFVzZXJQcm9qZWN0cyIsInVwZGF0ZVByb2plY3QiLCJkZWxldGVQcm9qZWN0IiwiY3JlYXRlQm9hcmQiLCJib2FyZERhdGEiLCJnZXRCb2FyZEJ5SWQiLCJnZXRQcm9qZWN0Qm9hcmRzIiwicHJvamVjdElkIiwidXBkYXRlQm9hcmQiLCJ1cGRhdGVzIiwiZGVsZXRlQm9hcmQiLCJjcmVhdGVDb2x1bW4iLCJjb2x1bW5EYXRhIiwiZ2V0Q29sdW1uQnlJZCIsImdldEJvYXJkQ29sdW1ucyIsImJvYXJkSWQiLCJ1cGRhdGVDb2x1bW4iLCJkZWxldGVDb2x1bW4iLCJjcmVhdGVUYXNrIiwidGFza0RhdGEiLCJnZXRUYXNrQnlJZCIsImdldFByb2plY3RUYXNrcyIsImdldEJvYXJkVGFza3MiLCJnZXRDb2x1bW5UYXNrcyIsImNvbHVtbklkIiwidXBkYXRlVGFzayIsImRlbGV0ZVRhc2siLCJoYXNQcm9qZWN0QWNjZXNzIiwicXVlcnkiLCJzcWwiLCJwYXJhbXMiLCJyZXN1bHQiLCJyb3dzIiwiZXhlY3V0ZVJhd1F1ZXJ5IiwiY2xvc2UiLCJkYkFkYXB0ZXIiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/database-adapter.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = import("pg");;

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/semver","vendor-chunks/bcryptjs","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/uuid","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fme%2Froute&page=%2Fapi%2Fauth%2Fme%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fme%2Froute.ts&appDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();