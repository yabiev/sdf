/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/register/route";
exports.ids = ["app/api/auth/register/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var E_Projects_encore_tasks_encore_tasks_main_src_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/auth/register/route.ts */ \"(rsc)/./src/app/api/auth/register/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([E_Projects_encore_tasks_encore_tasks_main_src_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_3__]);\nE_Projects_encore_tasks_encore_tasks_main_src_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/register/route\",\n        pathname: \"/api/auth/register\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/register/route\"\n    },\n    resolvedPagePath: \"E:\\\\Projects\\\\encore-tasks\\\\encore-tasks-main\\\\src\\\\app\\\\api\\\\auth\\\\register\\\\route.ts\",\n    nextConfigOutput,\n    userland: E_Projects_encore_tasks_encore_tasks_main_src_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGcmVnaXN0ZXIlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZyZWdpc3RlciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZyZWdpc3RlciUyRnJvdXRlLnRzJmFwcERpcj1FJTNBJTVDUHJvamVjdHMlNUNlbmNvcmUtdGFza3MlNUNlbmNvcmUtdGFza3MtbWFpbiU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RSUzQSU1Q1Byb2plY3RzJTVDZW5jb3JlLXRhc2tzJTVDZW5jb3JlLXRhc2tzLW1haW4maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ3NDO0FBQ25IO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRixxQyIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJFOlxcXFxQcm9qZWN0c1xcXFxlbmNvcmUtdGFza3NcXFxcZW5jb3JlLXRhc2tzLW1haW5cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxyZWdpc3RlclxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9yZWdpc3Rlci9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvcmVnaXN0ZXJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvcmVnaXN0ZXIvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJFOlxcXFxQcm9qZWN0c1xcXFxlbmNvcmUtdGFza3NcXFxcZW5jb3JlLXRhc2tzLW1haW5cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxyZWdpc3RlclxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/auth/register/route.ts":
/*!********************************************!*\
  !*** ./src/app/api/auth/register/route.ts ***!
  \********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_database_adapter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/database-adapter */ \"(rsc)/./src/lib/database-adapter.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_2__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_database_adapter__WEBPACK_IMPORTED_MODULE_1__]);\n_lib_database_adapter__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\nconst databaseAdapter = _lib_database_adapter__WEBPACK_IMPORTED_MODULE_1__.DatabaseAdapter.getInstance();\nasync function POST(request) {\n    try {\n        const { name, email, password } = await request.json();\n        // Валидация\n        if (!name || !email || !password) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Все поля обязательны'\n            }, {\n                status: 400\n            });\n        }\n        if (password.length < 6) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Пароль должен содержать минимум 6 символов'\n            }, {\n                status: 400\n            });\n        }\n        // Email валидация\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(email)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Некорректный формат email'\n            }, {\n                status: 400\n            });\n        }\n        // Проверка существования пользователя\n        const existingUser = await databaseAdapter.getUserByEmail(email);\n        if (existingUser) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Пользователь с таким email уже существует'\n            }, {\n                status: 409\n            });\n        }\n        // Хеширование пароля\n        const saltRounds = 10;\n        const hashedPassword = await bcryptjs__WEBPACK_IMPORTED_MODULE_2___default().hash(password, saltRounds);\n        // Создание пользователя с правильной структурой данных\n        // Для обычных пользователей isApproved = false - требуется одобрение администратора\n        // Администраторы могут одобрить пользователей через админ панель\n        const user = await databaseAdapter.createUser({\n            email,\n            password_hash: hashedPassword,\n            name,\n            role: 'user',\n            isApproved: false\n        });\n        // Возврат данных пользователя (без пароля) с правильной типизацией\n        const userResult = {\n            id: user.id,\n            name: user.name,\n            email: user.email,\n            role: user.role,\n            approval_status: user.isApproved ? 'approved' : 'pending',\n            isApproved: user.isApproved,\n            avatar: user.avatar,\n            createdAt: user.created_at\n        };\n        // НЕ создаем сессию для неподтвержденных пользователей\n        // Пользователь должен быть одобрен администратором перед входом в систему\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: 'Пользователь успешно зарегистрирован. Ожидайте подтверждения от администратора.',\n            user: userResult,\n            requiresApproval: true\n        }, {\n            status: 201\n        });\n        return response;\n    } catch (error) {\n        console.error('Ошибка регистрации:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Внутренняя ошибка сервера'\n        }, {\n            status: 500\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hdXRoL3JlZ2lzdGVyL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXdEO0FBQ0M7QUFDM0I7QUFFOUIsTUFBTUcsa0JBQWtCRixrRUFBZUEsQ0FBQ0csV0FBVztBQUU1QyxlQUFlQyxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRUMsUUFBUSxFQUFFLEdBQUcsTUFBTUgsUUFBUUksSUFBSTtRQUVwRCxZQUFZO1FBQ1osSUFBSSxDQUFDSCxRQUFRLENBQUNDLFNBQVMsQ0FBQ0MsVUFBVTtZQUNoQyxPQUFPVCxxREFBWUEsQ0FBQ1UsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUF1QixHQUNoQztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsSUFBSUgsU0FBU0ksTUFBTSxHQUFHLEdBQUc7WUFDdkIsT0FBT2IscURBQVlBLENBQUNVLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBNkMsR0FDdEQ7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLGtCQUFrQjtRQUNsQixNQUFNRSxhQUFhO1FBQ25CLElBQUksQ0FBQ0EsV0FBV0MsSUFBSSxDQUFDUCxRQUFRO1lBQzNCLE9BQU9SLHFEQUFZQSxDQUFDVSxJQUFJLENBQ3RCO2dCQUFFQyxPQUFPO1lBQTRCLEdBQ3JDO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxzQ0FBc0M7UUFDdEMsTUFBTUksZUFBZSxNQUFNYixnQkFBZ0JjLGNBQWMsQ0FBQ1Q7UUFDMUQsSUFBSVEsY0FBYztZQUNoQixPQUFPaEIscURBQVlBLENBQUNVLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBNEMsR0FDckQ7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLHFCQUFxQjtRQUNyQixNQUFNTSxhQUFhO1FBQ25CLE1BQU1DLGlCQUFpQixNQUFNakIsb0RBQVcsQ0FBQ08sVUFBVVM7UUFFbkQsdURBQXVEO1FBQ3ZELG9GQUFvRjtRQUNwRixpRUFBaUU7UUFDakUsTUFBTUcsT0FBTyxNQUFNbEIsZ0JBQWdCbUIsVUFBVSxDQUFDO1lBQzVDZDtZQUNBZSxlQUFlSjtZQUNmWjtZQUNBaUIsTUFBTTtZQUNOQyxZQUFZO1FBQ2Q7UUFFQSxtRUFBbUU7UUFDbkUsTUFBTUMsYUFBYTtZQUNqQkMsSUFBSU4sS0FBS00sRUFBRTtZQUNYcEIsTUFBTWMsS0FBS2QsSUFBSTtZQUNmQyxPQUFPYSxLQUFLYixLQUFLO1lBQ2pCZ0IsTUFBTUgsS0FBS0csSUFBSTtZQUNmSSxpQkFBaUJQLEtBQUtJLFVBQVUsR0FBRyxhQUFhO1lBQ2hEQSxZQUFZSixLQUFLSSxVQUFVO1lBQzNCSSxRQUFRUixLQUFLUSxNQUFNO1lBQ25CQyxXQUFXVCxLQUFLVSxVQUFVO1FBQzVCO1FBRUEsdURBQXVEO1FBQ3ZELDBFQUEwRTtRQUMxRSxNQUFNQyxXQUFXaEMscURBQVlBLENBQUNVLElBQUksQ0FBQztZQUNqQ3VCLFNBQVM7WUFDVFosTUFBTUs7WUFDTlEsa0JBQWtCO1FBQ3BCLEdBQUc7WUFBRXRCLFFBQVE7UUFBSTtRQUVqQixPQUFPb0I7SUFFVCxFQUFFLE9BQU9yQixPQUFPO1FBQ2R3QixRQUFReEIsS0FBSyxDQUFDLHVCQUF1QkE7UUFDckMsT0FBT1gscURBQVlBLENBQUNVLElBQUksQ0FDdEI7WUFBRUMsT0FBTztRQUE0QixHQUNyQztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsiRTpcXFByb2plY3RzXFxlbmNvcmUtdGFza3NcXGVuY29yZS10YXNrcy1tYWluXFxzcmNcXGFwcFxcYXBpXFxhdXRoXFxyZWdpc3Rlclxccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IERhdGFiYXNlQWRhcHRlciB9IGZyb20gJ0AvbGliL2RhdGFiYXNlLWFkYXB0ZXInO1xuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcyc7XG5cbmNvbnN0IGRhdGFiYXNlQWRhcHRlciA9IERhdGFiYXNlQWRhcHRlci5nZXRJbnN0YW5jZSgpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgbmFtZSwgZW1haWwsIHBhc3N3b3JkIH0gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcblxuICAgIC8vINCS0LDQu9C40LTQsNGG0LjRj1xuICAgIGlmICghbmFtZSB8fCAhZW1haWwgfHwgIXBhc3N3b3JkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICfQktGB0LUg0L/QvtC70Y8g0L7QsdGP0LfQsNGC0LXQu9GM0L3RiycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChwYXNzd29yZC5sZW5ndGggPCA2KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICfQn9Cw0YDQvtC70Ywg0LTQvtC70LbQtdC9INGB0L7QtNC10YDQttCw0YLRjCDQvNC40L3QuNC80YPQvCA2INGB0LjQvNCy0L7Qu9C+0LInIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBFbWFpbCDQstCw0LvQuNC00LDRhtC40Y9cbiAgICBjb25zdCBlbWFpbFJlZ2V4ID0gL15bXlxcc0BdK0BbXlxcc0BdK1xcLlteXFxzQF0rJC87XG4gICAgaWYgKCFlbWFpbFJlZ2V4LnRlc3QoZW1haWwpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICfQndC10LrQvtGA0YDQtdC60YLQvdGL0Lkg0YTQvtGA0LzQsNGCIGVtYWlsJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIC8vINCf0YDQvtCy0LXRgNC60LAg0YHRg9GJ0LXRgdGC0LLQvtCy0LDQvdC40Y8g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXG4gICAgY29uc3QgZXhpc3RpbmdVc2VyID0gYXdhaXQgZGF0YWJhc2VBZGFwdGVyLmdldFVzZXJCeUVtYWlsKGVtYWlsKTtcbiAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICfQn9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0YEg0YLQsNC60LjQvCBlbWFpbCDRg9C20LUg0YHRg9GJ0LXRgdGC0LLRg9C10YInIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDkgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyDQpdC10YjQuNGA0L7QstCw0L3QuNC1INC/0LDRgNC+0LvRj1xuICAgIGNvbnN0IHNhbHRSb3VuZHMgPSAxMDtcbiAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHBhc3N3b3JkLCBzYWx0Um91bmRzKTtcblxuICAgIC8vINCh0L7Qt9C00LDQvdC40LUg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPINGBINC/0YDQsNCy0LjQu9GM0L3QvtC5INGB0YLRgNGD0LrRgtGD0YDQvtC5INC00LDQvdC90YvRhVxuICAgIC8vINCU0LvRjyDQvtCx0YvRh9C90YvRhSDQv9C+0LvRjNC30L7QstCw0YLQtdC70LXQuSBpc0FwcHJvdmVkID0gZmFsc2UgLSDRgtGA0LXQsdGD0LXRgtGB0Y8g0L7QtNC+0LHRgNC10L3QuNC1INCw0LTQvNC40L3QuNGB0YLRgNCw0YLQvtGA0LBcbiAgICAvLyDQkNC00LzQuNC90LjRgdGC0YDQsNGC0L7RgNGLINC80L7Qs9GD0YIg0L7QtNC+0LHRgNC40YLRjCDQv9C+0LvRjNC30L7QstCw0YLQtdC70LXQuSDRh9C10YDQtdC3INCw0LTQvNC40L0g0L/QsNC90LXQu9GMXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGRhdGFiYXNlQWRhcHRlci5jcmVhdGVVc2VyKHtcbiAgICAgIGVtYWlsLFxuICAgICAgcGFzc3dvcmRfaGFzaDogaGFzaGVkUGFzc3dvcmQsXG4gICAgICBuYW1lLFxuICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgaXNBcHByb3ZlZDogZmFsc2VcbiAgICB9KTtcblxuICAgIC8vINCS0L7Qt9Cy0YDQsNGCINC00LDQvdC90YvRhSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8gKNCx0LXQtyDQv9Cw0YDQvtC70Y8pINGBINC/0YDQsNCy0LjQu9GM0L3QvtC5INGC0LjQv9C40LfQsNGG0LjQtdC5XG4gICAgY29uc3QgdXNlclJlc3VsdCA9IHtcbiAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICByb2xlOiB1c2VyLnJvbGUsXG4gICAgICBhcHByb3ZhbF9zdGF0dXM6IHVzZXIuaXNBcHByb3ZlZCA/ICdhcHByb3ZlZCcgOiAncGVuZGluZycsXG4gICAgICBpc0FwcHJvdmVkOiB1c2VyLmlzQXBwcm92ZWQsXG4gICAgICBhdmF0YXI6IHVzZXIuYXZhdGFyLFxuICAgICAgY3JlYXRlZEF0OiB1c2VyLmNyZWF0ZWRfYXRcbiAgICB9O1xuXG4gICAgLy8g0J3QlSDRgdC+0LfQtNCw0LXQvCDRgdC10YHRgdC40Y4g0LTQu9GPINC90LXQv9C+0LTRgtCy0LXRgNC20LTQtdC90L3Ri9GFINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQtdC5XG4gICAgLy8g0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC00L7Qu9C20LXQvSDQsdGL0YLRjCDQvtC00L7QsdGA0LXQvSDQsNC00LzQuNC90LjRgdGC0YDQsNGC0L7RgNC+0Lwg0L/QtdGA0LXQtCDQstGF0L7QtNC+0Lwg0LIg0YHQuNGB0YLQtdC80YNcbiAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIG1lc3NhZ2U6ICfQn9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0YPRgdC/0LXRiNC90L4g0LfQsNGA0LXQs9C40YHRgtGA0LjRgNC+0LLQsNC9LiDQntC20LjQtNCw0LnRgtC1INC/0L7QtNGC0LLQtdGA0LbQtNC10L3QuNGPINC+0YIg0LDQtNC80LjQvdC40YHRgtGA0LDRgtC+0YDQsC4nLFxuICAgICAgdXNlcjogdXNlclJlc3VsdCxcbiAgICAgIHJlcXVpcmVzQXBwcm92YWw6IHRydWVcbiAgICB9LCB7IHN0YXR1czogMjAxIH0pO1xuXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign0J7RiNC40LHQutCwINGA0LXQs9C40YHRgtGA0LDRhtC40Lg6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICfQktC90YPRgtGA0LXQvdC90Y/RjyDQvtGI0LjQsdC60LAg0YHQtdGA0LLQtdGA0LAnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIkRhdGFiYXNlQWRhcHRlciIsImJjcnlwdCIsImRhdGFiYXNlQWRhcHRlciIsImdldEluc3RhbmNlIiwiUE9TVCIsInJlcXVlc3QiLCJuYW1lIiwiZW1haWwiLCJwYXNzd29yZCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsImxlbmd0aCIsImVtYWlsUmVnZXgiLCJ0ZXN0IiwiZXhpc3RpbmdVc2VyIiwiZ2V0VXNlckJ5RW1haWwiLCJzYWx0Um91bmRzIiwiaGFzaGVkUGFzc3dvcmQiLCJoYXNoIiwidXNlciIsImNyZWF0ZVVzZXIiLCJwYXNzd29yZF9oYXNoIiwicm9sZSIsImlzQXBwcm92ZWQiLCJ1c2VyUmVzdWx0IiwiaWQiLCJhcHByb3ZhbF9zdGF0dXMiLCJhdmF0YXIiLCJjcmVhdGVkQXQiLCJjcmVhdGVkX2F0IiwicmVzcG9uc2UiLCJtZXNzYWdlIiwicmVxdWlyZXNBcHByb3ZhbCIsImNvbnNvbGUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/register/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/database-adapter.ts":
/*!*************************************!*\
  !*** ./src/lib/database-adapter.ts ***!
  \*************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DatabaseAdapter: () => (/* binding */ DatabaseAdapter),\n/* harmony export */   dbAdapter: () => (/* binding */ dbAdapter)\n/* harmony export */ });\n/* harmony import */ var _postgresql_adapter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./postgresql-adapter */ \"(rsc)/./src/lib/postgresql-adapter.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_postgresql_adapter__WEBPACK_IMPORTED_MODULE_0__]);\n_postgresql_adapter__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// =====================================================\n// АДАПТЕР ДЛЯ РАБОТЫ С БАЗАМИ ДАННЫХ (ИСПРАВЛЕННЫЙ)\n// =====================================================\n\n// =====================================================\n// КЛАСС АДАПТЕРА БАЗЫ ДАННЫХ\n// =====================================================\nclass DatabaseAdapter {\n    constructor(){\n        this.currentDatabase = 'postgresql';\n        this.isInitialized = false;\n        this.sqliteAdapter = null // Динамически загружается\n        ;\n        this.initializationPromise = null;\n        this.postgresqlAdapter = _postgresql_adapter__WEBPACK_IMPORTED_MODULE_0__.PostgreSQLAdapter.getInstance();\n        // SQLite адаптер будет создан только при необходимости\n        this.currentDatabase = 'postgresql'; // Используем PostgreSQL по умолчанию\n    }\n    static getInstance() {\n        if (!DatabaseAdapter.instance) {\n            DatabaseAdapter.instance = new DatabaseAdapter();\n        }\n        return DatabaseAdapter.instance;\n    }\n    /**\n   * Инициализация адаптера\n   */ async initialize() {\n        if (this.isInitialized) {\n            return;\n        }\n        if (this.initializationPromise) {\n            return this.initializationPromise;\n        }\n        this.initializationPromise = this.performInitialization();\n        return this.initializationPromise;\n    }\n    async performInitialization() {\n        const databasePriority = process.env.DATABASE_PRIORITY || 'postgresql';\n        console.log(`🔧 DATABASE_PRIORITY установлен в: ${databasePriority}`);\n        if (databasePriority === 'sqlite') {\n            try {\n                // Динамически импортируем SQLite адаптер\n                if (!this.sqliteAdapter) {\n                    const { SQLiteAdapter } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/uuid\"), __webpack_require__.e(\"_rsc_src_lib_sqlite-adapter_ts\")]).then(__webpack_require__.bind(__webpack_require__, /*! ./sqlite-adapter */ \"(rsc)/./src/lib/sqlite-adapter.ts\"));\n                    this.sqliteAdapter = SQLiteAdapter.getInstance();\n                }\n                await this.sqliteAdapter.initialize();\n                this.currentDatabase = 'sqlite';\n                this.isInitialized = true;\n                console.log('✅ Database Adapter инициализирован с SQLite');\n                return;\n            } catch (sqliteError) {\n                console.warn('⚠️ SQLite недоступен, переключаемся на PostgreSQL:', sqliteError);\n                // Fallback на PostgreSQL\n                try {\n                    await this.postgresqlAdapter.initialize();\n                    this.currentDatabase = 'postgresql';\n                    this.isInitialized = true;\n                    console.log('✅ Database Adapter инициализирован с PostgreSQL (fallback)');\n                    return;\n                } catch (postgresError) {\n                    console.error('❌ Ошибка инициализации обеих баз данных:', {\n                        sqliteError,\n                        postgresError\n                    });\n                    this.initializationPromise = null;\n                    throw postgresError;\n                }\n            }\n        } else {\n            try {\n                // Сначала пытаемся использовать PostgreSQL\n                await this.postgresqlAdapter.initialize();\n                this.currentDatabase = 'postgresql';\n                this.isInitialized = true;\n                console.log('✅ Database Adapter инициализирован с PostgreSQL');\n            } catch (postgresError) {\n                console.warn('⚠️ PostgreSQL недоступен, переключаемся на SQLite:', postgresError);\n                try {\n                    // Динамически импортируем SQLite адаптер только при необходимости\n                    if (!this.sqliteAdapter) {\n                        const { SQLiteAdapter } = await Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/uuid\"), __webpack_require__.e(\"_rsc_src_lib_sqlite-adapter_ts\")]).then(__webpack_require__.bind(__webpack_require__, /*! ./sqlite-adapter */ \"(rsc)/./src/lib/sqlite-adapter.ts\"));\n                        this.sqliteAdapter = SQLiteAdapter.getInstance();\n                    }\n                    // Fallback на SQLite\n                    await this.sqliteAdapter.initialize();\n                    this.currentDatabase = 'sqlite';\n                    this.isInitialized = true;\n                    console.log('✅ Database Adapter инициализирован с SQLite (fallback)');\n                } catch (sqliteError) {\n                    console.error('❌ Ошибка инициализации обеих баз данных:', {\n                        postgresError,\n                        sqliteError\n                    });\n                    this.initializationPromise = null;\n                    throw sqliteError;\n                }\n            }\n        }\n    }\n    /**\n   * Проверка инициализации перед выполнением операций\n   */ async ensureInitialized() {\n        if (!this.isInitialized) {\n            await this.initialize();\n        }\n        console.log(`🔍 DatabaseAdapter: используется ${this.currentDatabase}`);\n    }\n    /**\n   * Получение текущего адаптера базы данных\n   */ getCurrentAdapter() {\n        if (this.currentDatabase === 'sqlite') {\n            if (!this.sqliteAdapter) {\n                throw new Error('SQLite adapter not loaded');\n            }\n            return this.sqliteAdapter;\n        }\n        return this.postgresqlAdapter;\n    }\n    /**\n   * Получение статуса базы данных\n   */ async getDatabaseStatus() {\n        const postgresql = await Promise.resolve(this.postgresqlAdapter.initialize()).then(()=>true).catch(()=>false);\n        let sqlite = false;\n        // Проверяем SQLite только если адаптер загружен\n        if (this.sqliteAdapter) {\n            sqlite = await Promise.resolve(this.sqliteAdapter.initialize()).then(()=>true).catch(()=>false);\n        }\n        return {\n            postgresql,\n            sqlite,\n            current: this.currentDatabase\n        };\n    }\n    /**\n   * Получение текущей базы данных\n   */ getCurrentDatabase() {\n        return this.currentDatabase;\n    }\n    // =====================================================\n    // ОПЕРАЦИИ С ПОЛЬЗОВАТЕЛЯМИ\n    // =====================================================\n    /**\n   * Создание пользователя\n   */ async createUser(userData) {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.createUser(userData);\n    }\n    /**\n   * Получение пользователя по ID\n   */ async getUserById(id) {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.getUserById(id);\n    }\n    /**\n   * Получение пользователя по email\n   */ async getUserByEmail(email) {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.getUserByEmail(email);\n    }\n    /**\n   * Получение всех пользователей\n   */ async getAllUsers() {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.getAllUsers();\n    }\n    /**\n   * Получение пользователей (алиас для getAllUsers)\n   */ async getUsers() {\n        return await this.getAllUsers();\n    }\n    /**\n   * Обновление пользователя\n   */ async updateUser(id, updates) {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.updateUser(id, updates);\n    }\n    /**\n   * Удаление пользователя\n   */ async deleteUser(id) {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.deleteUser(id);\n    }\n    // =====================================================\n    // МЕТОДЫ ДЛЯ РАБОТЫ С СЕССИЯМИ\n    // =====================================================\n    async createSession(sessionData) {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.createSession(sessionData);\n    }\n    async getSessionByToken(token) {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.getSessionByToken(token);\n    }\n    async deleteSession(token) {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.deleteSession(token);\n    }\n    async deleteExpiredSessions() {\n        await this.ensureInitialized();\n        const adapter = this.getCurrentAdapter();\n        return await adapter.deleteExpiredSessions();\n    }\n    // =====================================================\n    // ОПЕРАЦИИ С ПРОЕКТАМИ\n    // =====================================================\n    /**\n   * Создание проекта\n   */ async createProject(projectData) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.createProject(projectData) : await this.postgresqlAdapter.createProject({\n            name: projectData.name,\n            description: projectData.description || '',\n            created_by: projectData.created_by,\n            color: projectData.color,\n            icon_url: projectData.icon_url\n        });\n    }\n    /**\n   * Получение проекта по ID\n   */ async getProjectById(id) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? this.sqliteAdapter.getProjectById(id) : this.postgresqlAdapter.getProjectById(id);\n    }\n    /**\n   * Получение всех проектов\n   */ async getAllProjects() {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? this.sqliteAdapter.getAllProjects() : this.postgresqlAdapter.getAllProjects();\n    }\n    /**\n   * Получение проектов пользователя\n   */ async getUserProjects(userId) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? this.sqliteAdapter.getUserProjects(userId) : this.postgresqlAdapter.getUserProjects(userId);\n    }\n    /**\n   * Получение проектов по ID создателя\n   */ async getProjectsByCreatorId(creatorId) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? this.sqliteAdapter.getUserProjects(creatorId) : this.postgresqlAdapter.getUserProjects(creatorId);\n    }\n    /**\n   * Проверка доступа к проекту\n   */ async hasProjectAccess(userId, projectId) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? this.sqliteAdapter.hasProjectAccess(userId.toString(), projectId) : this.postgresqlAdapter.hasProjectAccess(userId.toString(), projectId);\n    }\n    /**\n   * Обновление проекта\n   */ async updateProject(id, updates) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? this.sqliteAdapter.updateProject(id, updates) : this.postgresqlAdapter.updateProject(id, updates);\n    }\n    /**\n   * Удаление проекта\n   */ async deleteProject(id) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? this.sqliteAdapter.deleteProject(id) : this.postgresqlAdapter.deleteProject(id);\n    }\n    // =====================================================\n    // ОПЕРАЦИИ С ДОСКАМИ\n    // =====================================================\n    /**\n   * Создание доски\n   */ async createBoard(boardData) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.createBoard(boardData) : await this.postgresqlAdapter.createBoard(boardData);\n    }\n    /**\n   * Получение доски по ID\n   */ async getBoardById(id) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.getBoardById(id) : await this.postgresqlAdapter.getBoardById(id);\n    }\n    /**\n   * Получение досок проекта\n   */ async getProjectBoards(projectId) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.getProjectBoards(projectId) : await this.postgresqlAdapter.getBoardsByProjectId(projectId);\n    }\n    /**\n   * Удаление доски\n   */ async deleteBoard(id) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.deleteBoard(id) : await this.postgresqlAdapter.deleteBoard(id);\n    }\n    // =====================================================\n    // ОПЕРАЦИИ С КОЛОНКАМИ\n    // =====================================================\n    /**\n   * Получение колонок доски\n   */ async getBoardColumns(boardId) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.getBoardColumns(boardId) : await this.postgresqlAdapter.getBoardColumns(boardId);\n    }\n    /**\n   * Создание колонки\n   */ async createColumn(columnData) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.createColumn(columnData) : await this.postgresqlAdapter.createColumn(columnData.name || columnData.title, columnData.board_id.toString(), columnData.position || 0, columnData.color, columnData.created_by);\n    }\n    /**\n   * Удаление колонки\n   */ async deleteColumn(id) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.deleteColumn(id) : await this.postgresqlAdapter.deleteColumn(id);\n    }\n    // =====================================================\n    // ОПЕРАЦИИ С ЗАДАЧАМИ\n    // =====================================================\n    /**\n   * Создание задачи\n   */ async createTask(taskData) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.createTask(taskData) : await this.postgresqlAdapter.createTask({\n            title: taskData.title,\n            description: taskData.description || '',\n            column_id: taskData.column_id,\n            assignee_id: taskData.assignee_id,\n            priority: taskData.priority || 'medium',\n            position: taskData.position || 0,\n            status: taskData.status || 'todo',\n            project_id: taskData.project_id,\n            board_id: taskData.board_id,\n            reporter_id: taskData.creator_id\n        });\n    }\n    /**\n   * Получение задач колонки\n   */ async getColumnTasks(columnId) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.getColumnTasks(columnId) : await this.postgresqlAdapter.getColumnTasks(columnId);\n    }\n    /**\n   * Удаление задачи\n   */ async deleteTask(id) {\n        await this.ensureInitialized();\n        return this.currentDatabase === 'sqlite' ? await this.sqliteAdapter.deleteTask(id) : await this.postgresqlAdapter.deleteTask(id);\n    }\n    /**\n   * Выполнение сырого SQL запроса (для совместимости с репозиториями)\n   */ async query(sql, params) {\n        await this.ensureInitialized();\n        if (this.currentDatabase === 'sqlite') {\n            const result = await this.sqliteAdapter.query(sql, params);\n            return result.rows;\n        } else {\n            const result = await this.postgresqlAdapter.query(sql, params);\n            return result.rows;\n        }\n    }\n}\n// Экспорт единственного экземпляра\nconst dbAdapter = DatabaseAdapter.getInstance();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUN2RCxPQUFPQyxPQUFPQyxJQUFJO1FBQ3BCO0lBQ0Y7QUFDRjtBQUVBLG1DQUFtQztBQUM1QixNQUFNQyxZQUFZcEcsZ0JBQWdCTSxXQUFXLEdBQUciLCJzb3VyY2VzIjpbIkU6XFxQcm9qZWN0c1xcZW5jb3JlLXRhc2tzXFxlbmNvcmUtdGFza3MtbWFpblxcc3JjXFxsaWJcXGRhdGFiYXNlLWFkYXB0ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vINCQ0JTQkNCf0KLQldCgINCU0JvQryDQoNCQ0JHQntCi0Ksg0KEg0JHQkNCX0JDQnNCYINCU0JDQndCd0KvQpSAo0JjQodCf0KDQkNCS0JvQldCd0J3Qq9CZKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IHsgVXNlciwgUHJvamVjdCwgQm9hcmQsIENvbHVtbiwgVGFzaywgU2Vzc2lvbiB9IGZyb20gJ0AvdHlwZXMnO1xuaW1wb3J0IHsgUG9zdGdyZVNRTEFkYXB0ZXIgfSBmcm9tICcuL3Bvc3RncmVzcWwtYWRhcHRlcic7XG4vLyBTUUxpdGUg0LDQtNCw0L/RgtC10YAg0LjQvNC/0L7RgNGC0LjRgNGD0LXRgtGB0Y8g0LTQuNC90LDQvNC40YfQtdGB0LrQuCDRgtC+0LvRjNC60L4g0L/RgNC4INC90LXQvtCx0YXQvtC00LjQvNC+0YHRgtC4XG4vLyBpbXBvcnQgeyBTUUxpdGVBZGFwdGVyIH0gZnJvbSAnLi9zcWxpdGUtYWRhcHRlcic7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDQotCY0J/QqyDQlNCQ0J3QndCr0KVcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCB0eXBlIERhdGFiYXNlVHlwZSA9ICdwb3N0Z3Jlc3FsJyB8ICdzcWxpdGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERhdGFiYXNlU3RhdHVzIHtcbiAgcG9zdGdyZXNxbDogYm9vbGVhbjtcbiAgc3FsaXRlOiBib29sZWFuO1xuICBjdXJyZW50OiBEYXRhYmFzZVR5cGU7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDQmtCb0JDQodChINCQ0JTQkNCf0KLQldCg0JAg0JHQkNCX0Ksg0JTQkNCd0J3Qq9ClXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY2xhc3MgRGF0YWJhc2VBZGFwdGVyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IERhdGFiYXNlQWRhcHRlcjtcbiAgcHJpdmF0ZSBjdXJyZW50RGF0YWJhc2U6IERhdGFiYXNlVHlwZSA9ICdwb3N0Z3Jlc3FsJztcbiAgcHJpdmF0ZSBpc0luaXRpYWxpemVkID0gZmFsc2U7XG4gIHByaXZhdGUgcG9zdGdyZXNxbEFkYXB0ZXI6IFBvc3RncmVTUUxBZGFwdGVyO1xuICBwcml2YXRlIHNxbGl0ZUFkYXB0ZXI6IGFueSA9IG51bGw7IC8vINCU0LjQvdCw0LzQuNGH0LXRgdC60Lgg0LfQsNCz0YDRg9C20LDQtdGC0YHRj1xuICBwcml2YXRlIGluaXRpYWxpemF0aW9uUHJvbWlzZTogUHJvbWlzZTx2b2lkPiB8IG51bGwgPSBudWxsO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5wb3N0Z3Jlc3FsQWRhcHRlciA9IFBvc3RncmVTUUxBZGFwdGVyLmdldEluc3RhbmNlKCk7XG4gICAgLy8gU1FMaXRlINCw0LTQsNC/0YLQtdGAINCx0YPQtNC10YIg0YHQvtC30LTQsNC9INGC0L7Qu9GM0LrQviDQv9GA0Lgg0L3QtdC+0LHRhdC+0LTQuNC80L7RgdGC0LhcbiAgICB0aGlzLmN1cnJlbnREYXRhYmFzZSA9ICdwb3N0Z3Jlc3FsJzsgLy8g0JjRgdC/0L7Qu9GM0LfRg9C10LwgUG9zdGdyZVNRTCDQv9C+INGD0LzQvtC70YfQsNC90LjRjlxuICB9XG5cbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBEYXRhYmFzZUFkYXB0ZXIge1xuICAgIGlmICghRGF0YWJhc2VBZGFwdGVyLmluc3RhbmNlKSB7XG4gICAgICBEYXRhYmFzZUFkYXB0ZXIuaW5zdGFuY2UgPSBuZXcgRGF0YWJhc2VBZGFwdGVyKCk7XG4gICAgfVxuICAgIHJldHVybiBEYXRhYmFzZUFkYXB0ZXIuaW5zdGFuY2U7XG4gIH1cblxuICAvKipcbiAgICog0JjQvdC40YbQuNCw0LvQuNC30LDRhtC40Y8g0LDQtNCw0L/RgtC10YDQsFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGluaXRpYWxpemUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmluaXRpYWxpemF0aW9uUHJvbWlzZSkge1xuICAgICAgcmV0dXJuIHRoaXMuaW5pdGlhbGl6YXRpb25Qcm9taXNlO1xuICAgIH1cblxuICAgIHRoaXMuaW5pdGlhbGl6YXRpb25Qcm9taXNlID0gdGhpcy5wZXJmb3JtSW5pdGlhbGl6YXRpb24oKTtcbiAgICByZXR1cm4gdGhpcy5pbml0aWFsaXphdGlvblByb21pc2U7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1Jbml0aWFsaXphdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBkYXRhYmFzZVByaW9yaXR5ID0gcHJvY2Vzcy5lbnYuREFUQUJBU0VfUFJJT1JJVFkgfHwgJ3Bvc3RncmVzcWwnO1xuICAgIGNvbnNvbGUubG9nKGDwn5SnIERBVEFCQVNFX1BSSU9SSVRZINGD0YHRgtCw0L3QvtCy0LvQtdC9INCyOiAke2RhdGFiYXNlUHJpb3JpdHl9YCk7XG4gICAgXG4gICAgaWYgKGRhdGFiYXNlUHJpb3JpdHkgPT09ICdzcWxpdGUnKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyDQlNC40L3QsNC80LjRh9C10YHQutC4INC40LzQv9C+0YDRgtC40YDRg9C10LwgU1FMaXRlINCw0LTQsNC/0YLQtdGAXG4gICAgICAgIGlmICghdGhpcy5zcWxpdGVBZGFwdGVyKSB7XG4gICAgICAgICAgY29uc3QgeyBTUUxpdGVBZGFwdGVyIH0gPSBhd2FpdCBpbXBvcnQoJy4vc3FsaXRlLWFkYXB0ZXInKTtcbiAgICAgICAgICB0aGlzLnNxbGl0ZUFkYXB0ZXIgPSBTUUxpdGVBZGFwdGVyLmdldEluc3RhbmNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgdGhpcy5zcWxpdGVBZGFwdGVyLmluaXRpYWxpemUoKTtcbiAgICAgICAgdGhpcy5jdXJyZW50RGF0YWJhc2UgPSAnc3FsaXRlJztcbiAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgY29uc29sZS5sb2coJ+KchSBEYXRhYmFzZSBBZGFwdGVyINC40L3QuNGG0LjQsNC70LjQt9C40YDQvtCy0LDQvSDRgSBTUUxpdGUnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBjYXRjaCAoc3FsaXRlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gU1FMaXRlINC90LXQtNC+0YHRgtGD0L/QtdC9LCDQv9C10YDQtdC60LvRjtGH0LDQtdC80YHRjyDQvdCwIFBvc3RncmVTUUw6Jywgc3FsaXRlRXJyb3IpO1xuICAgICAgICAvLyBGYWxsYmFjayDQvdCwIFBvc3RncmVTUUxcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBvc3RncmVzcWxBZGFwdGVyLmluaXRpYWxpemUoKTtcbiAgICAgICAgICB0aGlzLmN1cnJlbnREYXRhYmFzZSA9ICdwb3N0Z3Jlc3FsJztcbiAgICAgICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgRGF0YWJhc2UgQWRhcHRlciDQuNC90LjRhtC40LDQu9C40LfQuNGA0L7QstCw0L0g0YEgUG9zdGdyZVNRTCAoZmFsbGJhY2spJyk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGNhdGNoIChwb3N0Z3Jlc0Vycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcign4p2MINCe0YjQuNCx0LrQsCDQuNC90LjRhtC40LDQu9C40LfQsNGG0LjQuCDQvtCx0LXQuNGFINCx0LDQtyDQtNCw0L3QvdGL0YU6JywgeyBzcWxpdGVFcnJvciwgcG9zdGdyZXNFcnJvciB9KTtcbiAgICAgICAgICB0aGlzLmluaXRpYWxpemF0aW9uUHJvbWlzZSA9IG51bGw7XG4gICAgICAgICAgdGhyb3cgcG9zdGdyZXNFcnJvcjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyDQodC90LDRh9Cw0LvQsCDQv9GL0YLQsNC10LzRgdGPINC40YHQv9C+0LvRjNC30L7QstCw0YLRjCBQb3N0Z3JlU1FMXG4gICAgICAgIGF3YWl0IHRoaXMucG9zdGdyZXNxbEFkYXB0ZXIuaW5pdGlhbGl6ZSgpO1xuICAgICAgICB0aGlzLmN1cnJlbnREYXRhYmFzZSA9ICdwb3N0Z3Jlc3FsJztcbiAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgY29uc29sZS5sb2coJ+KchSBEYXRhYmFzZSBBZGFwdGVyINC40L3QuNGG0LjQsNC70LjQt9C40YDQvtCy0LDQvSDRgSBQb3N0Z3JlU1FMJyk7XG4gICAgICB9IGNhdGNoIChwb3N0Z3Jlc0Vycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIFBvc3RncmVTUUwg0L3QtdC00L7RgdGC0YPQv9C10L0sINC/0LXRgNC10LrQu9GO0YfQsNC10LzRgdGPINC90LAgU1FMaXRlOicsIHBvc3RncmVzRXJyb3IpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vINCU0LjQvdCw0LzQuNGH0LXRgdC60Lgg0LjQvNC/0L7RgNGC0LjRgNGD0LXQvCBTUUxpdGUg0LDQtNCw0L/RgtC10YAg0YLQvtC70YzQutC+INC/0YDQuCDQvdC10L7QsdGF0L7QtNC40LzQvtGB0YLQuFxuICAgICAgICAgIGlmICghdGhpcy5zcWxpdGVBZGFwdGVyKSB7XG4gICAgICAgICAgICBjb25zdCB7IFNRTGl0ZUFkYXB0ZXIgfSA9IGF3YWl0IGltcG9ydCgnLi9zcWxpdGUtYWRhcHRlcicpO1xuICAgICAgICAgICAgdGhpcy5zcWxpdGVBZGFwdGVyID0gU1FMaXRlQWRhcHRlci5nZXRJbnN0YW5jZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBGYWxsYmFjayDQvdCwIFNRTGl0ZVxuICAgICAgICAgIGF3YWl0IHRoaXMuc3FsaXRlQWRhcHRlci5pbml0aWFsaXplKCk7XG4gICAgICAgICAgdGhpcy5jdXJyZW50RGF0YWJhc2UgPSAnc3FsaXRlJztcbiAgICAgICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgRGF0YWJhc2UgQWRhcHRlciDQuNC90LjRhtC40LDQu9C40LfQuNGA0L7QstCw0L0g0YEgU1FMaXRlIChmYWxsYmFjayknKTtcbiAgICAgICAgfSBjYXRjaCAoc3FsaXRlRXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwg0J7RiNC40LHQutCwINC40L3QuNGG0LjQsNC70LjQt9Cw0YbQuNC4INC+0LHQtdC40YUg0LHQsNC3INC00LDQvdC90YvRhTonLCB7IHBvc3RncmVzRXJyb3IsIHNxbGl0ZUVycm9yIH0pO1xuICAgICAgICAgIHRoaXMuaW5pdGlhbGl6YXRpb25Qcm9taXNlID0gbnVsbDtcbiAgICAgICAgICB0aHJvdyBzcWxpdGVFcnJvcjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDQn9GA0L7QstC10YDQutCwINC40L3QuNGG0LjQsNC70LjQt9Cw0YbQuNC4INC/0LXRgNC10LQg0LLRi9C/0L7Qu9C90LXQvdC40LXQvCDQvtC/0LXRgNCw0YbQuNC5XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGVuc3VyZUluaXRpYWxpemVkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5pc0luaXRpYWxpemVkKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemUoKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coYPCflI0gRGF0YWJhc2VBZGFwdGVyOiDQuNGB0L/QvtC70YzQt9GD0LXRgtGB0Y8gJHt0aGlzLmN1cnJlbnREYXRhYmFzZX1gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQn9C+0LvRg9GH0LXQvdC40LUg0YLQtdC60YPRidC10LPQviDQsNC00LDQv9GC0LXRgNCwINCx0LDQt9GLINC00LDQvdC90YvRhVxuICAgKi9cbiAgcHJpdmF0ZSBnZXRDdXJyZW50QWRhcHRlcigpIHtcbiAgICBpZiAodGhpcy5jdXJyZW50RGF0YWJhc2UgPT09ICdzcWxpdGUnKSB7XG4gICAgICBpZiAoIXRoaXMuc3FsaXRlQWRhcHRlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NRTGl0ZSBhZGFwdGVyIG5vdCBsb2FkZWQnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnNxbGl0ZUFkYXB0ZXI7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnBvc3RncmVzcWxBZGFwdGVyO1xuICB9XG5cbiAgLyoqXG4gICAqINCf0L7Qu9GD0YfQtdC90LjQtSDRgdGC0LDRgtGD0YHQsCDQsdCw0LfRiyDQtNCw0L3QvdGL0YVcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXREYXRhYmFzZVN0YXR1cygpOiBQcm9taXNlPERhdGFiYXNlU3RhdHVzPiB7XG4gICAgY29uc3QgcG9zdGdyZXNxbCA9IGF3YWl0IFByb21pc2UucmVzb2x2ZSh0aGlzLnBvc3RncmVzcWxBZGFwdGVyLmluaXRpYWxpemUoKSkudGhlbigoKSA9PiB0cnVlKS5jYXRjaCgoKSA9PiBmYWxzZSk7XG4gICAgbGV0IHNxbGl0ZSA9IGZhbHNlO1xuICAgIFxuICAgIC8vINCf0YDQvtCy0LXRgNGP0LXQvCBTUUxpdGUg0YLQvtC70YzQutC+INC10YHQu9C4INCw0LTQsNC/0YLQtdGAINC30LDQs9GA0YPQttC10L1cbiAgICBpZiAodGhpcy5zcWxpdGVBZGFwdGVyKSB7XG4gICAgICBzcWxpdGUgPSBhd2FpdCBQcm9taXNlLnJlc29sdmUodGhpcy5zcWxpdGVBZGFwdGVyLmluaXRpYWxpemUoKSkudGhlbigoKSA9PiB0cnVlKS5jYXRjaCgoKSA9PiBmYWxzZSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBwb3N0Z3Jlc3FsLFxuICAgICAgc3FsaXRlLFxuICAgICAgY3VycmVudDogdGhpcy5jdXJyZW50RGF0YWJhc2VcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqINCf0L7Qu9GD0YfQtdC90LjQtSDRgtC10LrRg9GJ0LXQuSDQsdCw0LfRiyDQtNCw0L3QvdGL0YVcbiAgICovXG4gIHB1YmxpYyBnZXRDdXJyZW50RGF0YWJhc2UoKTogRGF0YWJhc2VUeXBlIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50RGF0YWJhc2U7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDQntCf0JXQoNCQ0KbQmNCYINChINCf0J7Qm9Cs0JfQntCS0JDQotCV0JvQr9Cc0JhcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog0KHQvtC30LTQsNC90LjQtSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y9cbiAgICovXG4gIHB1YmxpYyBhc3luYyBjcmVhdGVVc2VyKHVzZXJEYXRhOiBPbWl0PFVzZXIsICdpZCcgfCAnY3JlYXRlZF9hdCcgfCAndXBkYXRlZF9hdCc+KTogUHJvbWlzZTxVc2VyPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIGNvbnN0IGFkYXB0ZXIgPSB0aGlzLmdldEN1cnJlbnRBZGFwdGVyKCk7XG4gICAgcmV0dXJuIGF3YWl0IGFkYXB0ZXIuY3JlYXRlVXNlcih1c2VyRGF0YSk7XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C10L3QuNC1INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDQv9C+IElEXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0VXNlckJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8VXNlciB8IG51bGw+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgY29uc3QgYWRhcHRlciA9IHRoaXMuZ2V0Q3VycmVudEFkYXB0ZXIoKTtcbiAgICByZXR1cm4gYXdhaXQgYWRhcHRlci5nZXRVc2VyQnlJZChpZCk7XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C10L3QuNC1INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDQv9C+IGVtYWlsXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0VXNlckJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8VXNlciB8IG51bGw+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgY29uc3QgYWRhcHRlciA9IHRoaXMuZ2V0Q3VycmVudEFkYXB0ZXIoKTtcbiAgICByZXR1cm4gYXdhaXQgYWRhcHRlci5nZXRVc2VyQnlFbWFpbChlbWFpbCk7XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C10L3QuNC1INCy0YHQtdGFINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQtdC5XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0QWxsVXNlcnMoKTogUHJvbWlzZTxVc2VyW10+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgY29uc3QgYWRhcHRlciA9IHRoaXMuZ2V0Q3VycmVudEFkYXB0ZXIoKTtcbiAgICByZXR1cm4gYXdhaXQgYWRhcHRlci5nZXRBbGxVc2VycygpO1xuICB9XG5cbiAgLyoqXG4gICAqINCf0L7Qu9GD0YfQtdC90LjQtSDQv9C+0LvRjNC30L7QstCw0YLQtdC70LXQuSAo0LDQu9C40LDRgSDQtNC70Y8gZ2V0QWxsVXNlcnMpXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0VXNlcnMoKTogUHJvbWlzZTxVc2VyW10+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRBbGxVc2VycygpO1xuICB9XG5cbiAgLyoqXG4gICAqINCe0LHQvdC+0LLQu9C10L3QuNC1INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xuICAgKi9cbiAgcHVibGljIGFzeW5jIHVwZGF0ZVVzZXIoaWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxVc2VyPik6IFByb21pc2U8VXNlciB8IG51bGw+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgY29uc3QgYWRhcHRlciA9IHRoaXMuZ2V0Q3VycmVudEFkYXB0ZXIoKTtcbiAgICByZXR1cm4gYXdhaXQgYWRhcHRlci51cGRhdGVVc2VyKGlkLCB1cGRhdGVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQo9C00LDQu9C10L3QuNC1INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGRlbGV0ZVVzZXIoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICBjb25zdCBhZGFwdGVyID0gdGhpcy5nZXRDdXJyZW50QWRhcHRlcigpO1xuICAgIHJldHVybiBhd2FpdCBhZGFwdGVyLmRlbGV0ZVVzZXIoaWQpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g0JzQldCi0J7QlNCrINCU0JvQryDQoNCQ0JHQntCi0Ksg0KEg0KHQldCh0KHQmNCv0JzQmFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHB1YmxpYyBhc3luYyBjcmVhdGVTZXNzaW9uKHNlc3Npb25EYXRhOiBPbWl0PFNlc3Npb24sICdpZCcgfCAnY3JlYXRlZF9hdCcgfCAndXBkYXRlZF9hdCc+KTogUHJvbWlzZTxTZXNzaW9uPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIGNvbnN0IGFkYXB0ZXIgPSB0aGlzLmdldEN1cnJlbnRBZGFwdGVyKCk7XG4gICAgcmV0dXJuIGF3YWl0IGFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihzZXNzaW9uRGF0YSk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0U2Vzc2lvbkJ5VG9rZW4odG9rZW46IHN0cmluZyk6IFByb21pc2U8U2Vzc2lvbiB8IG51bGw+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgY29uc3QgYWRhcHRlciA9IHRoaXMuZ2V0Q3VycmVudEFkYXB0ZXIoKTtcbiAgICByZXR1cm4gYXdhaXQgYWRhcHRlci5nZXRTZXNzaW9uQnlUb2tlbih0b2tlbik7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZGVsZXRlU2Vzc2lvbih0b2tlbjogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIGNvbnN0IGFkYXB0ZXIgPSB0aGlzLmdldEN1cnJlbnRBZGFwdGVyKCk7XG4gICAgcmV0dXJuIGF3YWl0IGFkYXB0ZXIuZGVsZXRlU2Vzc2lvbih0b2tlbik7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZGVsZXRlRXhwaXJlZFNlc3Npb25zKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIGNvbnN0IGFkYXB0ZXIgPSB0aGlzLmdldEN1cnJlbnRBZGFwdGVyKCk7XG4gICAgcmV0dXJuIGF3YWl0IGFkYXB0ZXIuZGVsZXRlRXhwaXJlZFNlc3Npb25zKCk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDQntCf0JXQoNCQ0KbQmNCYINChINCf0KDQntCV0JrQotCQ0JzQmFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDQodC+0LfQtNCw0L3QuNC1INC/0YDQvtC10LrRgtCwXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY3JlYXRlUHJvamVjdChwcm9qZWN0RGF0YTogT21pdDxQcm9qZWN0LCAnaWQnIHwgJ2NyZWF0ZWRfYXQnIHwgJ3VwZGF0ZWRfYXQnPik6IFByb21pc2U8UHJvamVjdD4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50RGF0YWJhc2UgPT09ICdzcWxpdGUnID8gXG4gICAgICBhd2FpdCB0aGlzLnNxbGl0ZUFkYXB0ZXIuY3JlYXRlUHJvamVjdChwcm9qZWN0RGF0YSkgOiBcbiAgICAgIGF3YWl0IHRoaXMucG9zdGdyZXNxbEFkYXB0ZXIuY3JlYXRlUHJvamVjdCh7XG4gICAgICAgIG5hbWU6IHByb2plY3REYXRhLm5hbWUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBwcm9qZWN0RGF0YS5kZXNjcmlwdGlvbiB8fCAnJyxcbiAgICAgICAgY3JlYXRlZF9ieTogcHJvamVjdERhdGEuY3JlYXRlZF9ieSxcbiAgICAgICAgY29sb3I6IHByb2plY3REYXRhLmNvbG9yLFxuICAgICAgICBpY29uX3VybDogcHJvamVjdERhdGEuaWNvbl91cmxcbiAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqINCf0L7Qu9GD0YfQtdC90LjQtSDQv9GA0L7QtdC60YLQsCDQv9C+IElEXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZ2V0UHJvamVjdEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8UHJvamVjdCB8IG51bGw+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudERhdGFiYXNlID09PSAnc3FsaXRlJyA/IHRoaXMuc3FsaXRlQWRhcHRlci5nZXRQcm9qZWN0QnlJZChpZCkgOiB0aGlzLnBvc3RncmVzcWxBZGFwdGVyLmdldFByb2plY3RCeUlkKGlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQn9C+0LvRg9GH0LXQvdC40LUg0LLRgdC10YUg0L/RgNC+0LXQutGC0L7QslxuICAgKi9cbiAgcHVibGljIGFzeW5jIGdldEFsbFByb2plY3RzKCk6IFByb21pc2U8UHJvamVjdFtdPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhYmFzZSA9PT0gJ3NxbGl0ZScgPyB0aGlzLnNxbGl0ZUFkYXB0ZXIuZ2V0QWxsUHJvamVjdHMoKSA6IHRoaXMucG9zdGdyZXNxbEFkYXB0ZXIuZ2V0QWxsUHJvamVjdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQn9C+0LvRg9GH0LXQvdC40LUg0L/RgNC+0LXQutGC0L7QsiDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y9cbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRVc2VyUHJvamVjdHModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFByb2plY3RbXT4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50RGF0YWJhc2UgPT09ICdzcWxpdGUnID8gdGhpcy5zcWxpdGVBZGFwdGVyLmdldFVzZXJQcm9qZWN0cyh1c2VySWQpIDogdGhpcy5wb3N0Z3Jlc3FsQWRhcHRlci5nZXRVc2VyUHJvamVjdHModXNlcklkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQn9C+0LvRg9GH0LXQvdC40LUg0L/RgNC+0LXQutGC0L7QsiDQv9C+IElEINGB0L7Qt9C00LDRgtC10LvRj1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGdldFByb2plY3RzQnlDcmVhdG9ySWQoY3JlYXRvcklkOiBzdHJpbmcpOiBQcm9taXNlPFByb2plY3RbXT4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50RGF0YWJhc2UgPT09ICdzcWxpdGUnID8gdGhpcy5zcWxpdGVBZGFwdGVyLmdldFVzZXJQcm9qZWN0cyhjcmVhdG9ySWQpIDogdGhpcy5wb3N0Z3Jlc3FsQWRhcHRlci5nZXRVc2VyUHJvamVjdHMoY3JlYXRvcklkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQn9GA0L7QstC10YDQutCwINC00L7RgdGC0YPQv9CwINC6INC/0YDQvtC10LrRgtGDXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaGFzUHJvamVjdEFjY2Vzcyh1c2VySWQ6IHN0cmluZyB8IG51bWJlciwgcHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudERhdGFiYXNlID09PSAnc3FsaXRlJyA/IHRoaXMuc3FsaXRlQWRhcHRlci5oYXNQcm9qZWN0QWNjZXNzKHVzZXJJZC50b1N0cmluZygpLCBwcm9qZWN0SWQpIDogdGhpcy5wb3N0Z3Jlc3FsQWRhcHRlci5oYXNQcm9qZWN0QWNjZXNzKHVzZXJJZC50b1N0cmluZygpLCBwcm9qZWN0SWQpO1xuICB9XG5cbiAgLyoqXG4gICAqINCe0LHQvdC+0LLQu9C10L3QuNC1INC/0YDQvtC10LrRgtCwXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdXBkYXRlUHJvamVjdChpZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPFByb2plY3Q+KTogUHJvbWlzZTxQcm9qZWN0IHwgbnVsbD4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50RGF0YWJhc2UgPT09ICdzcWxpdGUnID8gdGhpcy5zcWxpdGVBZGFwdGVyLnVwZGF0ZVByb2plY3QoaWQsIHVwZGF0ZXMpIDogdGhpcy5wb3N0Z3Jlc3FsQWRhcHRlci51cGRhdGVQcm9qZWN0KGlkLCB1cGRhdGVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQo9C00LDQu9C10L3QuNC1INC/0YDQvtC10LrRgtCwXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZGVsZXRlUHJvamVjdChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhYmFzZSA9PT0gJ3NxbGl0ZScgPyB0aGlzLnNxbGl0ZUFkYXB0ZXIuZGVsZXRlUHJvamVjdChpZCkgOiB0aGlzLnBvc3RncmVzcWxBZGFwdGVyLmRlbGV0ZVByb2plY3QoaWQpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g0J7Qn9CV0KDQkNCm0JjQmCDQoSDQlNCe0KHQmtCQ0JzQmFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDQodC+0LfQtNCw0L3QuNC1INC00L7RgdC60LhcbiAgICovXG4gIHB1YmxpYyBhc3luYyBjcmVhdGVCb2FyZChib2FyZERhdGE6IE9taXQ8Qm9hcmQsICdpZCcgfCAnY3JlYXRlZF9hdCcgfCAndXBkYXRlZF9hdCc+KTogUHJvbWlzZTxCb2FyZD4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50RGF0YWJhc2UgPT09ICdzcWxpdGUnID8gXG4gICAgICBhd2FpdCB0aGlzLnNxbGl0ZUFkYXB0ZXIuY3JlYXRlQm9hcmQoYm9hcmREYXRhKSA6IFxuICAgICAgYXdhaXQgdGhpcy5wb3N0Z3Jlc3FsQWRhcHRlci5jcmVhdGVCb2FyZChib2FyZERhdGEpO1xuICB9XG5cbiAgLyoqXG4gICAqINCf0L7Qu9GD0YfQtdC90LjQtSDQtNC+0YHQutC4INC/0L4gSURcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRCb2FyZEJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8Qm9hcmQgfCBudWxsPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhYmFzZSA9PT0gJ3NxbGl0ZScgPyBcbiAgICAgIGF3YWl0IHRoaXMuc3FsaXRlQWRhcHRlci5nZXRCb2FyZEJ5SWQoaWQpIDogXG4gICAgICBhd2FpdCB0aGlzLnBvc3RncmVzcWxBZGFwdGVyLmdldEJvYXJkQnlJZChpZCk7XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C10L3QuNC1INC00L7RgdC+0Log0L/RgNC+0LXQutGC0LBcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRQcm9qZWN0Qm9hcmRzKHByb2plY3RJZDogc3RyaW5nKTogUHJvbWlzZTxCb2FyZFtdPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhYmFzZSA9PT0gJ3NxbGl0ZScgPyBcbiAgICAgIGF3YWl0IHRoaXMuc3FsaXRlQWRhcHRlci5nZXRQcm9qZWN0Qm9hcmRzKHByb2plY3RJZCkgOiBcbiAgICAgIGF3YWl0IHRoaXMucG9zdGdyZXNxbEFkYXB0ZXIuZ2V0Qm9hcmRzQnlQcm9qZWN0SWQocHJvamVjdElkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQo9C00LDQu9C10L3QuNC1INC00L7RgdC60LhcbiAgICovXG4gIHB1YmxpYyBhc3luYyBkZWxldGVCb2FyZChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhYmFzZSA9PT0gJ3NxbGl0ZScgPyBcbiAgICAgIGF3YWl0IHRoaXMuc3FsaXRlQWRhcHRlci5kZWxldGVCb2FyZChpZCkgOiBcbiAgICAgIGF3YWl0IHRoaXMucG9zdGdyZXNxbEFkYXB0ZXIuZGVsZXRlQm9hcmQoaWQpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8g0J7Qn9CV0KDQkNCm0JjQmCDQoSDQmtCe0JvQntCd0JrQkNCc0JhcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C10L3QuNC1INC60L7Qu9C+0L3QvtC6INC00L7RgdC60LhcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRCb2FyZENvbHVtbnMoYm9hcmRJZDogc3RyaW5nKTogUHJvbWlzZTxDb2x1bW5bXT4ge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50RGF0YWJhc2UgPT09ICdzcWxpdGUnID8gXG4gICAgICBhd2FpdCB0aGlzLnNxbGl0ZUFkYXB0ZXIuZ2V0Qm9hcmRDb2x1bW5zKGJvYXJkSWQpIDogXG4gICAgICBhd2FpdCB0aGlzLnBvc3RncmVzcWxBZGFwdGVyLmdldEJvYXJkQ29sdW1ucyhib2FyZElkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDQodC+0LfQtNCw0L3QuNC1INC60L7Qu9C+0L3QutC4XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY3JlYXRlQ29sdW1uKGNvbHVtbkRhdGE6IE9taXQ8Q29sdW1uLCAnaWQnIHwgJ2NyZWF0ZWRfYXQnIHwgJ3VwZGF0ZWRfYXQnPik6IFByb21pc2U8Q29sdW1uPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhYmFzZSA9PT0gJ3NxbGl0ZScgPyBcbiAgICAgIGF3YWl0IHRoaXMuc3FsaXRlQWRhcHRlci5jcmVhdGVDb2x1bW4oY29sdW1uRGF0YSkgOiBcbiAgICAgIGF3YWl0IHRoaXMucG9zdGdyZXNxbEFkYXB0ZXIuY3JlYXRlQ29sdW1uKFxuICAgICAgICBjb2x1bW5EYXRhLm5hbWUgfHwgY29sdW1uRGF0YS50aXRsZSwgXG4gICAgICAgIGNvbHVtbkRhdGEuYm9hcmRfaWQudG9TdHJpbmcoKSwgXG4gICAgICAgIGNvbHVtbkRhdGEucG9zaXRpb24gfHwgMCwgXG4gICAgICAgIGNvbHVtbkRhdGEuY29sb3IsIFxuICAgICAgICBjb2x1bW5EYXRhLmNyZWF0ZWRfYnlcbiAgICAgICk7XG4gIH1cblxuICAvKipcbiAgICog0KPQtNCw0LvQtdC90LjQtSDQutC+0LvQvtC90LrQuFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGRlbGV0ZUNvbHVtbihpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhYmFzZSA9PT0gJ3NxbGl0ZScgPyBcbiAgICAgIGF3YWl0IHRoaXMuc3FsaXRlQWRhcHRlci5kZWxldGVDb2x1bW4oaWQpIDogXG4gICAgICBhd2FpdCB0aGlzLnBvc3RncmVzcWxBZGFwdGVyLmRlbGV0ZUNvbHVtbihpZCk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyDQntCf0JXQoNCQ0KbQmNCYINChINCX0JDQlNCQ0KfQkNCc0JhcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog0KHQvtC30LTQsNC90LjQtSDQt9Cw0LTQsNGH0LhcbiAgICovXG4gIHB1YmxpYyBhc3luYyBjcmVhdGVUYXNrKHRhc2tEYXRhOiBPbWl0PFRhc2ssICdpZCcgfCAnY3JlYXRlZF9hdCcgfCAndXBkYXRlZF9hdCc+KTogUHJvbWlzZTxUYXNrPiB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnREYXRhYmFzZSA9PT0gJ3NxbGl0ZScgPyBcbiAgICAgIGF3YWl0IHRoaXMuc3FsaXRlQWRhcHRlci5jcmVhdGVUYXNrKHRhc2tEYXRhKSA6IFxuICAgICAgYXdhaXQgdGhpcy5wb3N0Z3Jlc3FsQWRhcHRlci5jcmVhdGVUYXNrKHtcbiAgICAgICAgdGl0bGU6IHRhc2tEYXRhLnRpdGxlLFxuICAgICAgICBkZXNjcmlwdGlvbjogdGFza0RhdGEuZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIGNvbHVtbl9pZDogdGFza0RhdGEuY29sdW1uX2lkLFxuICAgICAgICBhc3NpZ25lZV9pZDogdGFza0RhdGEuYXNzaWduZWVfaWQsXG4gICAgICAgIHByaW9yaXR5OiB0YXNrRGF0YS5wcmlvcml0eSB8fCAnbWVkaXVtJyxcbiAgICAgICAgcG9zaXRpb246IHRhc2tEYXRhLnBvc2l0aW9uIHx8IDAsXG4gICAgICAgIHN0YXR1czogdGFza0RhdGEuc3RhdHVzIHx8ICd0b2RvJyxcbiAgICAgICAgcHJvamVjdF9pZDogdGFza0RhdGEucHJvamVjdF9pZCxcbiAgICAgICAgYm9hcmRfaWQ6IHRhc2tEYXRhLmJvYXJkX2lkLFxuICAgICAgICByZXBvcnRlcl9pZDogdGFza0RhdGEuY3JlYXRvcl9pZFxuICAgICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog0J/QvtC70YPRh9C10L3QuNC1INC30LDQtNCw0Ycg0LrQvtC70L7QvdC60LhcbiAgICovXG4gIHB1YmxpYyBhc3luYyBnZXRDb2x1bW5UYXNrcyhjb2x1bW5JZDogc3RyaW5nKTogUHJvbWlzZTxUYXNrW10+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudERhdGFiYXNlID09PSAnc3FsaXRlJyA/IFxuICAgICAgYXdhaXQgdGhpcy5zcWxpdGVBZGFwdGVyLmdldENvbHVtblRhc2tzKGNvbHVtbklkKSA6IFxuICAgICAgYXdhaXQgdGhpcy5wb3N0Z3Jlc3FsQWRhcHRlci5nZXRDb2x1bW5UYXNrcyhjb2x1bW5JZCk7XG4gIH1cblxuICAvKipcbiAgICog0KPQtNCw0LvQtdC90LjQtSDQt9Cw0LTQsNGH0LhcbiAgICovXG4gIHB1YmxpYyBhc3luYyBkZWxldGVUYXNrKGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudERhdGFiYXNlID09PSAnc3FsaXRlJyA/IFxuICAgICAgYXdhaXQgdGhpcy5zcWxpdGVBZGFwdGVyLmRlbGV0ZVRhc2soaWQpIDogXG4gICAgICBhd2FpdCB0aGlzLnBvc3RncmVzcWxBZGFwdGVyLmRlbGV0ZVRhc2soaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqINCS0YvQv9C+0LvQvdC10L3QuNC1INGB0YvRgNC+0LPQviBTUUwg0LfQsNC/0YDQvtGB0LAgKNC00LvRjyDRgdC+0LLQvNC10YHRgtC40LzQvtGB0YLQuCDRgSDRgNC10L/QvtC30LjRgtC+0YDQuNGP0LzQuClcbiAgICovXG4gIHB1YmxpYyBhc3luYyBxdWVyeShzcWw6IHN0cmluZywgcGFyYW1zPzogdW5rbm93bltdKTogUHJvbWlzZTx1bmtub3duW10+IHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgaWYgKHRoaXMuY3VycmVudERhdGFiYXNlID09PSAnc3FsaXRlJykge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5zcWxpdGVBZGFwdGVyLnF1ZXJ5KHNxbCwgcGFyYW1zKTtcbiAgICAgIHJldHVybiByZXN1bHQucm93cztcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wb3N0Z3Jlc3FsQWRhcHRlci5xdWVyeShzcWwsIHBhcmFtcyk7XG4gICAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gICAgfVxuICB9XG59XG5cbi8vINCt0LrRgdC/0L7RgNGCINC10LTQuNC90YHRgtCy0LXQvdC90L7Qs9C+INGN0LrQt9C10LzQv9C70Y/RgNCwXG5leHBvcnQgY29uc3QgZGJBZGFwdGVyID0gRGF0YWJhc2VBZGFwdGVyLmdldEluc3RhbmNlKCk7XG4iXSwibmFtZXMiOlsiUG9zdGdyZVNRTEFkYXB0ZXIiLCJEYXRhYmFzZUFkYXB0ZXIiLCJjdXJyZW50RGF0YWJhc2UiLCJpc0luaXRpYWxpemVkIiwic3FsaXRlQWRhcHRlciIsImluaXRpYWxpemF0aW9uUHJvbWlzZSIsInBvc3RncmVzcWxBZGFwdGVyIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsImluaXRpYWxpemUiLCJwZXJmb3JtSW5pdGlhbGl6YXRpb24iLCJkYXRhYmFzZVByaW9yaXR5IiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1BSSU9SSVRZIiwiY29uc29sZSIsImxvZyIsIlNRTGl0ZUFkYXB0ZXIiLCJzcWxpdGVFcnJvciIsIndhcm4iLCJwb3N0Z3Jlc0Vycm9yIiwiZXJyb3IiLCJlbnN1cmVJbml0aWFsaXplZCIsImdldEN1cnJlbnRBZGFwdGVyIiwiRXJyb3IiLCJnZXREYXRhYmFzZVN0YXR1cyIsInBvc3RncmVzcWwiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJjYXRjaCIsInNxbGl0ZSIsImN1cnJlbnQiLCJnZXRDdXJyZW50RGF0YWJhc2UiLCJjcmVhdGVVc2VyIiwidXNlckRhdGEiLCJhZGFwdGVyIiwiZ2V0VXNlckJ5SWQiLCJpZCIsImdldFVzZXJCeUVtYWlsIiwiZW1haWwiLCJnZXRBbGxVc2VycyIsImdldFVzZXJzIiwidXBkYXRlVXNlciIsInVwZGF0ZXMiLCJkZWxldGVVc2VyIiwiY3JlYXRlU2Vzc2lvbiIsInNlc3Npb25EYXRhIiwiZ2V0U2Vzc2lvbkJ5VG9rZW4iLCJ0b2tlbiIsImRlbGV0ZVNlc3Npb24iLCJkZWxldGVFeHBpcmVkU2Vzc2lvbnMiLCJjcmVhdGVQcm9qZWN0IiwicHJvamVjdERhdGEiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJjcmVhdGVkX2J5IiwiY29sb3IiLCJpY29uX3VybCIsImdldFByb2plY3RCeUlkIiwiZ2V0QWxsUHJvamVjdHMiLCJnZXRVc2VyUHJvamVjdHMiLCJ1c2VySWQiLCJnZXRQcm9qZWN0c0J5Q3JlYXRvcklkIiwiY3JlYXRvcklkIiwiaGFzUHJvamVjdEFjY2VzcyIsInByb2plY3RJZCIsInRvU3RyaW5nIiwidXBkYXRlUHJvamVjdCIsImRlbGV0ZVByb2plY3QiLCJjcmVhdGVCb2FyZCIsImJvYXJkRGF0YSIsImdldEJvYXJkQnlJZCIsImdldFByb2plY3RCb2FyZHMiLCJnZXRCb2FyZHNCeVByb2plY3RJZCIsImRlbGV0ZUJvYXJkIiwiZ2V0Qm9hcmRDb2x1bW5zIiwiYm9hcmRJZCIsImNyZWF0ZUNvbHVtbiIsImNvbHVtbkRhdGEiLCJ0aXRsZSIsImJvYXJkX2lkIiwicG9zaXRpb24iLCJkZWxldGVDb2x1bW4iLCJjcmVhdGVUYXNrIiwidGFza0RhdGEiLCJjb2x1bW5faWQiLCJhc3NpZ25lZV9pZCIsInByaW9yaXR5Iiwic3RhdHVzIiwicHJvamVjdF9pZCIsInJlcG9ydGVyX2lkIiwiY3JlYXRvcl9pZCIsImdldENvbHVtblRhc2tzIiwiY29sdW1uSWQiLCJkZWxldGVUYXNrIiwicXVlcnkiLCJzcWwiLCJwYXJhbXMiLCJyZXN1bHQiLCJyb3dzIiwiZGJBZGFwdGVyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/database-adapter.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/postgresql-adapter.ts":
/*!***************************************!*\
  !*** ./src/lib/postgresql-adapter.ts ***!
  \***************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PostgreSQLAdapter: () => (/* binding */ PostgreSQLAdapter),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getPostgreSQLAdapter: () => (/* binding */ getPostgreSQLAdapter)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([pg__WEBPACK_IMPORTED_MODULE_0__]);\npg__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n// Класс для работы с PostgreSQL\nclass PostgreSQLAdapter {\n    static{\n        this.instance = null;\n    }\n    constructor(config){\n        this.isInitialized = false;\n        this.config = config;\n        // Специальная настройка SSL для Supabase\n        let sslConfig = false;\n        if (config.ssl) {\n            // Если хост содержит supabase.co, используем специальные настройки SSL\n            if (config.host.includes('supabase.co')) {\n                sslConfig = {\n                    rejectUnauthorized: false,\n                    ca: undefined\n                };\n            } else {\n                sslConfig = {\n                    rejectUnauthorized: false\n                };\n            }\n        }\n        this.pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n            host: config.host,\n            port: config.port,\n            database: config.database,\n            user: config.user,\n            password: config.password,\n            ssl: sslConfig,\n            max: 20,\n            idleTimeoutMillis: 30000,\n            connectionTimeoutMillis: 2000\n        });\n    }\n    // Инициализация базы данных\n    async initialize() {\n        if (this.isInitialized) return;\n        try {\n            console.log('Initializing PostgreSQL adapter with config:', {\n                host: this.config.host,\n                port: this.config.port,\n                database: this.config.database,\n                user: this.config.user,\n                ssl: this.config.ssl\n            });\n            const client = await this.pool.connect();\n            // Проверяем подключение\n            await client.query('SELECT NOW()');\n            console.log('✅ PostgreSQL подключение установлено');\n            client.release();\n            this.isInitialized = true;\n        } catch (error) {\n            console.error('❌ Ошибка подключения к PostgreSQL:', error);\n            throw error;\n        }\n    }\n    // Закрытие пула соединений\n    async close() {\n        await this.pool.end();\n        this.isInitialized = false;\n    }\n    // Получение клиента для транзакций\n    async getClient() {\n        return await this.pool.connect();\n    }\n    // Конвертация SQL из SQLite формата (?) в PostgreSQL формат ($1, $2, ...)\n    convertSqlToPostgreSQL(sql) {\n        let paramIndex = 1;\n        return sql.replace(/\\?/g, ()=>`$${paramIndex++}`);\n    }\n    // Выполнение запроса\n    async query(text, params) {\n        const client = await this.pool.connect();\n        try {\n            // Конвертируем SQL из SQLite формата в PostgreSQL формат\n            const convertedSql = this.convertSqlToPostgreSQL(text);\n            console.log('Original SQL Query:', text);\n            console.log('Converted SQL Query:', convertedSql);\n            console.log('SQL Params:', params);\n            const result = await client.query(convertedSql, params);\n            return result;\n        } finally{\n            client.release();\n        }\n    }\n    // === МЕТОДЫ ДЛЯ ПОЛЬЗОВАТЕЛЕЙ ===\n    async createUser(userData) {\n        const { email, name, role = 'user', password_hash, isApproved = false, avatar } = userData;\n        // Если password_hash не предоставлен, но есть пароль в виде строки, хешируем его\n        const userDataWithPassword = userData;\n        const hashedPassword = password_hash || (userDataWithPassword.password ? await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(userDataWithPassword.password, 12) : await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash('defaultpassword', 12));\n        // Преобразуем isApproved в approval_status\n        const approvalStatus = isApproved ? 'approved' : 'pending';\n        const result = await this.query(`INSERT INTO users (email, password_hash, name, role, approval_status, avatar_url) \n       VALUES ($1, $2, $3, $4, $5, $6) \n       RETURNING *`, [\n            email,\n            hashedPassword,\n            name,\n            role,\n            approvalStatus,\n            avatar\n        ]);\n        const row = result.rows[0];\n        return {\n            id: row.id,\n            name: row.name,\n            email: row.email,\n            avatar: row.avatar_url,\n            role: row.role,\n            isApproved: row.approval_status === 'approved',\n            created_at: row.created_at,\n            updated_at: row.updated_at,\n            password_hash: row.password_hash\n        };\n    }\n    async getUserByEmail(email) {\n        const result = await this.query('SELECT * FROM users WHERE email = $1', [\n            email\n        ]);\n        const row = result.rows[0];\n        if (!row) return null;\n        // Маппинг полей базы данных в User интерфейс\n        return {\n            id: row.id,\n            name: row.name,\n            email: row.email,\n            avatar: row.avatar_url,\n            role: row.role || 'user',\n            isApproved: row.approval_status === 'approved',\n            created_at: row.created_at,\n            updated_at: row.updated_at,\n            password_hash: row.password_hash\n        };\n    }\n    async getUserById(id) {\n        const result = await this.query('SELECT * FROM users WHERE id = $1', [\n            id\n        ]);\n        const row = result.rows[0];\n        if (!row) return null;\n        console.log('User data:', row);\n        console.log('User isApproved:', row.approval_status === 'approved', 'type:', typeof (row.approval_status === 'approved'));\n        console.log('User role:', row.role);\n        console.log('Final isApproved:', row.approval_status === 'approved');\n        // Маппинг полей базы данных в User интерфейс\n        return {\n            id: row.id,\n            name: row.name,\n            email: row.email,\n            avatar: row.avatar_url,\n            role: row.role || 'user',\n            isApproved: row.approval_status === 'approved',\n            created_at: row.created_at,\n            updated_at: row.updated_at,\n            password_hash: row.password_hash\n        };\n    }\n    async updateUser(id, updates) {\n        const fields = Object.keys(updates).filter((key)=>key !== 'id' && key !== 'created_at' && key !== 'updated_at');\n        if (fields.length === 0) {\n            return await this.getUserById(id);\n        }\n        // Маппинг полей интерфейса User в поля базы данных\n        const dbFields = fields.map((field)=>{\n            if (field === 'avatar') return 'avatar_url';\n            if (field === 'isApproved') return 'approval_status';\n            return field;\n        });\n        // Преобразуем значения для базы данных\n        const dbValues = fields.map((field)=>{\n            if (field === 'isApproved') {\n                return updates[field] ? 'approved' : 'pending';\n            }\n            return updates[field];\n        });\n        const setClause = dbFields.map((field, index)=>`${field} = $${index + 2}`).join(', ');\n        const result = await this.query(`UPDATE users SET ${setClause}, updated_at = CURRENT_TIMESTAMP WHERE id = $1 RETURNING *`, [\n            id,\n            ...dbValues\n        ]);\n        const row = result.rows[0];\n        if (!row) return null;\n        return {\n            id: row.id,\n            name: row.name,\n            email: row.email,\n            avatar: row.avatar_url,\n            role: row.role,\n            isApproved: row.is_approved,\n            created_at: row.created_at,\n            updated_at: row.updated_at,\n            password_hash: row.password_hash\n        };\n    }\n    async getAllUsers() {\n        const result = await this.query('SELECT * FROM users ORDER BY created_at DESC');\n        return result.rows.map((row)=>({\n                id: row.id,\n                name: row.name,\n                email: row.email,\n                avatar: row.avatar_url,\n                role: row.role || 'user',\n                isApproved: row.approval_status === 'approved',\n                created_at: row.created_at,\n                updated_at: row.updated_at,\n                password_hash: row.password_hash\n            }));\n    }\n    async deleteUser(id) {\n        const result = await this.query('DELETE FROM users WHERE id = $1', [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    // === МЕТОДЫ ДЛЯ ПРОЕКТОВ ===\n    async createProject(projectData) {\n        console.log('🔍 PostgreSQL createProject called with:', projectData);\n        try {\n            // Конвертируем строковый ID в integer для PostgreSQL\n            const ownerIdInt = parseInt(projectData.created_by, 10);\n            if (isNaN(ownerIdInt)) {\n                throw new Error(`Invalid user ID: ${projectData.created_by}`);\n            }\n            const result = await this.query(`INSERT INTO projects (name, description, owner_id, color, icon, is_active, created_at, updated_at)\n       VALUES ($1, $2, $3, $4, $5, $6, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) RETURNING *`, [\n                projectData.name,\n                projectData.description,\n                ownerIdInt,\n                projectData.color || '#3B82F6',\n                projectData.icon_url || null,\n                true\n            ]);\n            const project = result.rows[0];\n            // Добавляем владельца проекта в project_members с ролью 'owner'\n            await this.query(`INSERT INTO project_members (project_id, user_id, role, joined_at)\n         VALUES ($1, $2, $3, CURRENT_TIMESTAMP)`, [\n                project.id,\n                ownerIdInt,\n                'owner'\n            ]);\n            // Преобразуем owner_id обратно в created_by для совместимости с API\n            const apiProject = {\n                ...project,\n                created_by: project.owner_id.toString(),\n                icon_url: project.icon\n            };\n            console.log('✅ PostgreSQL project created successfully with owner membership:', apiProject);\n            return apiProject;\n        } catch (error) {\n            console.error('❌ PostgreSQL createProject error:', error);\n            throw error;\n        }\n    }\n    async getProjectById(id) {\n        const result = await this.query('SELECT * FROM projects WHERE id = $1', [\n            id\n        ]);\n        const project = result.rows[0];\n        if (!project) return null;\n        return {\n            ...project,\n            created_by: project.owner_id.toString(),\n            icon_url: project.icon\n        };\n    }\n    async getProjectsByUserId(userId) {\n        // Конвертируем userId в integer для PostgreSQL\n        const userIdInt = parseInt(userId, 10);\n        if (isNaN(userIdInt)) {\n            console.error('Invalid userId for getProjectsByUserId:', userId);\n            return [];\n        }\n        const result = await this.query(`SELECT DISTINCT p.* FROM projects p \n       LEFT JOIN project_members pm ON p.id = pm.project_id \n       WHERE (p.owner_id = $1 OR pm.user_id = $1) \n       ORDER BY p.created_at DESC`, [\n            userIdInt\n        ]);\n        return result.rows.map((project)=>({\n                ...project,\n                created_by: project.owner_id.toString(),\n                icon_url: project.icon\n            }));\n    }\n    async getUserProjects(userId) {\n        return this.getProjectsByUserId(userId);\n    }\n    async getAllProjects() {\n        const result = await this.query('SELECT * FROM projects ORDER BY created_at DESC');\n        return result.rows.map((project)=>({\n                ...project,\n                created_by: project.owner_id.toString(),\n                icon_url: project.icon\n            }));\n    }\n    async updateProject(id, updates) {\n        const fields = Object.keys(updates).filter((key)=>key !== 'id');\n        const values = fields.map((field)=>updates[field]);\n        const setClause = fields.map((field, index)=>`${field} = $${index + 2}`).join(', ');\n        if (fields.length === 0) {\n            return await this.getProjectById(id);\n        }\n        const result = await this.query(`UPDATE projects SET ${setClause} WHERE id = $1 RETURNING *`, [\n            id,\n            ...values\n        ]);\n        const project = result.rows[0];\n        if (!project) return null;\n        return {\n            ...project,\n            created_by: project.owner_id.toString(),\n            icon_url: project.icon\n        };\n    }\n    async deleteProject(id) {\n        const result = await this.query('DELETE FROM projects WHERE id = $1', [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    async hasProjectAccess(userId, projectId) {\n        try {\n            // Конвертируем userId в integer для сравнения с PostgreSQL\n            const userIdInt = parseInt(userId, 10);\n            if (isNaN(userIdInt)) {\n                console.error('Invalid userId for access check:', userId);\n                return false;\n            }\n            // Проверяем, является ли пользователь владельцем проекта\n            const ownerResult = await this.query('SELECT owner_id FROM projects WHERE id = $1', [\n                projectId\n            ]);\n            if (ownerResult.rows.length === 0) {\n                return false; // Проект не найден\n            }\n            const projectOwner = ownerResult.rows[0].owner_id;\n            if (projectOwner === userIdInt) {\n                return true; // Пользователь является владельцем\n            }\n            // Проверяем членство в проекте\n            const memberResult = await this.query('SELECT 1 FROM project_members WHERE project_id = $1 AND user_id = $2', [\n                projectId,\n                userIdInt\n            ]);\n            return memberResult.rows.length > 0;\n        } catch (error) {\n            console.error('Error checking project access:', error);\n            return false;\n        }\n    }\n    // === МЕТОДЫ ДЛЯ ДОСОК ===\n    async createBoard(boardData) {\n        const result = await this.query(`INSERT INTO boards (name, description, project_id, created_by, created_at, updated_at) \n       VALUES ($1, $2, $3, $4, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP) \n       RETURNING *`, [\n            boardData.name,\n            boardData.description || '',\n            boardData.project_id,\n            parseInt(boardData.created_by, 10)\n        ]);\n        return result.rows[0];\n    }\n    async getBoardById(id) {\n        const result = await this.query('SELECT * FROM boards WHERE id = $1', [\n            id\n        ]);\n        return result.rows[0] || null;\n    }\n    async getBoardsByProjectId(projectId) {\n        const result = await this.query(`SELECT b.* FROM boards b \n       JOIN projects p ON b.project_id = p.id \n       WHERE b.project_id = $1 \n       ORDER BY b.position ASC, b.created_at DESC`, [\n            projectId\n        ]);\n        return result.rows;\n    }\n    async updateBoard(id, updates) {\n        const fields = Object.keys(updates).filter((key)=>key !== 'id');\n        const values = fields.map((field)=>updates[field]);\n        const setClause = fields.map((field, index)=>`${field} = $${index + 2}`).join(', ');\n        if (fields.length === 0) {\n            return await this.getBoardById(id);\n        }\n        const result = await this.query(`UPDATE boards SET ${setClause} WHERE id = $1 RETURNING *`, [\n            id,\n            ...values\n        ]);\n        return result.rows[0] || null;\n    }\n    async deleteBoard(id) {\n        const result = await this.query('DELETE FROM boards WHERE id = $1', [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    // === МЕТОДЫ ДЛЯ КОЛОНОК ===\n    async createColumn(title, boardId, position, color, createdBy) {\n        const result = await this.query(`INSERT INTO columns (title, board_id, position, color, settings, created_by) \n       VALUES ($1, $2, $3, $4, $5, $6) \n       RETURNING *`, [\n            title,\n            boardId,\n            position || 0,\n            color || '#6B7280',\n            '{}',\n            createdBy || null\n        ]);\n        return result.rows[0];\n    }\n    async getColumnById(id) {\n        const result = await this.query('SELECT * FROM columns WHERE id = $1', [\n            id\n        ]);\n        return result.rows[0] || null;\n    }\n    async getColumnsByBoardId(boardId) {\n        const result = await this.query('SELECT * FROM columns WHERE board_id = $1 ORDER BY position ASC, created_at DESC', [\n            boardId\n        ]);\n        return result.rows;\n    }\n    async updateColumn(id, updates) {\n        const fields = Object.keys(updates).filter((key)=>key !== 'id');\n        const values = fields.map((field)=>updates[field]);\n        const setClause = fields.map((field, index)=>`${field} = $${index + 2}`).join(', ');\n        if (fields.length === 0) {\n            return await this.getColumnById(id);\n        }\n        const result = await this.query(`UPDATE columns SET ${setClause} WHERE id = $1 RETURNING *`, [\n            id,\n            ...values\n        ]);\n        return result.rows[0] || null;\n    }\n    async deleteColumn(id) {\n        const result = await this.query('DELETE FROM columns WHERE id = $1', [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    // === МЕТОДЫ ДЛЯ ЗАДАЧ ===\n    async createTask(taskData) {\n        const { title, description, status = 'todo', priority = 'medium', project_id, board_id, column_id, assignee_id, reporter_id, position = 0 } = taskData;\n        // Создаем задачу без assignee_id (используется отдельная таблица task_assignees)\n        const result = await this.query(`INSERT INTO tasks (title, description, status, priority, project_id, board_id, column_id, reporter_id, position) \n       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) \n       RETURNING *`, [\n            title,\n            description,\n            status,\n            priority,\n            project_id,\n            board_id,\n            column_id,\n            reporter_id,\n            position\n        ]);\n        const task = result.rows[0];\n        // Если указан assignee_id, создаем запись в таблице task_assignees\n        if (assignee_id) {\n            await this.query(`INSERT INTO task_assignees (task_id, user_id, assigned_by) \n         VALUES ($1, $2, $3)`, [\n                task.id,\n                assignee_id,\n                reporter_id\n            ]);\n        }\n        return task;\n    }\n    async getTaskById(id) {\n        const result = await this.query('SELECT * FROM tasks WHERE id = $1', [\n            id\n        ]);\n        return result.rows[0] || null;\n    }\n    async getTasksByProjectId(projectId) {\n        const result = await this.query('SELECT * FROM tasks WHERE project_id = $1 ORDER BY position ASC, created_at DESC', [\n            projectId\n        ]);\n        return result.rows;\n    }\n    async getTasksByColumnId(columnId) {\n        const result = await this.query('SELECT * FROM tasks WHERE column_id = $1 ORDER BY position ASC, created_at DESC', [\n            columnId\n        ]);\n        return result.rows;\n    }\n    async updateTask(id, updates) {\n        const fields = Object.keys(updates).filter((key)=>key !== 'id');\n        const values = fields.map((field)=>updates[field]);\n        const setClause = fields.map((field, index)=>`${field} = $${index + 2}`).join(', ');\n        if (fields.length === 0) {\n            return await this.getTaskById(id);\n        }\n        const result = await this.query(`UPDATE tasks SET ${setClause} WHERE id = $1 RETURNING *`, [\n            id,\n            ...values\n        ]);\n        return result.rows[0] || null;\n    }\n    async deleteTask(id) {\n        const result = await this.query('DELETE FROM tasks WHERE id = $1', [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    async getTaskAssignees(taskId) {\n        const result = await this.query(`SELECT u.id, u.username, u.email, ta.assigned_at \n       FROM task_assignees ta \n       JOIN users u ON ta.user_id = u.id \n       WHERE ta.task_id = $1`, [\n            taskId\n        ]);\n        return result.rows;\n    }\n    async assignTaskToUser(taskId, userId, assignedBy) {\n        try {\n            await this.query(`INSERT INTO task_assignees (task_id, user_id, assigned_by) \n         VALUES ($1, $2, $3) \n         ON CONFLICT (task_id, user_id) DO NOTHING`, [\n                taskId,\n                userId,\n                assignedBy\n            ]);\n            return true;\n        } catch (error) {\n            console.error('Error assigning task to user:', error);\n            return false;\n        }\n    }\n    async unassignTaskFromUser(taskId, userId) {\n        const result = await this.query('DELETE FROM task_assignees WHERE task_id = $1 AND user_id = $2', [\n            taskId,\n            userId\n        ]);\n        return result.rowCount > 0;\n    }\n    // === ДОПОЛНИТЕЛЬНЫЕ МЕТОДЫ ДЛЯ СОВМЕСТИМОСТИ ===\n    async getBoardColumns(boardId) {\n        return await this.getColumnsByBoardId(boardId);\n    }\n    async getColumnTasks(columnId) {\n        return await this.getTasksByColumnId(columnId);\n    }\n    // === МЕТОДЫ ДЛЯ СЕССИЙ ===\n    async createSession(sessionData) {\n        const result = await this.query('INSERT INTO sessions (session_token, user_id, expires_at) VALUES ($1, $2, $3) RETURNING *', [\n            sessionData.token,\n            sessionData.user_id,\n            sessionData.expires_at\n        ]);\n        const row = result.rows[0];\n        return {\n            id: row.id,\n            user_id: row.user_id,\n            token: row.session_token,\n            expires_at: row.expires_at,\n            created_at: row.created_at\n        };\n    }\n    async getSessionByToken(sessionToken) {\n        const result = await this.query('SELECT * FROM sessions WHERE session_token = $1 AND expires_at > NOW()', [\n            sessionToken\n        ]);\n        if (!result.rows[0]) return null;\n        const row = result.rows[0];\n        return {\n            id: row.id,\n            user_id: row.user_id,\n            token: row.session_token,\n            expires_at: row.expires_at,\n            created_at: row.created_at\n        };\n    }\n    async deleteSession(sessionToken) {\n        const result = await this.query('DELETE FROM sessions WHERE session_token = $1', [\n            sessionToken\n        ]);\n        return result.rowCount > 0;\n    }\n    async deleteUserSessions(userId) {\n        const result = await this.query('DELETE FROM sessions WHERE user_id = $1', [\n            userId\n        ]);\n        return result.rowCount;\n    }\n    async deleteExpiredSessions() {\n        const result = await this.query('DELETE FROM sessions WHERE expires_at <= NOW()');\n        return result.rowCount;\n    }\n    // === МЕТОДЫ ДЛЯ КОММЕНТАРИЕВ ===\n    async createComment(content, taskId, authorId) {\n        const result = await this.query(`INSERT INTO comments (content, task_id, author_id) \n       VALUES ($1, $2, $3) \n       RETURNING *`, [\n            content,\n            taskId,\n            authorId\n        ]);\n        return result.rows[0];\n    }\n    async getCommentsByTaskId(taskId) {\n        const result = await this.query('SELECT * FROM comments WHERE task_id = $1 AND deleted_at IS NULL ORDER BY created_at', [\n            taskId\n        ]);\n        return result.rows;\n    }\n    async updateComment(id, content) {\n        const result = await this.query('UPDATE comments SET content = $2 WHERE id = $1 RETURNING *', [\n            id,\n            content\n        ]);\n        return result.rows[0] || null;\n    }\n    async deleteComment(id) {\n        const result = await this.query('UPDATE comments SET deleted_at = CURRENT_TIMESTAMP WHERE id = $1', [\n            id\n        ]);\n        return result.rowCount > 0;\n    }\n    // === МЕТОДЫ ДЛЯ ТЕГОВ ===\n    async createTag(name, color, projectId) {\n        const result = await this.query(`INSERT INTO tags (name, color, project_id) \n       VALUES ($1, $2, $3) \n       RETURNING *`, [\n            name,\n            color,\n            projectId\n        ]);\n        return result.rows[0];\n    }\n    async getTagsByProjectId(projectId) {\n        const result = await this.query('SELECT * FROM tags WHERE project_id = $1 ORDER BY name', [\n            projectId\n        ]);\n        return result.rows;\n    }\n    async addTagToTask(taskId, tagId) {\n        try {\n            await this.query('INSERT INTO task_tags (task_id, tag_id) VALUES ($1, $2)', [\n                taskId,\n                tagId\n            ]);\n            return true;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        } catch (error) {\n            return false;\n        }\n    }\n    async removeTagFromTask(taskId, tagId) {\n        const result = await this.query('DELETE FROM task_tags WHERE task_id = $1 AND tag_id = $2', [\n            taskId,\n            tagId\n        ]);\n        return result.rowCount > 0;\n    }\n    async getTagsByTaskId(taskId) {\n        const result = await this.query(`SELECT t.* FROM tags t \n       JOIN task_tags tt ON t.id = tt.tag_id \n       WHERE tt.task_id = $1`, [\n            taskId\n        ]);\n        return result.rows;\n    }\n    // Статический метод для получения экземпляра (Singleton)\n    static getInstance() {\n        if (!PostgreSQLAdapter.instance) {\n            const config = {\n                host: process.env.DB_HOST || 'localhost',\n                port: parseInt(process.env.DB_PORT || '5432'),\n                database: process.env.DB_NAME || 'encore_tasks',\n                user: process.env.DB_USER || 'postgres',\n                password: process.env.DB_PASSWORD || 'password',\n                ssl: false // Отключаем SSL для локального PostgreSQL\n            };\n            PostgreSQLAdapter.instance = new PostgreSQLAdapter(config);\n        }\n        return PostgreSQLAdapter.instance;\n    }\n}\n// Экспорт экземпляра адаптера\nlet dbAdapter = null;\nfunction getPostgreSQLAdapter() {\n    if (!dbAdapter) {\n        const config = {\n            host: process.env.DB_HOST || 'localhost',\n            port: parseInt(process.env.DB_PORT || '5432'),\n            database: process.env.DB_NAME || 'encore_tasks',\n            user: process.env.DB_USER || 'postgres',\n            password: process.env.DB_PASSWORD || 'password',\n            ssl: process.env.DB_SSL === 'true'\n        };\n        dbAdapter = new PostgreSQLAdapter(config);\n    }\n    return dbAdapter;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (getPostgreSQLAdapter);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxPQUFPLElBQUk7Z0JBQ2pDL0osTUFBTTJKLFFBQVFDLEdBQUcsQ0FBQ0ksT0FBTyxJQUFJO2dCQUM3Qi9KLFVBQVUwSixRQUFRQyxHQUFHLENBQUNLLFdBQVcsSUFBSTtnQkFDckMxSyxLQUFLLE1BQU0sMENBQTBDO1lBQ3ZEO1lBRUFOLGtCQUFrQkMsUUFBUSxHQUFHLElBQUlELGtCQUFrQkc7UUFDckQ7UUFFQSxPQUFPSCxrQkFBa0JDLFFBQVE7SUFDbkM7QUFDRjtBQUVBLDhCQUE4QjtBQUM5QixJQUFJZ0wsWUFBc0M7QUFFbkMsU0FBU0M7SUFDZCxJQUFJLENBQUNELFdBQVc7UUFDZCxNQUFNOUssU0FBeUI7WUFDN0JJLE1BQU1tSyxRQUFRQyxHQUFHLENBQUNDLE9BQU8sSUFBSTtZQUM3Qi9KLE1BQU1xRSxTQUFTd0YsUUFBUUMsR0FBRyxDQUFDRSxPQUFPLElBQUk7WUFDdEMvSixVQUFVNEosUUFBUUMsR0FBRyxDQUFDRyxPQUFPLElBQUk7WUFDakMvSixNQUFNMkosUUFBUUMsR0FBRyxDQUFDSSxPQUFPLElBQUk7WUFDN0IvSixVQUFVMEosUUFBUUMsR0FBRyxDQUFDSyxXQUFXLElBQUk7WUFDckMxSyxLQUFLb0ssUUFBUUMsR0FBRyxDQUFDUSxNQUFNLEtBQUs7UUFDOUI7UUFFQUYsWUFBWSxJQUFJakwsa0JBQWtCRztJQUNwQztJQUVBLE9BQU84SztBQUNUO0FBRUEsaUVBQWVDLG9CQUFvQkEsRUFBQyIsInNvdXJjZXMiOlsiRTpcXFByb2plY3RzXFxlbmNvcmUtdGFza3NcXGVuY29yZS10YXNrcy1tYWluXFxzcmNcXGxpYlxccG9zdGdyZXNxbC1hZGFwdGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBvb2wsIFBvb2xDbGllbnQgfSBmcm9tICdwZyc7XG5pbXBvcnQgYmNyeXB0IGZyb20gJ2JjcnlwdGpzJztcbmltcG9ydCB7IFVzZXIsIFByb2plY3QsIEJvYXJkLCBDb2x1bW4sIFRhc2ssIENvbW1lbnQsIFNlc3Npb24gfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBUYWcgfSBmcm9tICcuLi90eXBlcy9jb3JlLnR5cGVzJztcblxuLy8g0JjQvdGC0LXRgNGE0LXQudGBINC00LvRjyDQutC+0L3RhNC40LPRg9GA0LDRhtC40Lgg0LHQsNC30Ysg0LTQsNC90L3Ri9GFXG5pbnRlcmZhY2UgRGF0YWJhc2VDb25maWcge1xuICBob3N0OiBzdHJpbmc7XG4gIHBvcnQ6IG51bWJlcjtcbiAgZGF0YWJhc2U6IHN0cmluZztcbiAgdXNlcjogc3RyaW5nO1xuICBwYXNzd29yZDogc3RyaW5nO1xuICBzc2w/OiBib29sZWFuO1xufVxuXG4vLyDQmtC70LDRgdGBINC00LvRjyDRgNCw0LHQvtGC0Ysg0YEgUG9zdGdyZVNRTFxuZXhwb3J0IGNsYXNzIFBvc3RncmVTUUxBZGFwdGVyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFBvc3RncmVTUUxBZGFwdGVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgcG9vbDogUG9vbDtcbiAgcHJpdmF0ZSBjb25maWc6IERhdGFiYXNlQ29uZmlnO1xuICBwcml2YXRlIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IERhdGFiYXNlQ29uZmlnKSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgLy8g0KHQv9C10YbQuNCw0LvRjNC90LDRjyDQvdCw0YHRgtGA0L7QudC60LAgU1NMINC00LvRjyBTdXBhYmFzZVxuICAgIGxldCBzc2xDb25maWc6IGJvb2xlYW4gfCBvYmplY3QgPSBmYWxzZTtcbiAgICBpZiAoY29uZmlnLnNzbCkge1xuICAgICAgLy8g0JXRgdC70Lgg0YXQvtGB0YIg0YHQvtC00LXRgNC20LjRgiBzdXBhYmFzZS5jbywg0LjRgdC/0L7Qu9GM0LfRg9C10Lwg0YHQv9C10YbQuNCw0LvRjNC90YvQtSDQvdCw0YHRgtGA0L7QudC60LggU1NMXG4gICAgICBpZiAoY29uZmlnLmhvc3QuaW5jbHVkZXMoJ3N1cGFiYXNlLmNvJykpIHtcbiAgICAgICAgc3NsQ29uZmlnID0ge1xuICAgICAgICAgIHJlamVjdFVuYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICAgICAgY2E6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3NsQ29uZmlnID0geyByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5wb29sID0gbmV3IFBvb2woe1xuICAgICAgaG9zdDogY29uZmlnLmhvc3QsXG4gICAgICBwb3J0OiBjb25maWcucG9ydCxcbiAgICAgIGRhdGFiYXNlOiBjb25maWcuZGF0YWJhc2UsXG4gICAgICB1c2VyOiBjb25maWcudXNlcixcbiAgICAgIHBhc3N3b3JkOiBjb25maWcucGFzc3dvcmQsXG4gICAgICBzc2w6IHNzbENvbmZpZyxcbiAgICAgIG1heDogMjAsIC8vINC80LDQutGB0LjQvNCw0LvRjNC90L7QtSDQutC+0LvQuNGH0LXRgdGC0LLQviDRgdC+0LXQtNC40L3QtdC90LjQuSDQsiDQv9GD0LvQtVxuICAgICAgaWRsZVRpbWVvdXRNaWxsaXM6IDMwMDAwLFxuICAgICAgY29ubmVjdGlvblRpbWVvdXRNaWxsaXM6IDIwMDAsXG4gICAgfSk7XG4gIH1cblxuICAvLyDQmNC90LjRhtC40LDQu9C40LfQsNGG0LjRjyDQsdCw0LfRiyDQtNCw0L3QvdGL0YVcbiAgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkKSByZXR1cm47XG5cbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ0luaXRpYWxpemluZyBQb3N0Z3JlU1FMIGFkYXB0ZXIgd2l0aCBjb25maWc6Jywge1xuICAgICAgICBob3N0OiB0aGlzLmNvbmZpZy5ob3N0LFxuICAgICAgICBwb3J0OiB0aGlzLmNvbmZpZy5wb3J0LFxuICAgICAgICBkYXRhYmFzZTogdGhpcy5jb25maWcuZGF0YWJhc2UsXG4gICAgICAgIHVzZXI6IHRoaXMuY29uZmlnLnVzZXIsXG4gICAgICAgIHNzbDogdGhpcy5jb25maWcuc3NsXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IHRoaXMucG9vbC5jb25uZWN0KCk7XG4gICAgICBcbiAgICAgIC8vINCf0YDQvtCy0LXRgNGP0LXQvCDQv9C+0LTQutC70Y7Rh9C10L3QuNC1XG4gICAgICBhd2FpdCBjbGllbnQucXVlcnkoJ1NFTEVDVCBOT1coKScpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygn4pyFIFBvc3RncmVTUUwg0L/QvtC00LrQu9GO0YfQtdC90LjQtSDRg9GB0YLQsNC90L7QstC70LXQvdC+Jyk7XG4gICAgICBjbGllbnQucmVsZWFzZSgpO1xuICAgICAgXG4gICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwg0J7RiNC40LHQutCwINC/0L7QtNC60LvRjtGH0LXQvdC40Y8g0LogUG9zdGdyZVNRTDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvLyDQl9Cw0LrRgNGL0YLQuNC1INC/0YPQu9CwINGB0L7QtdC00LjQvdC10L3QuNC5XG4gIGFzeW5jIGNsb3NlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMucG9vbC5lbmQoKTtcbiAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgfVxuXG4gIC8vINCf0L7Qu9GD0YfQtdC90LjQtSDQutC70LjQtdC90YLQsCDQtNC70Y8g0YLRgNCw0L3Qt9Cw0LrRhtC40LlcbiAgYXN5bmMgZ2V0Q2xpZW50KCk6IFByb21pc2U8UG9vbENsaWVudD4ge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnBvb2wuY29ubmVjdCgpO1xuICB9XG5cbiAgLy8g0JrQvtC90LLQtdGA0YLQsNGG0LjRjyBTUUwg0LjQtyBTUUxpdGUg0YTQvtGA0LzQsNGC0LAgKD8pINCyIFBvc3RncmVTUUwg0YTQvtGA0LzQsNGCICgkMSwgJDIsIC4uLilcbiAgcHJpdmF0ZSBjb252ZXJ0U3FsVG9Qb3N0Z3JlU1FMKHNxbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBsZXQgcGFyYW1JbmRleCA9IDE7XG4gICAgcmV0dXJuIHNxbC5yZXBsYWNlKC9cXD8vZywgKCkgPT4gYCQke3BhcmFtSW5kZXgrK31gKTtcbiAgfVxuXG4gIC8vINCS0YvQv9C+0LvQvdC10L3QuNC1INC30LDQv9GA0L7RgdCwXG4gIGFzeW5jIHF1ZXJ5KHRleHQ6IHN0cmluZywgcGFyYW1zPzogdW5rbm93bltdKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBjbGllbnQgPSBhd2FpdCB0aGlzLnBvb2wuY29ubmVjdCgpO1xuICAgIHRyeSB7XG4gICAgICAvLyDQmtC+0L3QstC10YDRgtC40YDRg9C10LwgU1FMINC40LcgU1FMaXRlINGE0L7RgNC80LDRgtCwINCyIFBvc3RncmVTUUwg0YTQvtGA0LzQsNGCXG4gICAgICBjb25zdCBjb252ZXJ0ZWRTcWwgPSB0aGlzLmNvbnZlcnRTcWxUb1Bvc3RncmVTUUwodGV4dCk7XG4gICAgICBjb25zb2xlLmxvZygnT3JpZ2luYWwgU1FMIFF1ZXJ5OicsIHRleHQpO1xuICAgICAgY29uc29sZS5sb2coJ0NvbnZlcnRlZCBTUUwgUXVlcnk6JywgY29udmVydGVkU3FsKTtcbiAgICAgIGNvbnNvbGUubG9nKCdTUUwgUGFyYW1zOicsIHBhcmFtcyk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkoY29udmVydGVkU3FsLCBwYXJhbXMpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgICB9XG4gIH1cblxuICAvLyA9PT0g0JzQldCi0J7QlNCrINCU0JvQryDQn9Ce0JvQrNCX0J7QktCQ0KLQldCb0JXQmSA9PT1cblxuICBhc3luYyBjcmVhdGVVc2VyKHVzZXJEYXRhOiBPbWl0PFVzZXIsICdpZCcgfCAnY3JlYXRlZF9hdCcgfCAndXBkYXRlZF9hdCc+KTogUHJvbWlzZTxVc2VyPiB7XG4gICAgY29uc3QgeyBlbWFpbCwgbmFtZSwgcm9sZSA9ICd1c2VyJywgcGFzc3dvcmRfaGFzaCwgaXNBcHByb3ZlZCA9IGZhbHNlLCBhdmF0YXIgfSA9IHVzZXJEYXRhO1xuICAgIFxuICAgIC8vINCV0YHQu9C4IHBhc3N3b3JkX2hhc2gg0L3QtSDQv9GA0LXQtNC+0YHRgtCw0LLQu9C10L0sINC90L4g0LXRgdGC0Ywg0L/QsNGA0L7Qu9GMINCyINCy0LjQtNC1INGB0YLRgNC+0LrQuCwg0YXQtdGI0LjRgNGD0LXQvCDQtdCz0L5cbiAgICBjb25zdCB1c2VyRGF0YVdpdGhQYXNzd29yZCA9IHVzZXJEYXRhIGFzIHsgcGFzc3dvcmQ/OiBzdHJpbmcgfTtcbiAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IHBhc3N3b3JkX2hhc2ggfHwgKHVzZXJEYXRhV2l0aFBhc3N3b3JkLnBhc3N3b3JkID8gXG4gICAgICBhd2FpdCBiY3J5cHQuaGFzaCh1c2VyRGF0YVdpdGhQYXNzd29yZC5wYXNzd29yZCwgMTIpIDogXG4gICAgICBhd2FpdCBiY3J5cHQuaGFzaCgnZGVmYXVsdHBhc3N3b3JkJywgMTIpKTtcbiAgICBcbiAgICAvLyDQn9GA0LXQvtCx0YDQsNC30YPQtdC8IGlzQXBwcm92ZWQg0LIgYXBwcm92YWxfc3RhdHVzXG4gICAgY29uc3QgYXBwcm92YWxTdGF0dXMgPSBpc0FwcHJvdmVkID8gJ2FwcHJvdmVkJyA6ICdwZW5kaW5nJztcbiAgICBcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgYElOU0VSVCBJTlRPIHVzZXJzIChlbWFpbCwgcGFzc3dvcmRfaGFzaCwgbmFtZSwgcm9sZSwgYXBwcm92YWxfc3RhdHVzLCBhdmF0YXJfdXJsKSBcbiAgICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCAkNSwgJDYpIFxuICAgICAgIFJFVFVSTklORyAqYCxcbiAgICAgIFtlbWFpbCwgaGFzaGVkUGFzc3dvcmQsIG5hbWUsIHJvbGUsIGFwcHJvdmFsU3RhdHVzLCBhdmF0YXJdXG4gICAgKTtcbiAgICBcbiAgICBjb25zdCByb3cgPSByZXN1bHQucm93c1swXTtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHJvdy5pZCxcbiAgICAgIG5hbWU6IHJvdy5uYW1lLFxuICAgICAgZW1haWw6IHJvdy5lbWFpbCxcbiAgICAgIGF2YXRhcjogcm93LmF2YXRhcl91cmwsXG4gICAgICByb2xlOiByb3cucm9sZSxcbiAgICAgIGlzQXBwcm92ZWQ6IHJvdy5hcHByb3ZhbF9zdGF0dXMgPT09ICdhcHByb3ZlZCcsXG4gICAgICBjcmVhdGVkX2F0OiByb3cuY3JlYXRlZF9hdCxcbiAgICAgIHVwZGF0ZWRfYXQ6IHJvdy51cGRhdGVkX2F0LFxuICAgICAgcGFzc3dvcmRfaGFzaDogcm93LnBhc3N3b3JkX2hhc2hcbiAgICB9O1xuICB9XG5cbiAgYXN5bmMgZ2V0VXNlckJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8VXNlciB8IG51bGw+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgZW1haWwgPSAkMScsXG4gICAgICBbZW1haWxdXG4gICAgKTtcbiAgICBjb25zdCByb3cgPSByZXN1bHQucm93c1swXTtcbiAgICBpZiAoIXJvdykgcmV0dXJuIG51bGw7XG4gICAgXG4gICAgLy8g0JzQsNC/0L/QuNC90LMg0L/QvtC70LXQuSDQsdCw0LfRiyDQtNCw0L3QvdGL0YUg0LIgVXNlciDQuNC90YLQtdGA0YTQtdC50YFcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHJvdy5pZCxcbiAgICAgIG5hbWU6IHJvdy5uYW1lLFxuICAgICAgZW1haWw6IHJvdy5lbWFpbCxcbiAgICAgIGF2YXRhcjogcm93LmF2YXRhcl91cmwsXG4gICAgICByb2xlOiByb3cucm9sZSB8fCAndXNlcicsXG4gICAgICBpc0FwcHJvdmVkOiByb3cuYXBwcm92YWxfc3RhdHVzID09PSAnYXBwcm92ZWQnLFxuICAgICAgY3JlYXRlZF9hdDogcm93LmNyZWF0ZWRfYXQsXG4gICAgICB1cGRhdGVkX2F0OiByb3cudXBkYXRlZF9hdCxcbiAgICAgIHBhc3N3b3JkX2hhc2g6IHJvdy5wYXNzd29yZF9oYXNoXG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIGdldFVzZXJCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFVzZXIgfCBudWxsPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0gJDEnLFxuICAgICAgW2lkXVxuICAgICk7XG4gICAgY29uc3Qgcm93ID0gcmVzdWx0LnJvd3NbMF07XG4gICAgaWYgKCFyb3cpIHJldHVybiBudWxsO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdVc2VyIGRhdGE6Jywgcm93KTtcbiAgICBjb25zb2xlLmxvZygnVXNlciBpc0FwcHJvdmVkOicsIHJvdy5hcHByb3ZhbF9zdGF0dXMgPT09ICdhcHByb3ZlZCcsICd0eXBlOicsIHR5cGVvZiAocm93LmFwcHJvdmFsX3N0YXR1cyA9PT0gJ2FwcHJvdmVkJykpO1xuICAgIGNvbnNvbGUubG9nKCdVc2VyIHJvbGU6Jywgcm93LnJvbGUpO1xuICAgIGNvbnNvbGUubG9nKCdGaW5hbCBpc0FwcHJvdmVkOicsIHJvdy5hcHByb3ZhbF9zdGF0dXMgPT09ICdhcHByb3ZlZCcpO1xuICAgIFxuICAgIC8vINCc0LDQv9C/0LjQvdCzINC/0L7Qu9C10Lkg0LHQsNC30Ysg0LTQsNC90L3Ri9GFINCyIFVzZXIg0LjQvdGC0LXRgNGE0LXQudGBXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiByb3cuaWQsXG4gICAgICBuYW1lOiByb3cubmFtZSxcbiAgICAgIGVtYWlsOiByb3cuZW1haWwsXG4gICAgICBhdmF0YXI6IHJvdy5hdmF0YXJfdXJsLFxuICAgICAgcm9sZTogcm93LnJvbGUgfHwgJ3VzZXInLFxuICAgICAgaXNBcHByb3ZlZDogcm93LmFwcHJvdmFsX3N0YXR1cyA9PT0gJ2FwcHJvdmVkJyxcbiAgICAgIGNyZWF0ZWRfYXQ6IHJvdy5jcmVhdGVkX2F0LFxuICAgICAgdXBkYXRlZF9hdDogcm93LnVwZGF0ZWRfYXQsXG4gICAgICBwYXNzd29yZF9oYXNoOiByb3cucGFzc3dvcmRfaGFzaFxuICAgIH07XG4gIH1cblxuICBhc3luYyB1cGRhdGVVc2VyKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8VXNlcj4pOiBQcm9taXNlPFVzZXIgfCBudWxsPiB7XG4gICAgY29uc3QgZmllbGRzID0gT2JqZWN0LmtleXModXBkYXRlcykuZmlsdGVyKGtleSA9PiBrZXkgIT09ICdpZCcgJiYga2V5ICE9PSAnY3JlYXRlZF9hdCcgJiYga2V5ICE9PSAndXBkYXRlZF9hdCcpO1xuICAgIFxuICAgIGlmIChmaWVsZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRVc2VyQnlJZChpZCk7XG4gICAgfVxuXG4gICAgLy8g0JzQsNC/0L/QuNC90LMg0L/QvtC70LXQuSDQuNC90YLQtdGA0YTQtdC50YHQsCBVc2VyINCyINC/0L7Qu9GPINCx0LDQt9GLINC00LDQvdC90YvRhVxuICAgIGNvbnN0IGRiRmllbGRzID0gZmllbGRzLm1hcChmaWVsZCA9PiB7XG4gICAgICBpZiAoZmllbGQgPT09ICdhdmF0YXInKSByZXR1cm4gJ2F2YXRhcl91cmwnO1xuICAgICAgaWYgKGZpZWxkID09PSAnaXNBcHByb3ZlZCcpIHJldHVybiAnYXBwcm92YWxfc3RhdHVzJztcbiAgICAgIHJldHVybiBmaWVsZDtcbiAgICB9KTtcbiAgICBcbiAgICAvLyDQn9GA0LXQvtCx0YDQsNC30YPQtdC8INC30L3QsNGH0LXQvdC40Y8g0LTQu9GPINCx0LDQt9GLINC00LDQvdC90YvRhVxuICAgIGNvbnN0IGRiVmFsdWVzID0gZmllbGRzLm1hcChmaWVsZCA9PiB7XG4gICAgICBpZiAoZmllbGQgPT09ICdpc0FwcHJvdmVkJykge1xuICAgICAgICByZXR1cm4gdXBkYXRlc1tmaWVsZF0gPyAnYXBwcm92ZWQnIDogJ3BlbmRpbmcnO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVwZGF0ZXNbZmllbGQgYXMga2V5b2YgVXNlcl07XG4gICAgfSk7XG4gICAgXG4gICAgY29uc3Qgc2V0Q2xhdXNlID0gZGJGaWVsZHMubWFwKChmaWVsZCwgaW5kZXgpID0+IGAke2ZpZWxkfSA9ICQke2luZGV4ICsgMn1gKS5qb2luKCcsICcpO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgIGBVUERBVEUgdXNlcnMgU0VUICR7c2V0Q2xhdXNlfSwgdXBkYXRlZF9hdCA9IENVUlJFTlRfVElNRVNUQU1QIFdIRVJFIGlkID0gJDEgUkVUVVJOSU5HICpgLFxuICAgICAgW2lkLCAuLi5kYlZhbHVlc11cbiAgICApO1xuICAgIFxuICAgIGNvbnN0IHJvdyA9IHJlc3VsdC5yb3dzWzBdO1xuICAgIGlmICghcm93KSByZXR1cm4gbnVsbDtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHJvdy5pZCxcbiAgICAgIG5hbWU6IHJvdy5uYW1lLFxuICAgICAgZW1haWw6IHJvdy5lbWFpbCxcbiAgICAgIGF2YXRhcjogcm93LmF2YXRhcl91cmwsXG4gICAgICByb2xlOiByb3cucm9sZSxcbiAgICAgIGlzQXBwcm92ZWQ6IHJvdy5pc19hcHByb3ZlZCxcbiAgICAgIGNyZWF0ZWRfYXQ6IHJvdy5jcmVhdGVkX2F0LFxuICAgICAgdXBkYXRlZF9hdDogcm93LnVwZGF0ZWRfYXQsXG4gICAgICBwYXNzd29yZF9oYXNoOiByb3cucGFzc3dvcmRfaGFzaFxuICAgIH07XG4gIH1cblxuICBhc3luYyBnZXRBbGxVc2VycygpOiBQcm9taXNlPFVzZXJbXT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICAnU0VMRUNUICogRlJPTSB1c2VycyBPUkRFUiBCWSBjcmVhdGVkX2F0IERFU0MnXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3MubWFwKChyb3c6IGFueSkgPT4gKHtcbiAgICAgIGlkOiByb3cuaWQsXG4gICAgICBuYW1lOiByb3cubmFtZSxcbiAgICAgIGVtYWlsOiByb3cuZW1haWwsXG4gICAgICBhdmF0YXI6IHJvdy5hdmF0YXJfdXJsLFxuICAgICAgcm9sZTogcm93LnJvbGUgfHwgJ3VzZXInLFxuICAgICAgaXNBcHByb3ZlZDogcm93LmFwcHJvdmFsX3N0YXR1cyA9PT0gJ2FwcHJvdmVkJyxcbiAgICAgIGNyZWF0ZWRfYXQ6IHJvdy5jcmVhdGVkX2F0LFxuICAgICAgdXBkYXRlZF9hdDogcm93LnVwZGF0ZWRfYXQsXG4gICAgICBwYXNzd29yZF9oYXNoOiByb3cucGFzc3dvcmRfaGFzaFxuICAgIH0pKTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVVzZXIoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICAnREVMRVRFIEZST00gdXNlcnMgV0hFUkUgaWQgPSAkMScsXG4gICAgICBbaWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfVxuXG4gIC8vID09PSDQnNCV0KLQntCU0Ksg0JTQm9CvINCf0KDQntCV0JrQotCe0JIgPT09XG5cbiAgYXN5bmMgY3JlYXRlUHJvamVjdChwcm9qZWN0RGF0YTogeyBuYW1lOiBzdHJpbmc7IGRlc2NyaXB0aW9uOiBzdHJpbmc7IGNyZWF0ZWRfYnk6IHN0cmluZzsgY29sb3I/OiBzdHJpbmc7IGljb25fdXJsPzogc3RyaW5nIH0pOiBQcm9taXNlPFByb2plY3Q+IHtcbiAgICBjb25zb2xlLmxvZygn8J+UjSBQb3N0Z3JlU1FMIGNyZWF0ZVByb2plY3QgY2FsbGVkIHdpdGg6JywgcHJvamVjdERhdGEpO1xuICAgIHRyeSB7XG4gICAgICAvLyDQmtC+0L3QstC10YDRgtC40YDRg9C10Lwg0YHRgtGA0L7QutC+0LLRi9C5IElEINCyIGludGVnZXIg0LTQu9GPIFBvc3RncmVTUUxcbiAgICAgIGNvbnN0IG93bmVySWRJbnQgPSBwYXJzZUludChwcm9qZWN0RGF0YS5jcmVhdGVkX2J5LCAxMCk7XG4gICAgICBpZiAoaXNOYU4ob3duZXJJZEludCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHVzZXIgSUQ6ICR7cHJvamVjdERhdGEuY3JlYXRlZF9ieX1gKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICAgYElOU0VSVCBJTlRPIHByb2plY3RzIChuYW1lLCBkZXNjcmlwdGlvbiwgb3duZXJfaWQsIGNvbG9yLCBpY29uLCBpc19hY3RpdmUsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQpXG4gICAgICAgVkFMVUVTICgkMSwgJDIsICQzLCAkNCwgJDUsICQ2LCBDVVJSRU5UX1RJTUVTVEFNUCwgQ1VSUkVOVF9USU1FU1RBTVApIFJFVFVSTklORyAqYCxcbiAgICAgICAgW3Byb2plY3REYXRhLm5hbWUsIHByb2plY3REYXRhLmRlc2NyaXB0aW9uLCBvd25lcklkSW50LCBwcm9qZWN0RGF0YS5jb2xvciB8fCAnIzNCODJGNicsIHByb2plY3REYXRhLmljb25fdXJsIHx8IG51bGwsIHRydWVdXG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zdCBwcm9qZWN0ID0gcmVzdWx0LnJvd3NbMF07XG4gICAgICBcbiAgICAgIC8vINCU0L7QsdCw0LLQu9GP0LXQvCDQstC70LDQtNC10LvRjNGG0LAg0L/RgNC+0LXQutGC0LAg0LIgcHJvamVjdF9tZW1iZXJzINGBINGA0L7Qu9GM0Y4gJ293bmVyJ1xuICAgICAgYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICAgYElOU0VSVCBJTlRPIHByb2plY3RfbWVtYmVycyAocHJvamVjdF9pZCwgdXNlcl9pZCwgcm9sZSwgam9pbmVkX2F0KVxuICAgICAgICAgVkFMVUVTICgkMSwgJDIsICQzLCBDVVJSRU5UX1RJTUVTVEFNUClgLFxuICAgICAgICBbcHJvamVjdC5pZCwgb3duZXJJZEludCwgJ293bmVyJ11cbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vINCf0YDQtdC+0LHRgNCw0LfRg9C10Lwgb3duZXJfaWQg0L7QsdGA0LDRgtC90L4g0LIgY3JlYXRlZF9ieSDQtNC70Y8g0YHQvtCy0LzQtdGB0YLQuNC80L7RgdGC0Lgg0YEgQVBJXG4gICAgICBjb25zdCBhcGlQcm9qZWN0ID0ge1xuICAgICAgICAuLi5wcm9qZWN0LFxuICAgICAgICBjcmVhdGVkX2J5OiBwcm9qZWN0Lm93bmVyX2lkLnRvU3RyaW5nKCksXG4gICAgICAgIGljb25fdXJsOiBwcm9qZWN0Lmljb25cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgUG9zdGdyZVNRTCBwcm9qZWN0IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5IHdpdGggb3duZXIgbWVtYmVyc2hpcDonLCBhcGlQcm9qZWN0KTtcbiAgICAgIHJldHVybiBhcGlQcm9qZWN0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgUG9zdGdyZVNRTCBjcmVhdGVQcm9qZWN0IGVycm9yOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFByb2plY3RCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFByb2plY3QgfCBudWxsPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdTRUxFQ1QgKiBGUk9NIHByb2plY3RzIFdIRVJFIGlkID0gJDEnLFxuICAgICAgW2lkXVxuICAgICk7XG4gICAgY29uc3QgcHJvamVjdCA9IHJlc3VsdC5yb3dzWzBdO1xuICAgIGlmICghcHJvamVjdCkgcmV0dXJuIG51bGw7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnByb2plY3QsXG4gICAgICBjcmVhdGVkX2J5OiBwcm9qZWN0Lm93bmVyX2lkLnRvU3RyaW5nKCksXG4gICAgICBpY29uX3VybDogcHJvamVjdC5pY29uXG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIGdldFByb2plY3RzQnlVc2VySWQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFByb2plY3RbXT4ge1xuICAgIC8vINCa0L7QvdCy0LXRgNGC0LjRgNGD0LXQvCB1c2VySWQg0LIgaW50ZWdlciDQtNC70Y8gUG9zdGdyZVNRTFxuICAgIGNvbnN0IHVzZXJJZEludCA9IHBhcnNlSW50KHVzZXJJZCwgMTApO1xuICAgIGlmIChpc05hTih1c2VySWRJbnQpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIHVzZXJJZCBmb3IgZ2V0UHJvamVjdHNCeVVzZXJJZDonLCB1c2VySWQpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgYFNFTEVDVCBESVNUSU5DVCBwLiogRlJPTSBwcm9qZWN0cyBwIFxuICAgICAgIExFRlQgSk9JTiBwcm9qZWN0X21lbWJlcnMgcG0gT04gcC5pZCA9IHBtLnByb2plY3RfaWQgXG4gICAgICAgV0hFUkUgKHAub3duZXJfaWQgPSAkMSBPUiBwbS51c2VyX2lkID0gJDEpIFxuICAgICAgIE9SREVSIEJZIHAuY3JlYXRlZF9hdCBERVNDYCxcbiAgICAgIFt1c2VySWRJbnRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3MubWFwKChwcm9qZWN0OiBhbnkpID0+ICh7XG4gICAgICAuLi5wcm9qZWN0LFxuICAgICAgY3JlYXRlZF9ieTogcHJvamVjdC5vd25lcl9pZC50b1N0cmluZygpLFxuICAgICAgaWNvbl91cmw6IHByb2plY3QuaWNvblxuICAgIH0pKTtcbiAgfVxuXG4gIGFzeW5jIGdldFVzZXJQcm9qZWN0cyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8UHJvamVjdFtdPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0UHJvamVjdHNCeVVzZXJJZCh1c2VySWQpO1xuICB9XG5cbiAgYXN5bmMgZ2V0QWxsUHJvamVjdHMoKTogUHJvbWlzZTxQcm9qZWN0W10+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gcHJvamVjdHMgT1JERVIgQlkgY3JlYXRlZF9hdCBERVNDJ1xuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzLm1hcCgocHJvamVjdDogYW55KSA9PiAoe1xuICAgICAgLi4ucHJvamVjdCxcbiAgICAgIGNyZWF0ZWRfYnk6IHByb2plY3Qub3duZXJfaWQudG9TdHJpbmcoKSxcbiAgICAgIGljb25fdXJsOiBwcm9qZWN0Lmljb25cbiAgICB9KSk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVQcm9qZWN0KGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8UHJvamVjdD4pOiBQcm9taXNlPFByb2plY3QgfCBudWxsPiB7XG4gICAgY29uc3QgZmllbGRzID0gT2JqZWN0LmtleXModXBkYXRlcykuZmlsdGVyKGtleSA9PiBrZXkgIT09ICdpZCcpO1xuICAgIGNvbnN0IHZhbHVlcyA9IGZpZWxkcy5tYXAoZmllbGQgPT4gdXBkYXRlc1tmaWVsZCBhcyBrZXlvZiBQcm9qZWN0XSk7XG4gICAgY29uc3Qgc2V0Q2xhdXNlID0gZmllbGRzLm1hcCgoZmllbGQsIGluZGV4KSA9PiBgJHtmaWVsZH0gPSAkJHtpbmRleCArIDJ9YCkuam9pbignLCAnKTtcbiAgICBcbiAgICBpZiAoZmllbGRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0UHJvamVjdEJ5SWQoaWQpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICBgVVBEQVRFIHByb2plY3RzIFNFVCAke3NldENsYXVzZX0gV0hFUkUgaWQgPSAkMSBSRVRVUk5JTkcgKmAsXG4gICAgICBbaWQsIC4uLnZhbHVlc11cbiAgICApO1xuICAgIGNvbnN0IHByb2plY3QgPSByZXN1bHQucm93c1swXTtcbiAgICBpZiAoIXByb2plY3QpIHJldHVybiBudWxsO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAuLi5wcm9qZWN0LFxuICAgICAgY3JlYXRlZF9ieTogcHJvamVjdC5vd25lcl9pZC50b1N0cmluZygpLFxuICAgICAgaWNvbl91cmw6IHByb2plY3QuaWNvblxuICAgIH07XG4gIH1cblxuICBhc3luYyBkZWxldGVQcm9qZWN0KGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ0RFTEVURSBGUk9NIHByb2plY3RzIFdIRVJFIGlkID0gJDEnLFxuICAgICAgW2lkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dDb3VudCA+IDA7XG4gIH1cblxuICBhc3luYyBoYXNQcm9qZWN0QWNjZXNzKHVzZXJJZDogc3RyaW5nLCBwcm9qZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDQmtC+0L3QstC10YDRgtC40YDRg9C10LwgdXNlcklkINCyIGludGVnZXIg0LTQu9GPINGB0YDQsNCy0L3QtdC90LjRjyDRgSBQb3N0Z3JlU1FMXG4gICAgICBjb25zdCB1c2VySWRJbnQgPSBwYXJzZUludCh1c2VySWQsIDEwKTtcbiAgICAgIGlmIChpc05hTih1c2VySWRJbnQpKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgdXNlcklkIGZvciBhY2Nlc3MgY2hlY2s6JywgdXNlcklkKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDQn9GA0L7QstC10YDRj9C10LwsINGP0LLQu9GP0LXRgtGB0Y8g0LvQuCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0LLQu9Cw0LTQtdC70YzRhtC10Lwg0L/RgNC+0LXQutGC0LBcbiAgICAgIGNvbnN0IG93bmVyUmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICAgJ1NFTEVDVCBvd25lcl9pZCBGUk9NIHByb2plY3RzIFdIRVJFIGlkID0gJDEnLFxuICAgICAgICBbcHJvamVjdElkXVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgaWYgKG93bmVyUmVzdWx0LnJvd3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTsgLy8g0J/RgNC+0LXQutGCINC90LUg0L3QsNC50LTQtdC9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHByb2plY3RPd25lciA9IG93bmVyUmVzdWx0LnJvd3NbMF0ub3duZXJfaWQ7XG4gICAgICBpZiAocHJvamVjdE93bmVyID09PSB1c2VySWRJbnQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7IC8vINCf0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDRj9Cy0LvRj9C10YLRgdGPINCy0LvQsNC00LXQu9GM0YbQtdC8XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vINCf0YDQvtCy0LXRgNGP0LXQvCDRh9C70LXQvdGB0YLQstC+INCyINC/0YDQvtC10LrRgtC1XG4gICAgICBjb25zdCBtZW1iZXJSZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgICAnU0VMRUNUIDEgRlJPTSBwcm9qZWN0X21lbWJlcnMgV0hFUkUgcHJvamVjdF9pZCA9ICQxIEFORCB1c2VyX2lkID0gJDInLFxuICAgICAgICBbcHJvamVjdElkLCB1c2VySWRJbnRdXG4gICAgICApO1xuICAgICAgXG4gICAgICByZXR1cm4gbWVtYmVyUmVzdWx0LnJvd3MubGVuZ3RoID4gMDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2hlY2tpbmcgcHJvamVjdCBhY2Nlc3M6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8vID09PSDQnNCV0KLQntCU0Ksg0JTQm9CvINCU0J7QodCe0JogPT09XG5cbiAgYXN5bmMgY3JlYXRlQm9hcmQoYm9hcmREYXRhOiBhbnkpOiBQcm9taXNlPEJvYXJkPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgIGBJTlNFUlQgSU5UTyBib2FyZHMgKG5hbWUsIGRlc2NyaXB0aW9uLCBwcm9qZWN0X2lkLCBjcmVhdGVkX2J5LCBjcmVhdGVkX2F0LCB1cGRhdGVkX2F0KSBcbiAgICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCBDVVJSRU5UX1RJTUVTVEFNUCwgQ1VSUkVOVF9USU1FU1RBTVApIFxuICAgICAgIFJFVFVSTklORyAqYCxcbiAgICAgIFtib2FyZERhdGEubmFtZSwgYm9hcmREYXRhLmRlc2NyaXB0aW9uIHx8ICcnLCBib2FyZERhdGEucHJvamVjdF9pZCwgcGFyc2VJbnQoYm9hcmREYXRhLmNyZWF0ZWRfYnksIDEwKV1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfVxuXG4gIGFzeW5jIGdldEJvYXJkQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxCb2FyZCB8IG51bGw+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gYm9hcmRzIFdIRVJFIGlkID0gJDEnLFxuICAgICAgW2lkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdIHx8IG51bGw7XG4gIH1cblxuICBhc3luYyBnZXRCb2FyZHNCeVByb2plY3RJZChwcm9qZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8Qm9hcmRbXT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICBgU0VMRUNUIGIuKiBGUk9NIGJvYXJkcyBiIFxuICAgICAgIEpPSU4gcHJvamVjdHMgcCBPTiBiLnByb2plY3RfaWQgPSBwLmlkIFxuICAgICAgIFdIRVJFIGIucHJvamVjdF9pZCA9ICQxIFxuICAgICAgIE9SREVSIEJZIGIucG9zaXRpb24gQVNDLCBiLmNyZWF0ZWRfYXQgREVTQ2AsXG4gICAgICBbcHJvamVjdElkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlQm9hcmQoaWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxCb2FyZD4pOiBQcm9taXNlPEJvYXJkIHwgbnVsbD4ge1xuICAgIGNvbnN0IGZpZWxkcyA9IE9iamVjdC5rZXlzKHVwZGF0ZXMpLmZpbHRlcihrZXkgPT4ga2V5ICE9PSAnaWQnKTtcbiAgICBjb25zdCB2YWx1ZXMgPSBmaWVsZHMubWFwKGZpZWxkID0+IHVwZGF0ZXNbZmllbGQgYXMga2V5b2YgQm9hcmRdKTtcbiAgICBjb25zdCBzZXRDbGF1c2UgPSBmaWVsZHMubWFwKChmaWVsZCwgaW5kZXgpID0+IGAke2ZpZWxkfSA9ICQke2luZGV4ICsgMn1gKS5qb2luKCcsICcpO1xuICAgIFxuICAgIGlmIChmaWVsZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRCb2FyZEJ5SWQoaWQpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICBgVVBEQVRFIGJvYXJkcyBTRVQgJHtzZXRDbGF1c2V9IFdIRVJFIGlkID0gJDEgUkVUVVJOSU5HICpgLFxuICAgICAgW2lkLCAuLi52YWx1ZXNdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZUJvYXJkKGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ0RFTEVURSBGUk9NIGJvYXJkcyBXSEVSRSBpZCA9ICQxJyxcbiAgICAgIFtpZF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93Q291bnQgPiAwO1xuICB9XG5cbiAgLy8gPT09INCc0JXQotCe0JTQqyDQlNCb0K8g0JrQntCb0J7QndCe0JogPT09XG5cbiAgYXN5bmMgY3JlYXRlQ29sdW1uKHRpdGxlOiBzdHJpbmcsIGJvYXJkSWQ6IHN0cmluZywgcG9zaXRpb24/OiBudW1iZXIsIGNvbG9yPzogc3RyaW5nLCBjcmVhdGVkQnk/OiBzdHJpbmcpOiBQcm9taXNlPENvbHVtbj4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICBgSU5TRVJUIElOVE8gY29sdW1ucyAodGl0bGUsIGJvYXJkX2lkLCBwb3NpdGlvbiwgY29sb3IsIHNldHRpbmdzLCBjcmVhdGVkX2J5KSBcbiAgICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCAkNSwgJDYpIFxuICAgICAgIFJFVFVSTklORyAqYCxcbiAgICAgIFt0aXRsZSwgYm9hcmRJZCwgcG9zaXRpb24gfHwgMCwgY29sb3IgfHwgJyM2QjcyODAnLCAne30nLCBjcmVhdGVkQnkgfHwgbnVsbF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfVxuXG4gIGFzeW5jIGdldENvbHVtbkJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8Q29sdW1uIHwgbnVsbD4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICAnU0VMRUNUICogRlJPTSBjb2x1bW5zIFdIRVJFIGlkID0gJDEnLFxuICAgICAgW2lkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdIHx8IG51bGw7XG4gIH1cblxuICBhc3luYyBnZXRDb2x1bW5zQnlCb2FyZElkKGJvYXJkSWQ6IHN0cmluZyk6IFByb21pc2U8Q29sdW1uW10+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gY29sdW1ucyBXSEVSRSBib2FyZF9pZCA9ICQxIE9SREVSIEJZIHBvc2l0aW9uIEFTQywgY3JlYXRlZF9hdCBERVNDJyxcbiAgICAgIFtib2FyZElkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlQ29sdW1uKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8Q29sdW1uPik6IFByb21pc2U8Q29sdW1uIHwgbnVsbD4ge1xuICAgIGNvbnN0IGZpZWxkcyA9IE9iamVjdC5rZXlzKHVwZGF0ZXMpLmZpbHRlcihrZXkgPT4ga2V5ICE9PSAnaWQnKTtcbiAgICBjb25zdCB2YWx1ZXMgPSBmaWVsZHMubWFwKGZpZWxkID0+IHVwZGF0ZXNbZmllbGQgYXMga2V5b2YgQ29sdW1uXSk7XG4gICAgY29uc3Qgc2V0Q2xhdXNlID0gZmllbGRzLm1hcCgoZmllbGQsIGluZGV4KSA9PiBgJHtmaWVsZH0gPSAkJHtpbmRleCArIDJ9YCkuam9pbignLCAnKTtcbiAgICBcbiAgICBpZiAoZmllbGRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0Q29sdW1uQnlJZChpZCk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgIGBVUERBVEUgY29sdW1ucyBTRVQgJHtzZXRDbGF1c2V9IFdIRVJFIGlkID0gJDEgUkVUVVJOSU5HICpgLFxuICAgICAgW2lkLCAuLi52YWx1ZXNdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZUNvbHVtbihpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdERUxFVEUgRlJPTSBjb2x1bW5zIFdIRVJFIGlkID0gJDEnLFxuICAgICAgW2lkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dDb3VudCA+IDA7XG4gIH1cblxuICAvLyA9PT0g0JzQldCi0J7QlNCrINCU0JvQryDQl9CQ0JTQkNCnID09PVxuXG4gIGFzeW5jIGNyZWF0ZVRhc2sodGFza0RhdGE6IFBhcnRpYWw8VGFzaz4pOiBQcm9taXNlPFRhc2s+IHtcbiAgICBjb25zdCB7XG4gICAgICB0aXRsZSxcbiAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgc3RhdHVzID0gJ3RvZG8nLFxuICAgICAgcHJpb3JpdHkgPSAnbWVkaXVtJyxcbiAgICAgIHByb2plY3RfaWQsXG4gICAgICBib2FyZF9pZCxcbiAgICAgIGNvbHVtbl9pZCxcbiAgICAgIGFzc2lnbmVlX2lkLFxuICAgICAgcmVwb3J0ZXJfaWQsXG4gICAgICBwb3NpdGlvbiA9IDBcbiAgICB9ID0gdGFza0RhdGE7XG5cbiAgICAvLyDQodC+0LfQtNCw0LXQvCDQt9Cw0LTQsNGH0YMg0LHQtdC3IGFzc2lnbmVlX2lkICjQuNGB0L/QvtC70YzQt9GD0LXRgtGB0Y8g0L7RgtC00LXQu9GM0L3QsNGPINGC0LDQsdC70LjRhtCwIHRhc2tfYXNzaWduZWVzKVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICBgSU5TRVJUIElOVE8gdGFza3MgKHRpdGxlLCBkZXNjcmlwdGlvbiwgc3RhdHVzLCBwcmlvcml0eSwgcHJvamVjdF9pZCwgYm9hcmRfaWQsIGNvbHVtbl9pZCwgcmVwb3J0ZXJfaWQsIHBvc2l0aW9uKSBcbiAgICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCAkNSwgJDYsICQ3LCAkOCwgJDkpIFxuICAgICAgIFJFVFVSTklORyAqYCxcbiAgICAgIFt0aXRsZSwgZGVzY3JpcHRpb24sIHN0YXR1cywgcHJpb3JpdHksIHByb2plY3RfaWQsIGJvYXJkX2lkLCBjb2x1bW5faWQsIHJlcG9ydGVyX2lkLCBwb3NpdGlvbl1cbiAgICApO1xuICAgIFxuICAgIGNvbnN0IHRhc2sgPSByZXN1bHQucm93c1swXTtcbiAgICBcbiAgICAvLyDQldGB0LvQuCDRg9C60LDQt9Cw0L0gYXNzaWduZWVfaWQsINGB0L7Qt9C00LDQtdC8INC30LDQv9C40YHRjCDQsiDRgtCw0LHQu9C40YbQtSB0YXNrX2Fzc2lnbmVlc1xuICAgIGlmIChhc3NpZ25lZV9pZCkge1xuICAgICAgYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICAgYElOU0VSVCBJTlRPIHRhc2tfYXNzaWduZWVzICh0YXNrX2lkLCB1c2VyX2lkLCBhc3NpZ25lZF9ieSkgXG4gICAgICAgICBWQUxVRVMgKCQxLCAkMiwgJDMpYCxcbiAgICAgICAgW3Rhc2suaWQsIGFzc2lnbmVlX2lkLCByZXBvcnRlcl9pZF1cbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0YXNrO1xuICB9XG5cbiAgYXN5bmMgZ2V0VGFza0J5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8VGFzayB8IG51bGw+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gdGFza3MgV0hFUkUgaWQgPSAkMScsXG4gICAgICBbaWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGdldFRhc2tzQnlQcm9qZWN0SWQocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPFRhc2tbXT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICAnU0VMRUNUICogRlJPTSB0YXNrcyBXSEVSRSBwcm9qZWN0X2lkID0gJDEgT1JERVIgQlkgcG9zaXRpb24gQVNDLCBjcmVhdGVkX2F0IERFU0MnLFxuICAgICAgW3Byb2plY3RJZF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfVxuXG4gIGFzeW5jIGdldFRhc2tzQnlDb2x1bW5JZChjb2x1bW5JZDogc3RyaW5nKTogUHJvbWlzZTxUYXNrW10+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gdGFza3MgV0hFUkUgY29sdW1uX2lkID0gJDEgT1JERVIgQlkgcG9zaXRpb24gQVNDLCBjcmVhdGVkX2F0IERFU0MnLFxuICAgICAgW2NvbHVtbklkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlVGFzayhpZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPFRhc2s+KTogUHJvbWlzZTxUYXNrIHwgbnVsbD4ge1xuICAgIGNvbnN0IGZpZWxkcyA9IE9iamVjdC5rZXlzKHVwZGF0ZXMpLmZpbHRlcihrZXkgPT4ga2V5ICE9PSAnaWQnKTtcbiAgICBjb25zdCB2YWx1ZXMgPSBmaWVsZHMubWFwKGZpZWxkID0+IHVwZGF0ZXNbZmllbGQgYXMga2V5b2YgVGFza10pO1xuICAgIGNvbnN0IHNldENsYXVzZSA9IGZpZWxkcy5tYXAoKGZpZWxkLCBpbmRleCkgPT4gYCR7ZmllbGR9ID0gJCR7aW5kZXggKyAyfWApLmpvaW4oJywgJyk7XG4gICAgXG4gICAgaWYgKGZpZWxkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldFRhc2tCeUlkKGlkKTtcbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgYFVQREFURSB0YXNrcyBTRVQgJHtzZXRDbGF1c2V9IFdIRVJFIGlkID0gJDEgUkVUVVJOSU5HICpgLFxuICAgICAgW2lkLCAuLi52YWx1ZXNdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF0gfHwgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVRhc2soaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICAnREVMRVRFIEZST00gdGFza3MgV0hFUkUgaWQgPSAkMScsXG4gICAgICBbaWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfVxuXG4gIGFzeW5jIGdldFRhc2tBc3NpZ25lZXModGFza0lkOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgIGBTRUxFQ1QgdS5pZCwgdS51c2VybmFtZSwgdS5lbWFpbCwgdGEuYXNzaWduZWRfYXQgXG4gICAgICAgRlJPTSB0YXNrX2Fzc2lnbmVlcyB0YSBcbiAgICAgICBKT0lOIHVzZXJzIHUgT04gdGEudXNlcl9pZCA9IHUuaWQgXG4gICAgICAgV0hFUkUgdGEudGFza19pZCA9ICQxYCxcbiAgICAgIFt0YXNrSWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gIH1cblxuICBhc3luYyBhc3NpZ25UYXNrVG9Vc2VyKHRhc2tJZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZywgYXNzaWduZWRCeT86IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgICBgSU5TRVJUIElOVE8gdGFza19hc3NpZ25lZXMgKHRhc2tfaWQsIHVzZXJfaWQsIGFzc2lnbmVkX2J5KSBcbiAgICAgICAgIFZBTFVFUyAoJDEsICQyLCAkMykgXG4gICAgICAgICBPTiBDT05GTElDVCAodGFza19pZCwgdXNlcl9pZCkgRE8gTk9USElOR2AsXG4gICAgICAgIFt0YXNrSWQsIHVzZXJJZCwgYXNzaWduZWRCeV1cbiAgICAgICk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgYXNzaWduaW5nIHRhc2sgdG8gdXNlcjonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgdW5hc3NpZ25UYXNrRnJvbVVzZXIodGFza0lkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdERUxFVEUgRlJPTSB0YXNrX2Fzc2lnbmVlcyBXSEVSRSB0YXNrX2lkID0gJDEgQU5EIHVzZXJfaWQgPSAkMicsXG4gICAgICBbdGFza0lkLCB1c2VySWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfVxuXG4gIC8vID09PSDQlNCe0J/QntCb0J3QmNCi0JXQm9Cs0J3Qq9CVINCc0JXQotCe0JTQqyDQlNCb0K8g0KHQntCS0JzQldCh0KLQmNCc0J7QodCi0JggPT09XG5cbiAgYXN5bmMgZ2V0Qm9hcmRDb2x1bW5zKGJvYXJkSWQ6IHN0cmluZyk6IFByb21pc2U8Q29sdW1uW10+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRDb2x1bW5zQnlCb2FyZElkKGJvYXJkSWQpO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q29sdW1uVGFza3MoY29sdW1uSWQ6IHN0cmluZyk6IFByb21pc2U8VGFza1tdPiB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0VGFza3NCeUNvbHVtbklkKGNvbHVtbklkKTtcbiAgfVxuXG4gIC8vID09PSDQnNCV0KLQntCU0Ksg0JTQm9CvINCh0JXQodCh0JjQmSA9PT1cblxuICBhc3luYyBjcmVhdGVTZXNzaW9uKHNlc3Npb25EYXRhOiBPbWl0PFNlc3Npb24sICdpZCcgfCAnY3JlYXRlZF9hdCcgfCAndXBkYXRlZF9hdCc+KTogUHJvbWlzZTxTZXNzaW9uPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdJTlNFUlQgSU5UTyBzZXNzaW9ucyAoc2Vzc2lvbl90b2tlbiwgdXNlcl9pZCwgZXhwaXJlc19hdCkgVkFMVUVTICgkMSwgJDIsICQzKSBSRVRVUk5JTkcgKicsXG4gICAgICBbc2Vzc2lvbkRhdGEudG9rZW4sIHNlc3Npb25EYXRhLnVzZXJfaWQsIHNlc3Npb25EYXRhLmV4cGlyZXNfYXRdXG4gICAgKTtcbiAgICBcbiAgICBjb25zdCByb3cgPSByZXN1bHQucm93c1swXTtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHJvdy5pZCxcbiAgICAgIHVzZXJfaWQ6IHJvdy51c2VyX2lkLFxuICAgICAgdG9rZW46IHJvdy5zZXNzaW9uX3Rva2VuLFxuICAgICAgZXhwaXJlc19hdDogcm93LmV4cGlyZXNfYXQsXG4gICAgICBjcmVhdGVkX2F0OiByb3cuY3JlYXRlZF9hdFxuICAgIH07XG4gIH1cblxuICBhc3luYyBnZXRTZXNzaW9uQnlUb2tlbihzZXNzaW9uVG9rZW46IHN0cmluZyk6IFByb21pc2U8U2Vzc2lvbiB8IG51bGw+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gc2Vzc2lvbnMgV0hFUkUgc2Vzc2lvbl90b2tlbiA9ICQxIEFORCBleHBpcmVzX2F0ID4gTk9XKCknLFxuICAgICAgW3Nlc3Npb25Ub2tlbl1cbiAgICApO1xuICAgIFxuICAgIGlmICghcmVzdWx0LnJvd3NbMF0pIHJldHVybiBudWxsO1xuICAgIFxuICAgIGNvbnN0IHJvdyA9IHJlc3VsdC5yb3dzWzBdO1xuICAgIHJldHVybiB7XG4gICAgICBpZDogcm93LmlkLFxuICAgICAgdXNlcl9pZDogcm93LnVzZXJfaWQsXG4gICAgICB0b2tlbjogcm93LnNlc3Npb25fdG9rZW4sXG4gICAgICBleHBpcmVzX2F0OiByb3cuZXhwaXJlc19hdCxcbiAgICAgIGNyZWF0ZWRfYXQ6IHJvdy5jcmVhdGVkX2F0XG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVNlc3Npb24oc2Vzc2lvblRva2VuOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ0RFTEVURSBGUk9NIHNlc3Npb25zIFdIRVJFIHNlc3Npb25fdG9rZW4gPSAkMScsXG4gICAgICBbc2Vzc2lvblRva2VuXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dDb3VudCA+IDA7XG4gIH1cblxuICBhc3luYyBkZWxldGVVc2VyU2Vzc2lvbnModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICAnREVMRVRFIEZST00gc2Vzc2lvbnMgV0hFUkUgdXNlcl9pZCA9ICQxJyxcbiAgICAgIFt1c2VySWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50O1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlRXhwaXJlZFNlc3Npb25zKCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdERUxFVEUgRlJPTSBzZXNzaW9ucyBXSEVSRSBleHBpcmVzX2F0IDw9IE5PVygpJ1xuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dDb3VudDtcbiAgfVxuXG4gIC8vID09PSDQnNCV0KLQntCU0Ksg0JTQm9CvINCa0J7QnNCc0JXQndCi0JDQoNCY0JXQkiA9PT1cblxuICBhc3luYyBjcmVhdGVDb21tZW50KGNvbnRlbnQ6IHN0cmluZywgdGFza0lkOiBzdHJpbmcsIGF1dGhvcklkOiBzdHJpbmcpOiBQcm9taXNlPENvbW1lbnQ+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgYElOU0VSVCBJTlRPIGNvbW1lbnRzIChjb250ZW50LCB0YXNrX2lkLCBhdXRob3JfaWQpIFxuICAgICAgIFZBTFVFUyAoJDEsICQyLCAkMykgXG4gICAgICAgUkVUVVJOSU5HICpgLFxuICAgICAgW2NvbnRlbnQsIHRhc2tJZCwgYXV0aG9ySWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH1cblxuICBhc3luYyBnZXRDb21tZW50c0J5VGFza0lkKHRhc2tJZDogc3RyaW5nKTogUHJvbWlzZTxDb21tZW50W10+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gY29tbWVudHMgV0hFUkUgdGFza19pZCA9ICQxIEFORCBkZWxldGVkX2F0IElTIE5VTEwgT1JERVIgQlkgY3JlYXRlZF9hdCcsXG4gICAgICBbdGFza0lkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlQ29tbWVudChpZDogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPENvbW1lbnQgfCBudWxsPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdVUERBVEUgY29tbWVudHMgU0VUIGNvbnRlbnQgPSAkMiBXSEVSRSBpZCA9ICQxIFJFVFVSTklORyAqJyxcbiAgICAgIFtpZCwgY29udGVudF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXSB8fCBudWxsO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlQ29tbWVudChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdVUERBVEUgY29tbWVudHMgU0VUIGRlbGV0ZWRfYXQgPSBDVVJSRU5UX1RJTUVTVEFNUCBXSEVSRSBpZCA9ICQxJyxcbiAgICAgIFtpZF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93Q291bnQgPiAwO1xuICB9XG5cbiAgLy8gPT09INCc0JXQotCe0JTQqyDQlNCb0K8g0KLQldCT0J7QkiA9PT1cblxuICBhc3luYyBjcmVhdGVUYWcobmFtZTogc3RyaW5nLCBjb2xvcjogc3RyaW5nLCBwcm9qZWN0SWQ/OiBzdHJpbmcpOiBQcm9taXNlPFRhZz4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICBgSU5TRVJUIElOVE8gdGFncyAobmFtZSwgY29sb3IsIHByb2plY3RfaWQpIFxuICAgICAgIFZBTFVFUyAoJDEsICQyLCAkMykgXG4gICAgICAgUkVUVVJOSU5HICpgLFxuICAgICAgW25hbWUsIGNvbG9yLCBwcm9qZWN0SWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH1cblxuICBhc3luYyBnZXRUYWdzQnlQcm9qZWN0SWQocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPFRhZ1tdPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdTRUxFQ1QgKiBGUk9NIHRhZ3MgV0hFUkUgcHJvamVjdF9pZCA9ICQxIE9SREVSIEJZIG5hbWUnLFxuICAgICAgW3Byb2plY3RJZF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfVxuXG4gIGFzeW5jIGFkZFRhZ1RvVGFzayh0YXNrSWQ6IHN0cmluZywgdGFnSWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnF1ZXJ5KFxuICAgICAgICAnSU5TRVJUIElOVE8gdGFza190YWdzICh0YXNrX2lkLCB0YWdfaWQpIFZBTFVFUyAoJDEsICQyKScsXG4gICAgICAgIFt0YXNrSWQsIHRhZ0lkXVxuICAgICAgKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlbW92ZVRhZ0Zyb21UYXNrKHRhc2tJZDogc3RyaW5nLCB0YWdJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5xdWVyeShcbiAgICAgICdERUxFVEUgRlJPTSB0YXNrX3RhZ3MgV0hFUkUgdGFza19pZCA9ICQxIEFORCB0YWdfaWQgPSAkMicsXG4gICAgICBbdGFza0lkLCB0YWdJZF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93Q291bnQgPiAwO1xuICB9XG5cbiAgYXN5bmMgZ2V0VGFnc0J5VGFza0lkKHRhc2tJZDogc3RyaW5nKTogUHJvbWlzZTxUYWdbXT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucXVlcnkoXG4gICAgICBgU0VMRUNUIHQuKiBGUk9NIHRhZ3MgdCBcbiAgICAgICBKT0lOIHRhc2tfdGFncyB0dCBPTiB0LmlkID0gdHQudGFnX2lkIFxuICAgICAgIFdIRVJFIHR0LnRhc2tfaWQgPSAkMWAsXG4gICAgICBbdGFza0lkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9XG5cbiAgLy8g0KHRgtCw0YLQuNGH0LXRgdC60LjQuSDQvNC10YLQvtC0INC00LvRjyDQv9C+0LvRg9GH0LXQvdC40Y8g0Y3QutC30LXQvNC/0LvRj9GA0LAgKFNpbmdsZXRvbilcbiAgc3RhdGljIGdldEluc3RhbmNlKCk6IFBvc3RncmVTUUxBZGFwdGVyIHtcbiAgICBpZiAoIVBvc3RncmVTUUxBZGFwdGVyLmluc3RhbmNlKSB7XG4gICAgICBjb25zdCBjb25maWc6IERhdGFiYXNlQ29uZmlnID0ge1xuICAgICAgICBob3N0OiBwcm9jZXNzLmVudi5EQl9IT1NUIHx8ICdsb2NhbGhvc3QnLFxuICAgICAgICBwb3J0OiBwYXJzZUludChwcm9jZXNzLmVudi5EQl9QT1JUIHx8ICc1NDMyJyksXG4gICAgICAgIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5EQl9OQU1FIHx8ICdlbmNvcmVfdGFza3MnLFxuICAgICAgICB1c2VyOiBwcm9jZXNzLmVudi5EQl9VU0VSIHx8ICdwb3N0Z3JlcycsXG4gICAgICAgIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5EQl9QQVNTV09SRCB8fCAncGFzc3dvcmQnLFxuICAgICAgICBzc2w6IGZhbHNlIC8vINCe0YLQutC70Y7Rh9Cw0LXQvCBTU0wg0LTQu9GPINC70L7QutCw0LvRjNC90L7Qs9C+IFBvc3RncmVTUUxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIFBvc3RncmVTUUxBZGFwdGVyLmluc3RhbmNlID0gbmV3IFBvc3RncmVTUUxBZGFwdGVyKGNvbmZpZyk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBQb3N0Z3JlU1FMQWRhcHRlci5pbnN0YW5jZTtcbiAgfVxufVxuXG4vLyDQrdC60YHQv9C+0YDRgiDRjdC60LfQtdC80L/Qu9GP0YDQsCDQsNC00LDQv9GC0LXRgNCwXG5sZXQgZGJBZGFwdGVyOiBQb3N0Z3JlU1FMQWRhcHRlciB8IG51bGwgPSBudWxsO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG9zdGdyZVNRTEFkYXB0ZXIoKTogUG9zdGdyZVNRTEFkYXB0ZXIge1xuICBpZiAoIWRiQWRhcHRlcikge1xuICAgIGNvbnN0IGNvbmZpZzogRGF0YWJhc2VDb25maWcgPSB7XG4gICAgICBob3N0OiBwcm9jZXNzLmVudi5EQl9IT1NUIHx8ICdsb2NhbGhvc3QnLFxuICAgICAgcG9ydDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREJfUE9SVCB8fCAnNTQzMicpLFxuICAgICAgZGF0YWJhc2U6IHByb2Nlc3MuZW52LkRCX05BTUUgfHwgJ2VuY29yZV90YXNrcycsXG4gICAgICB1c2VyOiBwcm9jZXNzLmVudi5EQl9VU0VSIHx8ICdwb3N0Z3JlcycsXG4gICAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuREJfUEFTU1dPUkQgfHwgJ3Bhc3N3b3JkJyxcbiAgICAgIHNzbDogcHJvY2Vzcy5lbnYuREJfU1NMID09PSAndHJ1ZSdcbiAgICB9O1xuICAgIFxuICAgIGRiQWRhcHRlciA9IG5ldyBQb3N0Z3JlU1FMQWRhcHRlcihjb25maWcpO1xuICB9XG4gIFxuICByZXR1cm4gZGJBZGFwdGVyO1xufVxuXG5leHBvcnQgZGVmYXVsdCBnZXRQb3N0Z3JlU1FMQWRhcHRlcjsiXSwibmFtZXMiOlsiUG9vbCIsImJjcnlwdCIsIlBvc3RncmVTUUxBZGFwdGVyIiwiaW5zdGFuY2UiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsImlzSW5pdGlhbGl6ZWQiLCJzc2xDb25maWciLCJzc2wiLCJob3N0IiwiaW5jbHVkZXMiLCJyZWplY3RVbmF1dGhvcml6ZWQiLCJjYSIsInVuZGVmaW5lZCIsInBvb2wiLCJwb3J0IiwiZGF0YWJhc2UiLCJ1c2VyIiwicGFzc3dvcmQiLCJtYXgiLCJpZGxlVGltZW91dE1pbGxpcyIsImNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzIiwiaW5pdGlhbGl6ZSIsImNvbnNvbGUiLCJsb2ciLCJjbGllbnQiLCJjb25uZWN0IiwicXVlcnkiLCJyZWxlYXNlIiwiZXJyb3IiLCJjbG9zZSIsImVuZCIsImdldENsaWVudCIsImNvbnZlcnRTcWxUb1Bvc3RncmVTUUwiLCJzcWwiLCJwYXJhbUluZGV4IiwicmVwbGFjZSIsInRleHQiLCJwYXJhbXMiLCJjb252ZXJ0ZWRTcWwiLCJyZXN1bHQiLCJjcmVhdGVVc2VyIiwidXNlckRhdGEiLCJlbWFpbCIsIm5hbWUiLCJyb2xlIiwicGFzc3dvcmRfaGFzaCIsImlzQXBwcm92ZWQiLCJhdmF0YXIiLCJ1c2VyRGF0YVdpdGhQYXNzd29yZCIsImhhc2hlZFBhc3N3b3JkIiwiaGFzaCIsImFwcHJvdmFsU3RhdHVzIiwicm93Iiwicm93cyIsImlkIiwiYXZhdGFyX3VybCIsImFwcHJvdmFsX3N0YXR1cyIsImNyZWF0ZWRfYXQiLCJ1cGRhdGVkX2F0IiwiZ2V0VXNlckJ5RW1haWwiLCJnZXRVc2VyQnlJZCIsInVwZGF0ZVVzZXIiLCJ1cGRhdGVzIiwiZmllbGRzIiwiT2JqZWN0Iiwia2V5cyIsImZpbHRlciIsImtleSIsImxlbmd0aCIsImRiRmllbGRzIiwibWFwIiwiZmllbGQiLCJkYlZhbHVlcyIsInNldENsYXVzZSIsImluZGV4Iiwiam9pbiIsImlzX2FwcHJvdmVkIiwiZ2V0QWxsVXNlcnMiLCJkZWxldGVVc2VyIiwicm93Q291bnQiLCJjcmVhdGVQcm9qZWN0IiwicHJvamVjdERhdGEiLCJvd25lcklkSW50IiwicGFyc2VJbnQiLCJjcmVhdGVkX2J5IiwiaXNOYU4iLCJFcnJvciIsImRlc2NyaXB0aW9uIiwiY29sb3IiLCJpY29uX3VybCIsInByb2plY3QiLCJhcGlQcm9qZWN0Iiwib3duZXJfaWQiLCJ0b1N0cmluZyIsImljb24iLCJnZXRQcm9qZWN0QnlJZCIsImdldFByb2plY3RzQnlVc2VySWQiLCJ1c2VySWQiLCJ1c2VySWRJbnQiLCJnZXRVc2VyUHJvamVjdHMiLCJnZXRBbGxQcm9qZWN0cyIsInVwZGF0ZVByb2plY3QiLCJ2YWx1ZXMiLCJkZWxldGVQcm9qZWN0IiwiaGFzUHJvamVjdEFjY2VzcyIsInByb2plY3RJZCIsIm93bmVyUmVzdWx0IiwicHJvamVjdE93bmVyIiwibWVtYmVyUmVzdWx0IiwiY3JlYXRlQm9hcmQiLCJib2FyZERhdGEiLCJwcm9qZWN0X2lkIiwiZ2V0Qm9hcmRCeUlkIiwiZ2V0Qm9hcmRzQnlQcm9qZWN0SWQiLCJ1cGRhdGVCb2FyZCIsImRlbGV0ZUJvYXJkIiwiY3JlYXRlQ29sdW1uIiwidGl0bGUiLCJib2FyZElkIiwicG9zaXRpb24iLCJjcmVhdGVkQnkiLCJnZXRDb2x1bW5CeUlkIiwiZ2V0Q29sdW1uc0J5Qm9hcmRJZCIsInVwZGF0ZUNvbHVtbiIsImRlbGV0ZUNvbHVtbiIsImNyZWF0ZVRhc2siLCJ0YXNrRGF0YSIsInN0YXR1cyIsInByaW9yaXR5IiwiYm9hcmRfaWQiLCJjb2x1bW5faWQiLCJhc3NpZ25lZV9pZCIsInJlcG9ydGVyX2lkIiwidGFzayIsImdldFRhc2tCeUlkIiwiZ2V0VGFza3NCeVByb2plY3RJZCIsImdldFRhc2tzQnlDb2x1bW5JZCIsImNvbHVtbklkIiwidXBkYXRlVGFzayIsImRlbGV0ZVRhc2siLCJnZXRUYXNrQXNzaWduZWVzIiwidGFza0lkIiwiYXNzaWduVGFza1RvVXNlciIsImFzc2lnbmVkQnkiLCJ1bmFzc2lnblRhc2tGcm9tVXNlciIsImdldEJvYXJkQ29sdW1ucyIsImdldENvbHVtblRhc2tzIiwiY3JlYXRlU2Vzc2lvbiIsInNlc3Npb25EYXRhIiwidG9rZW4iLCJ1c2VyX2lkIiwiZXhwaXJlc19hdCIsInNlc3Npb25fdG9rZW4iLCJnZXRTZXNzaW9uQnlUb2tlbiIsInNlc3Npb25Ub2tlbiIsImRlbGV0ZVNlc3Npb24iLCJkZWxldGVVc2VyU2Vzc2lvbnMiLCJkZWxldGVFeHBpcmVkU2Vzc2lvbnMiLCJjcmVhdGVDb21tZW50IiwiY29udGVudCIsImF1dGhvcklkIiwiZ2V0Q29tbWVudHNCeVRhc2tJZCIsInVwZGF0ZUNvbW1lbnQiLCJkZWxldGVDb21tZW50IiwiY3JlYXRlVGFnIiwiZ2V0VGFnc0J5UHJvamVjdElkIiwiYWRkVGFnVG9UYXNrIiwidGFnSWQiLCJyZW1vdmVUYWdGcm9tVGFzayIsImdldFRhZ3NCeVRhc2tJZCIsImdldEluc3RhbmNlIiwicHJvY2VzcyIsImVudiIsIkRCX0hPU1QiLCJEQl9QT1JUIiwiREJfTkFNRSIsIkRCX1VTRVIiLCJEQl9QQVNTV09SRCIsImRiQWRhcHRlciIsImdldFBvc3RncmVTUUxBZGFwdGVyIiwiREJfU1NMIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/postgresql-adapter.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "better-sqlite3":
/*!*********************************!*\
  !*** external "better-sqlite3" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("better-sqlite3");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = import("pg");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/bcryptjs"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CProjects%5Cencore-tasks%5Cencore-tasks-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();