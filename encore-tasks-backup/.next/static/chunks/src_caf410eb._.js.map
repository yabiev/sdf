{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nexport function formatDate(date: Date): string {\n  if (!date || isNaN(date.getTime())) {\n    return 'Неверная дата';\n  }\n  return new Intl.DateTimeFormat(\"ru-RU\", {\n    day: \"2-digit\",\n    month: \"2-digit\",\n    year: \"numeric\"\n  }).format(date);\n}\n\nexport function formatDateTime(date: Date): string {\n  if (!date || isNaN(date.getTime())) {\n    return 'Неверная дата';\n  }\n  return new Intl.DateTimeFormat(\"ru-RU\", {\n    day: \"2-digit\",\n    month: \"2-digit\",\n    year: \"numeric\",\n    hour: \"2-digit\",\n    minute: \"2-digit\"\n  }).format(date);\n}\n\nexport function isOverdue(date: Date): boolean {\n  if (!date || isNaN(date.getTime())) {\n    return false;\n  }\n  return date < new Date();\n}\n\nexport function getDaysUntilDeadline(date: Date): number {\n  if (!date || isNaN(date.getTime())) {\n    return 0;\n  }\n  const today = new Date();\n  const deadline = new Date(date);\n  const diffTime = deadline.getTime() - today.getTime();\n  return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n}\n\nexport function getInitials(name: string): string {\n  return name.\n  split(\" \").\n  map((word) => word.charAt(0)).\n  join(\"\").\n  toUpperCase().\n  slice(0, 2);\n}\n\nexport function generateId(): string {\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}"],"names":[],"mappings":";;;;;;;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,wIAAA,CAAA,OAAI,AAAD,EAAE;AACtB;AAEO,SAAS,WAAW,IAAU;IACnC,IAAI,CAAC,QAAQ,MAAM,KAAK,OAAO,KAAK;QAClC,OAAO;IACT;IACA,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QACtC,KAAK;QACL,OAAO;QACP,MAAM;IACR,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS,eAAe,IAAU;IACvC,IAAI,CAAC,QAAQ,MAAM,KAAK,OAAO,KAAK;QAClC,OAAO;IACT;IACA,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QACtC,KAAK;QACL,OAAO;QACP,MAAM;QACN,MAAM;QACN,QAAQ;IACV,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS,UAAU,IAAU;IAClC,IAAI,CAAC,QAAQ,MAAM,KAAK,OAAO,KAAK;QAClC,OAAO;IACT;IACA,OAAO,OAAO,IAAI;AACpB;AAEO,SAAS,qBAAqB,IAAU;IAC7C,IAAI,CAAC,QAAQ,MAAM,KAAK,OAAO,KAAK;QAClC,OAAO;IACT;IACA,MAAM,QAAQ,IAAI;IAClB,MAAM,WAAW,IAAI,KAAK;IAC1B,MAAM,WAAW,SAAS,OAAO,KAAK,MAAM,OAAO;IACnD,OAAO,KAAK,IAAI,CAAC,WAAW,CAAC,OAAO,KAAK,KAAK,EAAE;AAClD;AAEO,SAAS,YAAY,IAAY;IACtC,OAAO,KACP,KAAK,CAAC,KACN,GAAG,CAAC,CAAC,OAAS,KAAK,MAAM,CAAC,IAC1B,IAAI,CAAC,IACL,WAAW,GACX,KAAK,CAAC,GAAG;AACX;AAEO,SAAS;IACd,OAAO,GAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,MAAM,CAAC,GAAG,IAAI;AACnE","debugId":null}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/lib/api.ts"],"sourcesContent":["// API клиент для работы с бэкендом\n\ninterface ApiResponse<T> {\n  data?: T;\n  error?: string;\n  message?: string;\n}\n\nclass ApiClient {\n  private baseUrl: string;\n  private csrfToken: string | null = null;\n\n  constructor() {\n    this.baseUrl = process.env.NEXT_PUBLIC_API_URL || '';\n    this.initializeCSRF();\n  }\n\n  private async initializeCSRF(): Promise<void> {\n    try {\n      // Get CSRF token from server\n      const response = await fetch(`${this.baseUrl}/api/csrf`, {\n        credentials: 'include'\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        this.csrfToken = data.csrfToken;\n      }\n    } catch (error) {\n      console.warn('Failed to initialize CSRF token:', error);\n    }\n  }\n\n  private getAuthToken(): string | null {\n    if (typeof window === 'undefined') return null;\n    \n    // Используем только cookie для безопасности (защита от XSS)\n    const cookies = document.cookie.split(';');\n    const authCookie = cookies.find(cookie => cookie.trim().startsWith('auth-token-client='));\n    if (authCookie) {\n      return authCookie.split('=')[1];\n    }\n    \n    return null;\n  }\n\n  private getCSRFToken(): string | null {\n    if (typeof document !== 'undefined') {\n      const cookies = document.cookie.split(';');\n      const csrfCookie = cookies.find(cookie => \n        cookie.trim().startsWith('csrf-token=')\n      );\n      if (csrfCookie) {\n        return csrfCookie.split('=')[1];\n      }\n    }\n    return this.csrfToken;\n  }\n\n  private setAuthToken(token: string): void {\n    // Токен устанавливается сервером через httpOnly cookie\n    // Клиентская установка не требуется для безопасности\n    // localStorage больше не используется для предотвращения XSS атак\n  }\n\n  private removeAuthToken(): void {\n    // Токен удаляется сервером через API logout\n    // localStorage больше не используется для предотвращения XSS атак\n  }\n\n  private async request<T>(\n    endpoint: string,\n    options: RequestInit = {},\n    retries: number = 3\n  ): Promise<ApiResponse<T>> {\n    const url = `${this.baseUrl}/api${endpoint}`;\n    \n    for (let attempt = 0; attempt <= retries; attempt++) {\n      try {\n        const token = this.getAuthToken();\n        \n        const headers: Record<string, string> = {\n          'Content-Type': 'application/json',\n          'X-Requested-With': 'XMLHttpRequest', // CSRF protection\n          ...options.headers as Record<string, string>,\n        };\n\n        if (token) {\n          headers['Authorization'] = `Bearer ${token}`;\n        }\n\n        // Add CSRF token for state-changing requests\n        if (['POST', 'PUT', 'DELETE', 'PATCH'].includes(options.method?.toUpperCase() || 'GET')) {\n          const csrfToken = this.getCSRFToken();\n          if (csrfToken) {\n            headers['X-CSRF-Token'] = csrfToken;\n          }\n        }\n        \n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), 30000); // 30s timeout\n        \n        const response = await fetch(url, {\n          headers,\n          credentials: 'include', // Для работы с cookies\n          signal: controller.signal,\n          ...options,\n        });\n        \n        clearTimeout(timeoutId);\n\n        // Handle different response types\n        let data;\n        const contentType = response.headers.get('content-type');\n        if (contentType && contentType.includes('application/json')) {\n          data = await response.json();\n        } else {\n          data = { message: await response.text() };\n        }\n\n        if (!response.ok) {\n          // Handle specific HTTP errors\n          if (response.status === 401) {\n            // Unauthorized - just return error, don't redirect\n            // The AuthModal will handle showing login form\n            return { error: 'Сессия истекла. Необходимо войти в систему заново.' };\n          }\n          \n          if (response.status === 403) {\n            return { error: 'Недостаточно прав для выполнения операции' };\n          }\n          \n          if (response.status === 429) {\n            // Rate limiting - wait and retry\n            if (attempt < retries) {\n              await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempt) * 1000));\n              continue;\n            }\n            return { error: 'Слишком много запросов. Попробуйте позже.' };\n          }\n          \n          if (response.status >= 500) {\n            // Server error - retry\n            if (attempt < retries) {\n              await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempt) * 1000));\n              continue;\n            }\n            return { error: 'Ошибка сервера. Попробуйте позже.' };\n          }\n          \n          return { error: data.error || `HTTP ${response.status}: ${response.statusText}` };\n        }\n\n        return { data };\n        \n      } catch (error) {\n        console.error(`API Error (attempt ${attempt + 1}):`, error);\n        \n        // Handle specific error types\n        if (error instanceof TypeError && error.message.includes('fetch')) {\n          if (attempt < retries) {\n            await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempt) * 1000));\n            continue;\n          }\n          return { error: 'Ошибка сети. Проверьте подключение к интернету.' };\n        }\n        \n        if (error instanceof Error && error.name === 'AbortError') {\n          return { error: 'Запрос прерван по таймауту' };\n        }\n        \n        if (attempt < retries) {\n          await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempt) * 1000));\n          continue;\n        }\n        \n        return { error: 'Произошла неожиданная ошибка' };\n      }\n    }\n    \n    return { error: 'Максимальное количество попыток исчерпано' };\n  }\n\n  // Методы аутентификации\n  async login(email: string, password: string) {\n    const response = await this.request<{ user: any; token: string }>('/auth/login', {\n      method: 'POST',\n      body: JSON.stringify({ email, password }),\n    });\n    \n    // Сохраняем токен при успешном логине\n    if (response.data?.token) {\n      this.setAuthToken(response.data.token);\n    }\n    \n    return response;\n  }\n\n  async register(name: string, email: string, password: string) {\n    const response = await this.request<{ user: any; token: string }>('/auth/register', {\n      method: 'POST',\n      body: JSON.stringify({ name, email, password }),\n    });\n    \n    // Сохраняем токен при успешной регистрации\n    if (response.data?.token) {\n      this.setAuthToken(response.data.token);\n    }\n    \n    return response;\n  }\n\n  async logout() {\n    const response = await this.request('/auth/logout', {\n      method: 'POST',\n    });\n    \n    // Удаляем токен при выходе\n    this.removeAuthToken();\n    \n    return response;\n  }\n\n  async getCurrentUser() {\n    return this.request<{ user: any }>('/auth/me');\n  }\n\n  // Методы для работы с пользователями\n  async getUsers(params?: {\n    status?: string;\n    projectId?: string;\n    includeStats?: boolean;\n  }) {\n    const searchParams = new URLSearchParams();\n    if (params?.status) searchParams.set('status', params.status);\n    if (params?.projectId) searchParams.set('projectId', params.projectId);\n    if (params?.includeStats) searchParams.set('includeStats', 'true');\n    \n    const query = searchParams.toString();\n    return this.request<{ users: any[] }>(`/users${query ? `?${query}` : ''}`);\n  }\n\n  async createUser(userData: {\n    name: string;\n    email: string;\n    password: string;\n    role?: string;\n    status?: string;\n  }) {\n    return this.request<{ user: any }>('/users', {\n      method: 'POST',\n      body: JSON.stringify(userData),\n    });\n  }\n\n  async updateUser(userId: string, updateData: {\n    role?: string;\n    status?: string;\n  }) {\n    return this.request<{ user: any }>(`/users/${userId}`, {\n      method: 'PUT',\n      body: JSON.stringify(updateData),\n    });\n  }\n\n  async deleteUser(userId: string) {\n    return this.request(`/users/${userId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  // Методы для работы с проектами\n  async getProjects() {\n    return this.request<{ projects: any[] }>('/projects');\n  }\n\n  async createProject(projectData: {\n    name: string;\n    description?: string;\n    color?: string;\n    isPrivate?: boolean;\n  }) {\n    return this.request<{ project: any }>('/projects', {\n      method: 'POST',\n      body: JSON.stringify(projectData),\n    });\n  }\n\n  async updateProject(projectId: string, updateData: {\n    name?: string;\n    description?: string;\n    color?: string;\n    status?: string;\n  }) {\n    return this.request<{ project: any }>(`/projects/${projectId}`, {\n      method: 'PUT',\n      body: JSON.stringify(updateData),\n    });\n  }\n\n  async deleteProject(projectId: string) {\n    return this.request(`/projects/${projectId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  // Методы для работы с досками\n  async getBoards(projectId?: string, params?: {\n    includeArchived?: boolean;\n    sortBy?: string;\n    sortOrder?: 'asc' | 'desc';\n  }) {\n    const searchParams = new URLSearchParams();\n    if (projectId) searchParams.set('projectId', projectId);\n    if (params?.includeArchived) searchParams.set('includeArchived', 'true');\n    if (params?.sortBy) searchParams.set('sortBy', params.sortBy);\n    if (params?.sortOrder) searchParams.set('sortOrder', params.sortOrder);\n    \n    const query = searchParams.toString();\n    return this.request<{ boards: any[] }>(`/boards${query ? `?${query}` : ''}`);\n  }\n\n  async createBoard(boardData: {\n    name: string;\n    description?: string;\n    projectId: string;\n    visibility?: 'public' | 'private';\n    color?: string;\n    allowComments?: boolean;\n    allowAttachments?: boolean;\n    autoArchive?: boolean;\n  }) {\n    return this.request<{ board: any }>('/boards', {\n      method: 'POST',\n      body: JSON.stringify(boardData),\n    });\n  }\n\n  async deleteBoard(boardId: string) {\n    return this.request(`/boards?boardId=${boardId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  // Методы для работы с колонками\n  async getColumns(boardId: string, params?: {\n    includeArchived?: boolean;\n    sortBy?: string;\n    sortOrder?: 'asc' | 'desc';\n  }) {\n    const searchParams = new URLSearchParams();\n    searchParams.set('boardId', boardId);\n    if (params?.includeArchived) searchParams.set('includeArchived', 'true');\n    if (params?.sortBy) searchParams.set('sortBy', params.sortBy);\n    if (params?.sortOrder) searchParams.set('sortOrder', params.sortOrder);\n    \n    const query = searchParams.toString();\n    return this.request<{ columns: any[] }>(`/columns?${query}`);\n  }\n\n  async createColumn(columnData: {\n    title: string;\n    boardId: string;\n    color?: string;\n    wipLimit?: number;\n    isCollapsed?: boolean;\n    autoMoveRules?: {\n      enabled: boolean;\n      conditions: any[];\n      targetColumnId?: string;\n    };\n    notifications?: {\n      onTaskAdded: boolean;\n      onTaskMoved: boolean;\n      onWipLimitExceeded: boolean;\n    };\n    taskTemplate?: {\n      enabled: boolean;\n      defaultTitle?: string;\n      defaultDescription?: string;\n      defaultPriority?: string;\n      defaultTags?: string[];\n    };\n  }) {\n    return this.request<{ column: any }>('/columns', {\n      method: 'POST',\n      body: JSON.stringify(columnData),\n    });\n  }\n\n  async updateColumnsOrder(boardId: string, columnOrders: Record<string, number>) {\n    return this.request('/columns', {\n      method: 'PUT',\n      body: JSON.stringify({ boardId, columnOrders }),\n    });\n  }\n\n  // Методы для работы с задачами\n  async getTasks(params?: {\n    columnId?: string;\n    projectId?: string;\n    boardId?: string;\n    status?: string;\n    assigneeId?: string;\n    priority?: string;\n    includeArchived?: boolean;\n    sortBy?: string;\n    sortOrder?: 'asc' | 'desc';\n    page?: number;\n    limit?: number;\n  }) {\n    const searchParams = new URLSearchParams();\n    if (params?.columnId) searchParams.set('columnId', params.columnId);\n    if (params?.projectId) searchParams.set('projectId', params.projectId);\n    if (params?.boardId) searchParams.set('boardId', params.boardId);\n    if (params?.status) searchParams.set('status', params.status);\n    if (params?.assigneeId) searchParams.set('assigneeId', params.assigneeId);\n    if (params?.priority) searchParams.set('priority', params.priority);\n    if (params?.includeArchived) searchParams.set('includeArchived', 'true');\n    if (params?.sortBy) searchParams.set('sortBy', params.sortBy);\n    if (params?.sortOrder) searchParams.set('sortOrder', params.sortOrder);\n    if (params?.page) searchParams.set('page', params.page.toString());\n    if (params?.limit) searchParams.set('limit', params.limit.toString());\n    \n    const query = searchParams.toString();\n    return this.request<{ tasks: any[] }>(`/tasks${query ? `?${query}` : ''}`);\n  }\n\n  async getTask(taskId: string) {\n    return this.request<{ task: any }>(`/tasks/${taskId}`);\n  }\n\n  async createTask(taskData: {\n    title: string;\n    description?: string;\n    status?: string;\n    priority?: string;\n    assigneeId?: string;\n    columnId: string;\n    position?: number;\n    dueDate?: string;\n    estimatedHours?: number;\n    tags?: string[];\n  }) {\n    return this.request<{ task: any }>('/tasks', {\n      method: 'POST',\n      body: JSON.stringify(taskData),\n    });\n  }\n\n  async updateTask(taskId: string, updateData: {\n    title?: string;\n    description?: string;\n    status?: string;\n    priority?: string;\n    position?: number;\n    storyPoints?: number;\n    estimatedHours?: number;\n    actualHours?: number;\n    deadline?: string;\n    columnId?: string;\n    parentTaskId?: string;\n    isArchived?: boolean;\n    assigneeIds?: string[];\n    tags?: string[];\n  }) {\n    return this.request<{ task: any }>(`/tasks/${taskId}`, {\n      method: 'PUT',\n      body: JSON.stringify(updateData),\n    });\n  }\n\n  async deleteTask(taskId: string) {\n    return this.request(`/tasks/${taskId}`, {\n      method: 'DELETE',\n    });\n  }\n}\n\n// Экспорт единственного экземпляра API клиента\nexport const api = new ApiClient();\n\n// Типы для TypeScript\nexport interface User {\n  id: string;\n  name: string;\n  email: string;\n  role: 'admin' | 'user';\n  status: 'active' | 'pending' | 'suspended';\n  approval_status?: 'pending' | 'approved' | 'rejected';\n  avatar?: string;\n  createdAt: string;\n  updatedAt: string;\n  lastLoginAt?: string;\n  stats?: {\n    assignedTasksCount: number;\n    createdTasksCount: number;\n    createdProjectsCount: number;\n  };\n}\n\nexport interface Project {\n  id: string;\n  name: string;\n  description?: string;\n  color: string;\n  isPrivate: boolean;\n  isArchived: boolean;\n  archivedAt?: string;\n  createdBy: string;\n  creatorName: string;\n  membersCount: number;\n  tasksCount: number;\n  boardsCount: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface Board {\n  id: string;\n  name: string;\n  description?: string;\n  position: number;\n  isArchived: boolean;\n  archivedAt?: string;\n  projectId: string;\n  projectName: string;\n  projectColor: string;\n  tasksCount: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface Column {\n  id: string;\n  title: string;\n  color: string;\n  position: number;\n  isArchived: boolean;\n  archivedAt?: string;\n  boardId: string;\n  boardName: string;\n  projectName: string;\n  tasksCount: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface Task {\n  id: string;\n  title: string;\n  description?: string;\n  status: 'todo' | 'in_progress' | 'review' | 'done';\n  priority: 'low' | 'medium' | 'high' | 'urgent';\n  position: number;\n  storyPoints?: number;\n  estimatedHours?: number;\n  actualHours?: number;\n  deadline?: string;\n  startedAt?: string;\n  completedAt?: string;\n  isArchived: boolean;\n  archivedAt?: string;\n  projectId: string;\n  projectName: string;\n  projectColor: string;\n  boardId: string;\n  boardName: string;\n  columnId?: string;\n  columnTitle?: string;\n  columnColor?: string;\n  reporterId: string;\n  reporterName: string;\n  parentTaskId?: string;\n  parentTaskTitle?: string;\n  assignees: User[];\n  tags: { id: string; name: string; color: string }[];\n  commentsCount: number;\n  attachmentsCount: number;\n  createdAt: string;\n  updatedAt: string;\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 429, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/lib/auth-api.ts"],"sourcesContent":["import { \n  User, \n  LoginDto, \n  RegisterDto, \n  UpdateProfileDto, \n  ChangePasswordDto, \n  AuthResponse,\n  AuthError,\n  AUTH_ERROR_CODES\n} from '@/types/auth.types';\n\n// Базовый URL API\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || '/api';\n\n// Утилита для обработки ответов API\nclass ApiResponse {\n  constructor(\n    public success: boolean,\n    public data?: any,\n    public error?: string,\n    public code?: string\n  ) {}\n\n  static success(data: any): ApiResponse {\n    return new ApiResponse(true, data);\n  }\n\n  static error(message: string, code?: string): ApiResponse {\n    return new ApiResponse(false, undefined, message, code);\n  }\n}\n\n// Утилита для HTTP запросов\nclass HttpClient {\n  private baseUrl: string;\n\n  constructor(baseUrl: string) {\n    this.baseUrl = baseUrl;\n  }\n\n  private async request<T>(\n    endpoint: string,\n    options: RequestInit = {}\n  ): Promise<T> {\n    const url = `${this.baseUrl}${endpoint}`;\n    \n    const config: RequestInit = {\n      credentials: 'include', // Включаем cookies\n      headers: {\n        'Content-Type': 'application/json',\n        ...options.headers,\n      },\n      ...options,\n    };\n\n    try {\n      const response = await fetch(url, config);\n      \n      // Проверяем статус ответа\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        \n        // Обрабатываем различные типы ошибок\n        switch (response.status) {\n          case 401:\n            throw new AuthError(\n              errorData.message || 'Неверные учетные данные',\n              AUTH_ERROR_CODES.INVALID_CREDENTIALS\n            );\n          case 403:\n            throw new AuthError(\n              errorData.message || 'Доступ запрещен',\n              AUTH_ERROR_CODES.ACCESS_DENIED\n            );\n          case 404:\n            throw new AuthError(\n              errorData.message || 'Пользователь не найден',\n              AUTH_ERROR_CODES.USER_NOT_FOUND\n            );\n          case 409:\n            throw new AuthError(\n              errorData.message || 'Пользователь уже существует',\n              AUTH_ERROR_CODES.USER_ALREADY_EXISTS\n            );\n          case 422:\n            throw new AuthError(\n              errorData.message || 'Неверные данные',\n              AUTH_ERROR_CODES.VALIDATION_ERROR\n            );\n          case 429:\n            throw new AuthError(\n              'Слишком много попыток. Попробуйте позже',\n              AUTH_ERROR_CODES.RATE_LIMIT_EXCEEDED\n            );\n          case 500:\n            throw new AuthError(\n              'Внутренняя ошибка сервера',\n              AUTH_ERROR_CODES.SERVER_ERROR\n            );\n          default:\n            throw new AuthError(\n              errorData.message || 'Произошла ошибка',\n              AUTH_ERROR_CODES.UNKNOWN_ERROR\n            );\n        }\n      }\n\n      const data = await response.json();\n      return data;\n    } catch (error) {\n      if (error instanceof AuthError) {\n        throw error;\n      }\n      \n      // Обрабатываем сетевые ошибки\n      if (error instanceof TypeError && error.message.includes('fetch')) {\n        throw new AuthError(\n          'Ошибка сети. Проверьте подключение к интернету',\n          AUTH_ERROR_CODES.NETWORK_ERROR\n        );\n      }\n      \n      throw new AuthError(\n        'Произошла неожиданная ошибка',\n        AUTH_ERROR_CODES.UNKNOWN_ERROR\n      );\n    }\n  }\n\n  async get<T>(endpoint: string, headers?: Record<string, string>): Promise<T> {\n    return this.request<T>(endpoint, { method: 'GET', headers });\n  }\n\n  async post<T>(\n    endpoint: string,\n    data?: any,\n    headers?: Record<string, string>\n  ): Promise<T> {\n    return this.request<T>(endpoint, {\n      method: 'POST',\n      body: data ? JSON.stringify(data) : undefined,\n      headers,\n    });\n  }\n\n  async put<T>(\n    endpoint: string,\n    data?: any,\n    headers?: Record<string, string>\n  ): Promise<T> {\n    return this.request<T>(endpoint, {\n      method: 'PUT',\n      body: data ? JSON.stringify(data) : undefined,\n      headers,\n    });\n  }\n\n  async delete<T>(endpoint: string, headers?: Record<string, string>): Promise<T> {\n    return this.request<T>(endpoint, { method: 'DELETE', headers });\n  }\n}\n\n// API клиент для аутентификации\nclass AuthApiClient {\n  private http: HttpClient;\n\n  constructor() {\n    this.http = new HttpClient(API_BASE_URL);\n  }\n\n  // Вход в систему\n  async login(credentials: LoginDto): Promise<AuthResponse> {\n    try {\n      const response = await this.http.post<{\n        success: boolean;\n        user: User;\n        message?: string;\n      }>('/auth/login', credentials);\n\n      if (!response.success || !response.user) {\n        throw new AuthError(\n          'Неверный ответ сервера',\n          AUTH_ERROR_CODES.SERVER_ERROR\n        );\n      }\n\n      return {\n        user: response.user,\n        message: response.message || 'Успешный вход'\n      };\n    } catch (error) {\n      console.error('Login error:', error);\n      throw error;\n    }\n  }\n\n  // Регистрация\n  async register(userData: RegisterDto): Promise<{ success: boolean; message: string }> {\n    try {\n      const response = await this.http.post<{\n        success: boolean;\n        message: string;\n      }>('/auth/register', userData);\n\n      return response;\n    } catch (error) {\n      console.error('Registration error:', error);\n      throw error;\n    }\n  }\n\n  // Выход из системы\n  async logout(): Promise<{ success: boolean; message: string }> {\n    try {\n      const response = await this.http.post<{\n        success: boolean;\n        message: string;\n      }>('/auth/logout');\n\n      return response;\n    } catch (error) {\n      console.error('Logout error:', error);\n      throw error;\n    }\n  }\n\n  // Получение текущего пользователя\n  async getCurrentUser(): Promise<User | null> {\n    try {\n      const response = await this.http.get<{\n        success: boolean;\n        user?: User;\n      }>('/auth/me');\n\n      return response.user || null;\n    } catch (error) {\n      // Если пользователь не аутентифицирован, возвращаем null\n      if (error instanceof AuthError && \n          (error.code === AUTH_ERROR_CODES.INVALID_CREDENTIALS ||\n           error.code === AUTH_ERROR_CODES.ACCESS_DENIED)) {\n        return null;\n      }\n      \n      console.error('Get current user error:', error);\n      throw error;\n    }\n  }\n\n  // Обновление профиля\n  async updateProfile(data: UpdateProfileDto): Promise<User> {\n    try {\n      const response = await this.http.put<{\n        success: boolean;\n        user: User;\n      }>('/auth/profile', data);\n\n      if (!response.success || !response.user) {\n        throw new AuthError(\n          'Ошибка обновления профиля',\n          AUTH_ERROR_CODES.SERVER_ERROR\n        );\n      }\n\n      return response.user;\n    } catch (error) {\n      console.error('Update profile error:', error);\n      throw error;\n    }\n  }\n\n  // Смена пароля\n  async changePassword(data: ChangePasswordDto): Promise<{ success: boolean; message: string }> {\n    try {\n      const response = await this.http.put<{\n        success: boolean;\n        message: string;\n      }>('/auth/password', data);\n\n      return response;\n    } catch (error) {\n      console.error('Change password error:', error);\n      throw error;\n    }\n  }\n\n  // Обновление токена\n  async refreshToken(): Promise<AuthResponse | null> {\n    try {\n      const response = await this.http.post<{\n        success: boolean;\n        user?: User;\n        message?: string;\n      }>('/auth/refresh');\n\n      if (!response.success || !response.user) {\n        return null;\n      }\n\n      return {\n        user: response.user,\n        message: response.message || 'Токен обновлен'\n      };\n    } catch (error) {\n      console.error('Refresh token error:', error);\n      return null;\n    }\n  }\n\n  // Запрос сброса пароля\n  async requestPasswordReset(email: string): Promise<{ success: boolean; message: string }> {\n    try {\n      const response = await this.http.post<{\n        success: boolean;\n        message: string;\n      }>('/auth/password-reset-request', { email });\n\n      return response;\n    } catch (error) {\n      console.error('Password reset request error:', error);\n      throw error;\n    }\n  }\n\n  // Сброс пароля\n  async resetPassword(\n    token: string,\n    newPassword: string\n  ): Promise<{ success: boolean; message: string }> {\n    try {\n      const response = await this.http.post<{\n        success: boolean;\n        message: string;\n      }>('/auth/password-reset', { token, newPassword });\n\n      return response;\n    } catch (error) {\n      console.error('Password reset error:', error);\n      throw error;\n    }\n  }\n\n  // Подтверждение email\n  async verifyEmail(token: string): Promise<{ success: boolean; message: string }> {\n    try {\n      const response = await this.http.post<{\n        success: boolean;\n        message: string;\n      }>('/auth/verify-email', { token });\n\n      return response;\n    } catch (error) {\n      console.error('Email verification error:', error);\n      throw error;\n    }\n  }\n\n  // Повторная отправка письма подтверждения\n  async resendVerificationEmail(): Promise<{ success: boolean; message: string }> {\n    try {\n      const response = await this.http.post<{\n        success: boolean;\n        message: string;\n      }>('/auth/resend-verification');\n\n      return response;\n    } catch (error) {\n      console.error('Resend verification error:', error);\n      throw error;\n    }\n  }\n}\n\n// Экспортируем единственный экземпляр\nexport const authApi = new AuthApiClient();\n\n// Экспортируем класс для тестирования\nexport { AuthApiClient };"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 692, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/lib/postgresql-adapter.ts"],"sourcesContent":["import { Pool, PoolClient } from 'pg';\nimport bcrypt from 'bcryptjs';\nimport { User, Project, Board, Column, Task, Comment, Attachment, Tag, Session } from '../types';\n\n// Интерфейс для конфигурации базы данных\ninterface DatabaseConfig {\n  host: string;\n  port: number;\n  database: string;\n  user: string;\n  password: string;\n  ssl?: boolean;\n}\n\n// Класс для работы с PostgreSQL\nexport class PostgreSQLAdapter {\n  private static instance: PostgreSQLAdapter | null = null;\n  private pool: Pool;\n  private isInitialized = false;\n\n  constructor(config: DatabaseConfig) {\n    this.pool = new Pool({\n      host: config.host,\n      port: config.port,\n      database: config.database,\n      user: config.user,\n      password: config.password,\n      ssl: config.ssl ? { rejectUnauthorized: false } : false,\n      max: 20, // максимальное количество соединений в пуле\n      idleTimeoutMillis: 30000,\n      connectionTimeoutMillis: 2000,\n    });\n  }\n\n  // Инициализация базы данных\n  async initialize(): Promise<void> {\n    if (this.isInitialized) return;\n\n    try {\n      const client = await this.pool.connect();\n      \n      // Проверяем подключение\n      await client.query('SELECT NOW()');\n      \n      console.log('✅ PostgreSQL подключение установлено');\n      client.release();\n      \n      this.isInitialized = true;\n    } catch (error) {\n      console.error('❌ Ошибка подключения к PostgreSQL:', error);\n      throw error;\n    }\n  }\n\n  // Закрытие пула соединений\n  async close(): Promise<void> {\n    await this.pool.end();\n    this.isInitialized = false;\n  }\n\n  // Получение клиента для транзакций\n  async getClient(): Promise<PoolClient> {\n    return await this.pool.connect();\n  }\n\n  // Выполнение запроса\n  async query(text: string, params?: any[]): Promise<any> {\n    const client = await this.pool.connect();\n    try {\n      console.log('SQL Query:', text);\n      console.log('SQL Params:', params);\n      const result = await client.query(text, params);\n      return result;\n    } finally {\n      client.release();\n    }\n  }\n\n  // === МЕТОДЫ ДЛЯ ПОЛЬЗОВАТЕЛЕЙ ===\n\n  async createUser(email: string, password: string, name: string, role: string = 'user'): Promise<User> {\n    const hashedPassword = await bcrypt.hash(password, 12);\n    const result = await this.query(\n      `INSERT INTO users (email, password_hash, name, role, approval_status) \n       VALUES ($1, $2, $3, $4, $5) \n       RETURNING *`,\n      [email, hashedPassword, name, role, 'pending']\n    );\n    return result.rows[0];\n  }\n\n  async getUserByEmail(email: string): Promise<User | null> {\n    const result = await this.query(\n      'SELECT * FROM users WHERE email = $1 AND deleted_at IS NULL',\n      [email]\n    );\n    return result.rows[0] || null;\n  }\n\n  async getUserById(id: string): Promise<User | null> {\n    const result = await this.query(\n      'SELECT * FROM users WHERE id = $1 AND deleted_at IS NULL',\n      [id]\n    );\n    const row = result.rows[0];\n    if (!row) return null;\n    \n    // Маппинг полей базы данных в User интерфейс\n    return {\n      id: row.id,\n      userId: row.id, // Добавляем userId для совместимости\n      name: row.name,\n      email: row.email,\n      role: row.role,\n      status: row.is_active ? 'active' : 'inactive',\n      approval_status: row.approval_status,\n      avatar: row.avatar,\n      createdAt: row.created_at,\n      updatedAt: row.updated_at,\n      lastLoginAt: row.last_login_at,\n      is_active: row.is_active,\n      created_at: row.created_at,\n      updated_at: row.updated_at,\n      last_login_at: row.last_login_at\n    };\n  }\n\n  async updateUser(id: string, updates: Partial<User>): Promise<User | null> {\n    const fields = Object.keys(updates).filter(key => key !== 'id');\n    const values = fields.map(field => updates[field as keyof User]);\n    const setClause = fields.map((field, index) => `${field} = $${index + 2}`).join(', ');\n    \n    if (fields.length === 0) {\n      return await this.getUserById(id);\n    }\n\n    const result = await this.query(\n      `UPDATE users SET ${setClause} WHERE id = $1 RETURNING *`,\n      [id, ...values]\n    );\n    return result.rows[0] || null;\n  }\n\n  async getAllUsers(): Promise<User[]> {\n    const result = await this.query(\n      'SELECT * FROM users WHERE deleted_at IS NULL ORDER BY created_at DESC'\n    );\n    return result.rows;\n  }\n\n  async deleteUser(id: string): Promise<boolean> {\n    const result = await this.query(\n      'UPDATE users SET deleted_at = CURRENT_TIMESTAMP WHERE id = $1',\n      [id]\n    );\n    return result.rowCount > 0;\n  }\n\n  // === МЕТОДЫ ДЛЯ ПРОЕКТОВ ===\n\n  async createProject(name: string, description: string, ownerId: string, color?: string): Promise<Project> {\n    const result = await this.query(\n      `INSERT INTO projects (name, description, creator_id, color)\n     VALUES ($1, $2, $3, $4) RETURNING *`,\n      [name, description, ownerId, color || '#3B82F6']\n    );\n    return result.rows[0];\n  }\n\n  async getProjectById(id: string): Promise<Project | null> {\n    const result = await this.query(\n      'SELECT * FROM projects WHERE id = $1 AND deleted_at IS NULL',\n      [id]\n    );\n    return result.rows[0] || null;\n  }\n\n  async getProjectsByUserId(userId: string): Promise<Project[]> {\n    const result = await this.query(\n      `SELECT DISTINCT p.* FROM projects p \n       LEFT JOIN project_members pm ON p.id = pm.project_id \n       WHERE (p.creator_id = $1 OR pm.user_id = $1) AND p.deleted_at IS NULL \n       ORDER BY p.created_at DESC`,\n      [userId]\n    );\n    return result.rows;\n  }\n\n  async getAllProjects(): Promise<Project[]> {\n    const result = await this.query(\n      'SELECT * FROM projects WHERE deleted_at IS NULL ORDER BY created_at DESC'\n    );\n    return result.rows;\n  }\n\n  async updateProject(id: string, updates: Partial<Project>): Promise<Project | null> {\n    const fields = Object.keys(updates).filter(key => key !== 'id');\n    const values = fields.map(field => updates[field as keyof Project]);\n    const setClause = fields.map((field, index) => `${field} = $${index + 2}`).join(', ');\n    \n    if (fields.length === 0) {\n      return await this.getProjectById(id);\n    }\n\n    const result = await this.query(\n      `UPDATE projects SET ${setClause} WHERE id = $1 RETURNING *`,\n      [id, ...values]\n    );\n    return result.rows[0] || null;\n  }\n\n  async deleteProject(id: string): Promise<boolean> {\n    const result = await this.query(\n      'UPDATE projects SET deleted_at = CURRENT_TIMESTAMP WHERE id = $1',\n      [id]\n    );\n    return result.rowCount > 0;\n  }\n\n  async hasProjectAccess(userId: string, projectId: string): Promise<boolean> {\n    try {\n      // Проверяем, является ли пользователь владельцем проекта\n      const ownerResult = await this.query(\n        'SELECT creator_id FROM projects WHERE id = $1 AND deleted_at IS NULL',\n        [projectId]\n      );\n      \n      if (ownerResult.rows.length === 0) {\n        return false; // Проект не найден\n      }\n      \n      const projectOwner = ownerResult.rows[0].creator_id;\n      if (projectOwner === userId) {\n        return true; // Пользователь является владельцем\n      }\n      \n      // Проверяем членство в проекте\n      const memberResult = await this.query(\n        'SELECT 1 FROM project_members WHERE project_id = $1 AND user_id = $2',\n        [projectId, userId]\n      );\n      \n      return memberResult.rows.length > 0;\n    } catch (error) {\n      console.error('Error checking project access:', error);\n      return false;\n    }\n  }\n\n  // === МЕТОДЫ ДЛЯ ДОСОК ===\n\n  async createBoard(name: string, description: string, projectId: string): Promise<Board> {\n    const result = await this.query(\n      `INSERT INTO boards (name, project_id) \n       VALUES ($1, $2) \n       RETURNING *`,\n      [name, projectId]\n    );\n    return result.rows[0];\n  }\n\n  async getBoardById(id: string): Promise<Board | null> {\n    const result = await this.query(\n      'SELECT * FROM boards WHERE id = $1 AND deleted_at IS NULL',\n      [id]\n    );\n    return result.rows[0] || null;\n  }\n\n  async getBoardsByProjectId(projectId: string): Promise<Board[]> {\n    const result = await this.query(\n      'SELECT * FROM boards WHERE project_id = $1 AND deleted_at IS NULL ORDER BY position, created_at',\n      [projectId]\n    );\n    return result.rows;\n  }\n\n  async updateBoard(id: string, updates: Partial<Board>): Promise<Board | null> {\n    const fields = Object.keys(updates).filter(key => key !== 'id');\n    const values = fields.map(field => updates[field as keyof Board]);\n    const setClause = fields.map((field, index) => `${field} = $${index + 2}`).join(', ');\n    \n    if (fields.length === 0) {\n      return await this.getBoardById(id);\n    }\n\n    const result = await this.query(\n      `UPDATE boards SET ${setClause} WHERE id = $1 RETURNING *`,\n      [id, ...values]\n    );\n    return result.rows[0] || null;\n  }\n\n  async deleteBoard(id: string): Promise<boolean> {\n    const result = await this.query(\n      'UPDATE boards SET deleted_at = CURRENT_TIMESTAMP WHERE id = $1',\n      [id]\n    );\n    return result.rowCount > 0;\n  }\n\n  // === МЕТОДЫ ДЛЯ КОЛОНОК ===\n\n  async createColumn(name: string, boardId: string, position?: number, color?: string): Promise<Column> {\n\n    const result = await this.query(\n      `INSERT INTO columns (title, board_id, position, color) \n       VALUES ($1, $2, $3, $4) \n       RETURNING *`,\n      [name, boardId, position || 0, color || '#6B7280']\n    );\n    return result.rows[0];\n  }\n\n  async getColumnById(id: string): Promise<Column | null> {\n    const result = await this.query(\n      'SELECT * FROM columns WHERE id = $1 AND deleted_at IS NULL',\n      [id]\n    );\n    return result.rows[0] || null;\n  }\n\n  async getColumnsByBoardId(boardId: string): Promise<Column[]> {\n    const result = await this.query(\n      'SELECT * FROM columns WHERE board_id = $1 AND deleted_at IS NULL ORDER BY position, created_at',\n      [boardId]\n    );\n    return result.rows;\n  }\n\n  async updateColumn(id: string, updates: Partial<Column>): Promise<Column | null> {\n    const fields = Object.keys(updates).filter(key => key !== 'id');\n    const values = fields.map(field => updates[field as keyof Column]);\n    const setClause = fields.map((field, index) => `${field} = $${index + 2}`).join(', ');\n    \n    if (fields.length === 0) {\n      return await this.getColumnById(id);\n    }\n\n    const result = await this.query(\n      `UPDATE columns SET ${setClause} WHERE id = $1 RETURNING *`,\n      [id, ...values]\n    );\n    return result.rows[0] || null;\n  }\n\n  async deleteColumn(id: string): Promise<boolean> {\n    const result = await this.query(\n      'UPDATE columns SET deleted_at = CURRENT_TIMESTAMP WHERE id = $1',\n      [id]\n    );\n    return result.rowCount > 0;\n  }\n\n  // === МЕТОДЫ ДЛЯ ЗАДАЧ ===\n\n  async createTask(taskData: Partial<Task>): Promise<Task> {\n    const {\n      title,\n      description,\n      status = 'todo',\n      priority = 'medium',\n      project_id,\n      board_id,\n      column_id,\n      assignee_id,\n      reporter_id,\n      position = 0\n    } = taskData;\n\n    const result = await this.query(\n      `INSERT INTO tasks (title, description, status, priority, project_id, board_id, column_id, assignee_id, reporter_id, position) \n       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) \n       RETURNING *`,\n      [title, description, status, priority, project_id, board_id, column_id, assignee_id, reporter_id, position]\n    );\n    return result.rows[0];\n  }\n\n  async getTaskById(id: string): Promise<Task | null> {\n    const result = await this.query(\n      'SELECT * FROM tasks WHERE id = $1 AND deleted_at IS NULL',\n      [id]\n    );\n    return result.rows[0] || null;\n  }\n\n  async getTasksByProjectId(projectId: string): Promise<Task[]> {\n    const result = await this.query(\n      'SELECT * FROM tasks WHERE project_id = $1 AND deleted_at IS NULL ORDER BY position, created_at',\n      [projectId]\n    );\n    return result.rows;\n  }\n\n  async getTasksByColumnId(columnId: string): Promise<Task[]> {\n    const result = await this.query(\n      'SELECT * FROM tasks WHERE column_id = $1 AND deleted_at IS NULL ORDER BY position, created_at',\n      [columnId]\n    );\n    return result.rows;\n  }\n\n  async updateTask(id: string, updates: Partial<Task>): Promise<Task | null> {\n    const fields = Object.keys(updates).filter(key => key !== 'id');\n    const values = fields.map(field => updates[field as keyof Task]);\n    const setClause = fields.map((field, index) => `${field} = $${index + 2}`).join(', ');\n    \n    if (fields.length === 0) {\n      return await this.getTaskById(id);\n    }\n\n    const result = await this.query(\n      `UPDATE tasks SET ${setClause} WHERE id = $1 RETURNING *`,\n      [id, ...values]\n    );\n    return result.rows[0] || null;\n  }\n\n  async deleteTask(id: string): Promise<boolean> {\n    const result = await this.query(\n      'UPDATE tasks SET deleted_at = CURRENT_TIMESTAMP WHERE id = $1',\n      [id]\n    );\n    return result.rowCount > 0;\n  }\n\n  // === МЕТОДЫ ДЛЯ СЕССИЙ ===\n\n  async createSession(sessionToken: string, userId: string, expiresAt: Date): Promise<Session> {\n    \n    const result = await this.query(\n      `INSERT INTO user_sessions (session_token, user_id, expires_at)\n     VALUES ($1, $2, $3)\n     RETURNING *`,\n      [sessionToken, userId, expiresAt]\n    );\n    \n    const row = result.rows[0];\n    return {\n      id: row.id,\n      userId: row.user_id,\n      token: row.session_token,\n      expiresAt: new Date(row.expires_at),\n      isActive: true,\n      userAgent: row.user_agent,\n      ipAddress: row.ip_address,\n      lastActivityAt: new Date(row.last_activity_at || row.created_at),\n      createdAt: new Date(row.created_at),\n      updatedAt: new Date(row.updated_at || row.created_at)\n    };\n  }\n\n  async getSessionByToken(sessionToken: string): Promise<Session | null> {\n    const result = await this.query(\n      'SELECT * FROM user_sessions WHERE session_token = $1 AND expires_at > NOW()',\n      [sessionToken]\n    );\n    \n    if (!result.rows[0]) return null;\n    \n    const row = result.rows[0];\n    return {\n      id: row.id,\n      userId: row.user_id,\n      token: row.session_token,\n      expiresAt: new Date(row.expires_at),\n      isActive: true,\n      userAgent: row.user_agent,\n      ipAddress: row.ip_address,\n      lastActivityAt: new Date(row.last_activity_at || row.created_at),\n      createdAt: new Date(row.created_at),\n      updatedAt: new Date(row.updated_at || row.created_at)\n    };\n  }\n\n  async deleteSession(sessionToken: string): Promise<boolean> {\n    const result = await this.query(\n      'DELETE FROM user_sessions WHERE session_token = $1',\n      [sessionToken]\n    );\n    return result.rowCount > 0;\n  }\n\n  async deleteExpiredSessions(): Promise<number> {\n    const result = await this.query(\n      'DELETE FROM user_sessions WHERE expires_at <= NOW()'\n    );\n    return result.rowCount;\n  }\n\n  // === МЕТОДЫ ДЛЯ КОММЕНТАРИЕВ ===\n\n  async createComment(content: string, taskId: string, authorId: string): Promise<Comment> {\n    const result = await this.query(\n      `INSERT INTO comments (content, task_id, author_id) \n       VALUES ($1, $2, $3) \n       RETURNING *`,\n      [content, taskId, authorId]\n    );\n    return result.rows[0];\n  }\n\n  async getCommentsByTaskId(taskId: string): Promise<Comment[]> {\n    const result = await this.query(\n      'SELECT * FROM comments WHERE task_id = $1 AND deleted_at IS NULL ORDER BY created_at',\n      [taskId]\n    );\n    return result.rows;\n  }\n\n  async updateComment(id: string, content: string): Promise<Comment | null> {\n    const result = await this.query(\n      'UPDATE comments SET content = $2 WHERE id = $1 RETURNING *',\n      [id, content]\n    );\n    return result.rows[0] || null;\n  }\n\n  async deleteComment(id: string): Promise<boolean> {\n    const result = await this.query(\n      'UPDATE comments SET deleted_at = CURRENT_TIMESTAMP WHERE id = $1',\n      [id]\n    );\n    return result.rowCount > 0;\n  }\n\n  // === МЕТОДЫ ДЛЯ ТЕГОВ ===\n\n  async createTag(name: string, color: string, projectId?: string): Promise<Tag> {\n    const result = await this.query(\n      `INSERT INTO tags (name, color, project_id) \n       VALUES ($1, $2, $3) \n       RETURNING *`,\n      [name, color, projectId]\n    );\n    return result.rows[0];\n  }\n\n  async getTagsByProjectId(projectId: string): Promise<Tag[]> {\n    const result = await this.query(\n      'SELECT * FROM tags WHERE project_id = $1 ORDER BY name',\n      [projectId]\n    );\n    return result.rows;\n  }\n\n  async addTagToTask(taskId: string, tagId: string): Promise<boolean> {\n    try {\n      await this.query(\n        'INSERT INTO task_tags (task_id, tag_id) VALUES ($1, $2)',\n        [taskId, tagId]\n      );\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  async removeTagFromTask(taskId: string, tagId: string): Promise<boolean> {\n    const result = await this.query(\n      'DELETE FROM task_tags WHERE task_id = $1 AND tag_id = $2',\n      [taskId, tagId]\n    );\n    return result.rowCount > 0;\n  }\n\n  async getTagsByTaskId(taskId: string): Promise<Tag[]> {\n    const result = await this.query(\n      `SELECT t.* FROM tags t \n       JOIN task_tags tt ON t.id = tt.tag_id \n       WHERE tt.task_id = $1`,\n      [taskId]\n    );\n    return result.rows;\n  }\n\n  // Статический метод для получения экземпляра (Singleton)\n  static getInstance(): PostgreSQLAdapter {\n    if (!PostgreSQLAdapter.instance) {\n      const config: DatabaseConfig = {\n        host: process.env.DB_HOST || 'localhost',\n        port: parseInt(process.env.DB_PORT || '5432'),\n        database: process.env.DB_NAME || 'encore_tasks',\n        user: process.env.DB_USER || 'postgres',\n        password: process.env.DB_PASSWORD || 'password',\n        ssl: process.env.DB_SSL === 'true'\n      };\n      \n      PostgreSQLAdapter.instance = new PostgreSQLAdapter(config);\n    }\n    \n    return PostgreSQLAdapter.instance;\n  }\n}\n\n// Экспорт экземпляра адаптера\nlet dbAdapter: PostgreSQLAdapter | null = null;\n\nexport function getPostgreSQLAdapter(): PostgreSQLAdapter {\n  if (!dbAdapter) {\n    const config: DatabaseConfig = {\n      host: process.env.DB_HOST || 'localhost',\n      port: parseInt(process.env.DB_PORT || '5432'),\n      database: process.env.DB_NAME || 'encore_tasks',\n      user: process.env.DB_USER || 'postgres',\n      password: process.env.DB_PASSWORD || 'password',\n      ssl: process.env.DB_SSL === 'true'\n    };\n    \n    dbAdapter = new PostgreSQLAdapter(config);\n  }\n  \n  return dbAdapter;\n}\n\nexport default getPostgreSQLAdapter;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1205, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/lib/database-adapter.ts"],"sourcesContent":["// =====================================================\n// АДАПТЕР ДЛЯ РАБОТЫ С БАЗАМИ ДАННЫХ (PostgreSQL)\n// =====================================================\n\nimport { User, Project, Board, Column, Task, Session } from '@/types';\nimport { getPostgreSQLAdapter, PostgreSQLAdapter } from './postgresql-adapter';\n\n// =====================================================\n// ТИПЫ ДАННЫХ\n// =====================================================\n\nexport type DatabaseType = 'postgresql';\n\nexport interface DatabaseStatus {\n  postgresql: boolean;\n  current: DatabaseType;\n}\n\n// =====================================================\n// КЛАСС АДАПТЕРА БАЗЫ ДАННЫХ\n// =====================================================\n\nexport class DatabaseAdapter {\n  private static instance: DatabaseAdapter;\n  private currentDatabase: DatabaseType = 'postgresql';\n  private isInitialized = false;\n  private postgresqlAdapter: PostgreSQLAdapter;\n\n  private constructor() {\n    this.postgresqlAdapter = getPostgreSQLAdapter();\n    this.currentDatabase = 'postgresql';\n  }\n\n  public static getInstance(): DatabaseAdapter {\n    if (!DatabaseAdapter.instance) {\n      DatabaseAdapter.instance = new DatabaseAdapter();\n    }\n    return DatabaseAdapter.instance;\n  }\n\n  /**\n   * Инициализация адаптера\n   */\n  public async initialize(): Promise<void> {\n    if (this.isInitialized) return;\n\n    try {\n      // Используем PostgreSQL\n      await this.postgresqlAdapter.initialize();\n      this.currentDatabase = 'postgresql';\n      console.log('🎯 Database Adapter: Используется PostgreSQL');\n\n      this.isInitialized = true;\n      console.log('✅ Database Adapter: Инициализация завершена');\n    } catch (error) {\n      console.error('❌ Database Adapter: Ошибка инициализации PostgreSQL:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Получение статуса базы данных\n   */\n  public async getDatabaseStatus(): Promise<DatabaseStatus> {\n    const postgresql = await Promise.resolve(this.postgresqlAdapter.initialize()).then(() => true).catch(() => false);\n    \n    return {\n      postgresql,\n      current: this.currentDatabase\n    };\n  }\n\n\n\n  /**\n   * Получение текущей базы данных\n   */\n  public getCurrentDatabase(): DatabaseType {\n    return this.currentDatabase;\n  }\n\n  // =====================================================\n  // ОПЕРАЦИИ С ПОЛЬЗОВАТЕЛЯМИ\n  // =====================================================\n\n  /**\n   * Создание пользователя\n   */\n  public async createUser(userData: Omit<User, 'id' | 'created_at' | 'updated_at'>): Promise<User> {\n    await this.initialize();\n    const { email, password, name, role = 'user' } = userData;\n    return await this.postgresqlAdapter.createUser(email, password, name, role);\n  }\n\n  /**\n   * Получение пользователя по ID\n   */\n  public async getUserById(id: string): Promise<User | null> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getUserById(id);\n  }\n\n  /**\n   * Получение пользователя по email\n   */\n  public async getUserByEmail(email: string): Promise<User | null> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getUserByEmail(email);\n  }\n\n  /**\n   * Получение всех пользователей\n   */\n  public async getAllUsers(): Promise<User[]> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getAllUsers();\n  }\n\n  /**\n   * Обновление пользователя\n   */\n  public async updateUser(id: string, updates: Partial<User>): Promise<User | null> {\n    await this.initialize();\n    return await this.postgresqlAdapter.updateUser(id, updates);\n  }\n\n  /**\n   * Удаление пользователя\n   */\n  public async deleteUser(id: string): Promise<boolean> {\n    await this.initialize();\n    return await this.postgresqlAdapter.deleteUser(id);\n  }\n\n  // =====================================================\n  // ОПЕРАЦИИ С СЕССИЯМИ\n  // =====================================================\n\n  /**\n   * Создание сессии\n   */\n  public async createSession(sessionData: Omit<Session, 'id' | 'created_at'>): Promise<Session> {\n    await this.initialize();\n    const { session_token, user_id, expires_at } = sessionData;\n    return await this.postgresqlAdapter.createSession(session_token, user_id, new Date(expires_at));\n  }\n\n  /**\n   * Получение сессии по токену\n   */\n  public async getSessionByToken(token: string): Promise<Session | null> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getSessionByToken(token);\n  }\n\n  /**\n   * Обновление активности сессии\n   */\n  public async updateSessionActivity(token: string): Promise<boolean> {\n    await this.initialize();\n    // Для PostgreSQL можно реализовать обновление времени последней активности\n    return true;\n  }\n\n  /**\n   * Удаление сессии\n   */\n  public async deleteSession(token: string): Promise<boolean> {\n    await this.initialize();\n    return await this.postgresqlAdapter.deleteSession(token);\n  }\n\n  // =====================================================\n  // ОПЕРАЦИИ С ПРОЕКТАМИ\n  // =====================================================\n\n  /**\n   * Создание проекта\n   */\n  public async createProject(projectData: Omit<Project, 'id' | 'created_at' | 'updated_at'>): Promise<Project> {\n    await this.initialize();\n    const { name, description, creator_id, color } = projectData;\n    return await this.postgresqlAdapter.createProject(name, description || '', creator_id, color);\n  }\n\n  /**\n   * Получение проекта по ID\n   */\n  public async getProjectById(id: string): Promise<Project | null> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getProjectById(id);\n  }\n\n  /**\n   * Получение всех проектов\n   */\n  public async getAllProjects(): Promise<Project[]> {\n    await this.initialize();\n    // Для PostgreSQL получаем все проекты через пользователя (требует user_id)\n    // Возвращаем пустой массив, так как метод требует конкретного пользователя\n    return [];\n  }\n\n  /**\n   * Получение проектов пользователя\n   */\n  public async getUserProjects(userId: string): Promise<Project[]> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getProjectsByUserId(userId);\n  }\n\n  /**\n   * Получение проектов по ID создателя\n   */\n  public async getProjectsByCreatorId(creatorId: string): Promise<Project[]> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getProjectsByUserId(creatorId);\n  }\n\n  /**\n   * Проверка доступа к проекту\n   */\n  public async hasProjectAccess(userId: string | number, projectId: string): Promise<boolean> {\n    await this.initialize();\n    return await this.postgresqlAdapter.hasProjectAccess(userId.toString(), projectId);\n  }\n\n  // =====================================================\n  // ОПЕРАЦИИ С ДОСКАМИ\n  // =====================================================\n\n  /**\n   * Получение досок проекта\n   */\n  public async getProjectBoards(projectId: string): Promise<Board[]> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getBoardsByProjectId(projectId);\n  }\n\n  // =====================================================\n  // ОПЕРАЦИИ С КОЛОНКАМИ\n  // =====================================================\n\n  /**\n   * Получение колонок доски\n   */\n  public async getBoardColumns(boardId: string): Promise<Column[]> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getColumnsByBoardId(boardId);\n  }\n\n  /**\n   * Создание колонки\n   */\n  public async createColumn(columnData: Omit<Column, 'id' | 'created_at' | 'updated_at'>): Promise<Column> {\n    await this.initialize();\n    const { name, board_id, position, color } = columnData;\n    return await this.postgresqlAdapter.createColumn(name, board_id, position, color);\n  }\n\n  // =====================================================\n  // ОПЕРАЦИИ С ЗАДАЧАМИ\n  // =====================================================\n\n  /**\n   * Создание задачи\n   */\n  public async createTask(taskData: Omit<Task, 'id' | 'created_at' | 'updated_at'>): Promise<Task> {\n    await this.initialize();\n    return await this.postgresqlAdapter.createTask(taskData);\n  }\n\n  /**\n   * Получение задач колонки\n   */\n  public async getColumnTasks(columnId: string): Promise<Task[]> {\n    await this.initialize();\n    return await this.postgresqlAdapter.getTasksByColumnId(columnId);\n  }\n\n  /**\n   * Удаление задачи\n   */\n  public async deleteTask(id: string): Promise<boolean> {\n    await this.initialize();\n    return await this.postgresqlAdapter.deleteTask(id);\n  }\n\n  /**\n   * Выполнение сырого SQL запроса (для совместимости с репозиториями)\n   */\n  public async query(sql: string, params?: unknown[]): Promise<unknown[]> {\n    await this.initialize();\n    const result = await this.postgresqlAdapter.query(sql, params);\n    return result.rows || [];\n  }\n\n}\n\n\n\n// Экспорт единственного экземпляра\nexport const dbAdapter = DatabaseAdapter.getInstance();"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1434, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/contexts/AppContext.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext, useReducer, ReactNode, useEffect, useCallback } from \"react\";\nimport { Task, Project, User, Board, Column, TaskStatus, TaskAction } from \"@/types\";\nimport { generateId } from \"@/lib/utils\";\nimport { api, type User as ApiUser, type Project as ApiProject, type Board as ApiBoard, type Task as ApiTask } from \"@/lib/api\";\n\n// Helper function to create notifications\nfunction createNotification(\n  type: Notification[\"type\"],\n  title: string,\n  message: string,\n  userId: string,\n  projectId: string,\n  taskId?: string\n): Notification {\n  return {\n    id: generateId(),\n    type,\n    title,\n    message,\n    taskId,\n    projectId,\n    userId,\n    isRead: false,\n    createdAt: new Date()\n  };\n}\n\ninterface Notification {\n  id: string;\n  type: \"task_assigned\" | \"task_completed\" | \"task_updated\" | \"task_created\" | \"deadline_reminder\";\n  title: string;\n  message: string;\n  taskId?: string;\n  projectId: string;\n  userId: string;\n  isRead: boolean;\n  createdAt: Date;\n}\n\ninterface AppState {\n  currentUser: User | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  projects: Project[];\n  boards: Board[];\n  tasks: Task[];\n  archivedTasks: Task[];\n  filteredTasks: Task[] | null;\n  users: User[];\n  selectedProject: Project | null;\n  taskActions: TaskAction[];\n  selectedBoard: Board | null;\n  readNotifications: string[];\n  notifications: Notification[];\n  pendingUserNotifications: User[];\n  filters: {\n    assignee: string;\n    priority: string;\n    status: string;\n    deadline: string;\n  };\n  sortBy: \"priority\" | \"deadline\" | \"created\" | \"updated\";\n  sortOrder: \"asc\" | \"desc\";\n  settings: {\n    theme: \"dark\" | \"light\" | \"auto\";\n    language: \"ru\" | \"en\";\n    compactMode: boolean;\n    showAvatars: boolean;\n    emailNotifications: boolean;\n    pushNotifications: boolean;\n    taskReminders: boolean;\n    telegramNotifications: boolean;\n    taskAssigned: boolean;\n    taskCompleted: boolean;\n    deadlineReminder: boolean;\n    projectUpdates: boolean;\n  };\n}\n\ntype AppAction =\n  | { type: \"SET_LOADING\"; payload: boolean }\n  | { type: \"SET_CURRENT_USER\"; payload: User }\n  | { type: \"LOGIN\"; payload: User }\n  | { type: \"LOGOUT\" }\n  | { type: \"SET_USERS\"; payload: User[] }\n  | { type: \"ADD_USER\"; payload: User }\n  | { type: \"UPDATE_USER\"; payload: User }\n  | { type: \"APPROVE_USER\"; payload: string }\n  | { type: \"REJECT_USER\"; payload: string }\n  | { type: \"ADD_PENDING_USER_NOTIFICATION\"; payload: User }\n  | { type: \"SET_PROJECTS\"; payload: Project[] }\n  | { type: \"ADD_PROJECT\"; payload: Project }\n  | { type: \"UPDATE_PROJECT\"; payload: Project }\n  | { type: \"DELETE_PROJECT\"; payload: string }\n  | { type: \"SELECT_PROJECT\"; payload: Project | null }\n  | { type: \"SET_BOARDS\"; payload: Board[] }\n  | { type: \"ADD_BOARD\"; payload: Board }\n  | { type: \"UPDATE_BOARD\"; payload: Board }\n  | { type: \"DELETE_BOARD\"; payload: string }\n  | { type: \"SELECT_BOARD\"; payload: Board | null }\n  | { type: \"SET_TASKS\"; payload: Task[] }\n  | { type: \"ADD_TASK\"; payload: Task }\n  | { type: \"UPDATE_TASK\"; payload: Task }\n  | { type: \"DELETE_TASK\"; payload: string }\n  | { type: \"ARCHIVE_TASK\"; payload: string }\n  | { type: \"UNARCHIVE_TASK\"; payload: string }\n  | { type: \"SET_ARCHIVED_TASKS\"; payload: Task[] }\n  | {\n      type: \"MOVE_TASK\";\n      payload: { taskId: string; newStatus: TaskStatus; newPosition: number };\n    }\n  | { type: \"ADD_COLUMN\"; payload: { boardId: string; column: Column } }\n  | { type: \"UPDATE_COLUMN\"; payload: { boardId: string; column: Column } }\n  | { type: \"DELETE_COLUMN\"; payload: { boardId: string; columnId: string } }\n  | { type: \"SET_FILTERS\"; payload: Partial<AppState[\"filters\"]> }\n  | {\n      type: \"SET_SORT\";\n      payload: { sortBy: AppState[\"sortBy\"]; sortOrder: AppState[\"sortOrder\"] };\n    }\n  | { type: \"SET_FILTERED_TASKS\"; payload: Task[] }\n  | { type: \"CLEAR_FILTERED_TASKS\" }\n  | { type: \"ADD_NOTIFICATION\"; payload: Notification }\n  | { type: \"MARK_NOTIFICATION_READ\"; payload: string }\n  | { type: \"MARK_ALL_NOTIFICATIONS_READ\" }\n  | { type: \"UPDATE_SETTINGS\"; payload: Partial<AppState[\"settings\"]> }\n  | { type: \"ADD_TASK_ACTION\"; payload: TaskAction };\n\nconst initialState: AppState = {\n  currentUser: null,\n  isAuthenticated: false,\n  isLoading: false,\n  projects: [],\n  boards: [],\n  tasks: [],\n  archivedTasks: [],\n  filteredTasks: null,\n  users: [],\n  selectedProject: null,\n  taskActions: [],\n  selectedBoard: null,\n  readNotifications: [],\n  notifications: [],\n  pendingUserNotifications: [],\n  filters: {\n    assignee: \"\",\n    priority: \"\",\n    status: \"\",\n    deadline: \"\"\n  },\n  sortBy: \"created\",\n  sortOrder: \"desc\",\n  settings: {\n    theme: \"dark\",\n    language: \"ru\",\n    compactMode: false,\n    showAvatars: true,\n    emailNotifications: true,\n    pushNotifications: true,\n    taskReminders: true,\n    telegramNotifications: true,\n    taskAssigned: true,\n    taskCompleted: true,\n    deadlineReminder: true,\n    projectUpdates: true\n  }\n};\n\n// Load settings from localStorage\nconst loadSettings = (): AppState[\"settings\"] => {\n  if (typeof window === \"undefined\") return initialState.settings;\n  \n  try {\n    const saved = localStorage.getItem(\"encore-tasks-settings\");\n    if (saved) {\n      return { ...initialState.settings, ...JSON.parse(saved) };\n    }\n  } catch (error) {\n    console.error(\"Failed to load settings:\", error);\n  }\n  return initialState.settings;\n};\n\n// Save settings to localStorage\nconst saveSettings = (settings: AppState[\"settings\"]) => {\n  if (typeof window === \"undefined\") return;\n  \n  try {\n    localStorage.setItem(\"encore-tasks-settings\", JSON.stringify(settings));\n  } catch (error) {\n    console.error(\"Failed to save settings:\", error);\n  }\n};\n\n// Convert API types to app types\nconst convertApiUserToUser = (apiUser: ApiUser): User => ({\n  id: apiUser.id,\n  name: apiUser.name,\n  email: apiUser.email,\n  role: apiUser.role,\n  isApproved: apiUser.approval_status === 'approved' || apiUser.status === 'approved' || apiUser.role === 'admin',\n  createdAt: new Date(apiUser.createdAt),\n  avatar: apiUser.avatar\n});\n\nconst convertApiProjectToProject = (apiProject: ApiProject): Project => ({\n  id: apiProject.id,\n  name: apiProject.name,\n  description: apiProject.description || '',\n  color: apiProject.color,\n  members: [], // Will be loaded separately\n  createdBy: apiProject.createdBy,\n  createdAt: new Date(apiProject.createdAt),\n  telegramChatId: undefined // Will be added later if needed\n});\n\nconst convertApiBoardToBoard = (apiBoard: ApiBoard): Board => ({\n  id: apiBoard.id,\n  name: apiBoard.name,\n  projectId: apiBoard.projectId,\n  columns: [], // Will be loaded separately\n  createdAt: new Date(apiBoard.createdAt)\n});\n\nconst convertApiTaskToTask = (apiTask: ApiTask): Task => ({\n  id: apiTask.id,\n  title: apiTask.title,\n  description: apiTask.description || '',\n  status: apiTask.status as TaskStatus,\n  priority: apiTask.priority,\n  assignee: apiTask.assignees?.[0] ? convertApiUserToUser(apiTask.assignees[0]) : undefined,\n  assignees: apiTask.assignees?.map(convertApiUserToUser) || [],\n  reporter: {\n    id: apiTask.reporterId,\n    name: apiTask.reporterName,\n    email: '',\n    role: 'user',\n    isApproved: true,\n    createdAt: new Date()\n  },\n  projectId: apiTask.projectId,\n  boardId: apiTask.boardId,\n  subtasks: [], // Will be loaded separately if needed\n  deadline: apiTask.deadline ? new Date(apiTask.deadline) : undefined,\n  attachments: [], // Will be loaded separately if needed\n  comments: [], // Will be loaded separately if needed\n  tags: apiTask.tags?.map(tag => tag.name) || [],\n  createdAt: new Date(apiTask.createdAt),\n  updatedAt: new Date(apiTask.updatedAt),\n  position: apiTask.position\n});\n\nfunction appReducer(state: AppState, action: AppAction): AppState {\n  switch (action.type) {\n    case \"SET_LOADING\":\n      return { ...state, isLoading: action.payload };\n\n    case \"SET_CURRENT_USER\":\n    case \"LOGIN\":\n      return {\n        ...state,\n        currentUser: action.payload,\n        isAuthenticated: true\n      };\n\n    case \"LOGOUT\":\n      return {\n        ...state,\n        currentUser: null,\n        isAuthenticated: false,\n        projects: [],\n        boards: [],\n        tasks: [],\n        users: [],\n        selectedProject: null,\n        selectedBoard: null\n      };\n\n    case \"SET_USERS\":\n      return { ...state, users: action.payload };\n\n    case \"ADD_USER\":\n      return { ...state, users: [...state.users, action.payload] };\n\n    case \"UPDATE_USER\":\n      return {\n        ...state,\n        users: state.users.map(user =>\n          user.id === action.payload.id ? action.payload : user\n        ),\n        currentUser:\n          state.currentUser?.id === action.payload.id\n            ? action.payload\n            : state.currentUser\n      };\n\n    case \"SET_PROJECTS\":\n      return { ...state, projects: action.payload };\n\n    case \"ADD_PROJECT\":\n      return { ...state, projects: [...state.projects, action.payload] };\n\n    case \"UPDATE_PROJECT\":\n      return {\n        ...state,\n        projects: state.projects.map(project =>\n          project.id === action.payload.id ? action.payload : project\n        ),\n        selectedProject:\n          state.selectedProject?.id === action.payload.id\n            ? action.payload\n            : state.selectedProject\n      };\n\n    case \"DELETE_PROJECT\":\n      return {\n        ...state,\n        projects: state.projects.filter(project => project.id !== action.payload),\n        selectedProject:\n          state.selectedProject?.id === action.payload ? null : state.selectedProject\n      };\n\n    case \"SELECT_PROJECT\":\n      return { ...state, selectedProject: action.payload };\n\n    case \"SET_BOARDS\":\n      return { ...state, boards: action.payload };\n\n    case \"ADD_BOARD\":\n      return { ...state, boards: [...state.boards, action.payload] };\n\n    case \"UPDATE_BOARD\":\n      return {\n        ...state,\n        boards: state.boards.map(board =>\n          board.id === action.payload.id ? action.payload : board\n        ),\n        selectedBoard:\n          state.selectedBoard?.id === action.payload.id\n            ? action.payload\n            : state.selectedBoard\n      };\n\n    case \"DELETE_BOARD\":\n      return {\n        ...state,\n        boards: state.boards.filter(board => board.id !== action.payload),\n        selectedBoard:\n          state.selectedBoard?.id === action.payload ? null : state.selectedBoard\n      };\n\n    case \"SELECT_BOARD\":\n      return { ...state, selectedBoard: action.payload };\n\n    case \"SET_TASKS\":\n      return { ...state, tasks: action.payload };\n\n    case \"ADD_TASK\":\n      return { ...state, tasks: [...state.tasks, action.payload] };\n\n    case \"UPDATE_TASK\":\n      return {\n        ...state,\n        tasks: state.tasks.map(task =>\n          task.id === action.payload.id ? action.payload : task\n        )\n      };\n\n    case \"DELETE_TASK\":\n      return {\n        ...state,\n        tasks: state.tasks.filter(task => task.id !== action.payload)\n      };\n\n    case \"SET_FILTERS\":\n      return {\n        ...state,\n        filters: { ...state.filters, ...action.payload }\n      };\n\n    case \"SET_SORT\":\n      return {\n        ...state,\n        sortBy: action.payload.sortBy,\n        sortOrder: action.payload.sortOrder\n      };\n\n    case \"SET_FILTERED_TASKS\":\n      return { ...state, filteredTasks: action.payload };\n\n    case \"CLEAR_FILTERED_TASKS\":\n      return { ...state, filteredTasks: null };\n\n    case \"ADD_NOTIFICATION\":\n      return {\n        ...state,\n        notifications: [action.payload, ...state.notifications]\n      };\n\n    case \"MARK_NOTIFICATION_READ\":\n      return {\n        ...state,\n        notifications: state.notifications.map(notification =>\n          notification.id === action.payload\n            ? { ...notification, isRead: true }\n            : notification\n        )\n      };\n\n    case \"MARK_ALL_NOTIFICATIONS_READ\":\n      return {\n        ...state,\n        notifications: state.notifications.map(notification => ({\n          ...notification,\n          isRead: true\n        }))\n      };\n\n    case \"UPDATE_SETTINGS\":\n      const newSettings = { ...state.settings, ...action.payload };\n      saveSettings(newSettings);\n      return { ...state, settings: newSettings };\n\n    default:\n      return state;\n  }\n}\n\nconst AppContext = createContext<{\n  state: AppState;\n  dispatch: React.Dispatch<AppAction>;\n  // API methods\n  login: (email: string, password: string) => Promise<boolean>;\n  logout: () => Promise<void>;\n  loadProjects: () => Promise<void>;\n  loadBoards: (projectId?: string) => Promise<void>;\n  loadTasks: (params?: { projectId?: string; boardId?: string }) => Promise<void>;\n  loadUsers: () => Promise<void>;\n  createProject: (projectData: { name: string; description?: string; color?: string }) => Promise<boolean>;\n  createBoard: (boardData: { name: string; description?: string; projectId: string }) => Promise<boolean>;\n  createTask: (taskData: {\n    title: string;\n    description?: string;\n    status?: string;\n    priority?: string;\n    assigneeId?: string;\n    columnId: string;\n    position?: number;\n    dueDate?: Date;\n    estimatedHours?: number;\n    tags?: string[];\n  }) => Promise<boolean>;\n  updateTask: (taskId: string, updateData: any) => Promise<boolean>;\n  deleteTask: (taskId: string) => Promise<boolean>;\n  updateUser: (userId: string, updateData: { role?: string; status?: string }) => Promise<boolean>;\n  deleteUser: (userId: string) => Promise<boolean>;\n} | null>(null);\n\nexport function AppProvider({ children }: { children: ReactNode }) {\n  const [state, dispatch] = useReducer(appReducer, {\n    ...initialState,\n    settings: loadSettings()\n  });\n\n  // Initialize authentication on app load\n  useEffect(() => {\n    const initializeAuth = async () => {\n      dispatch({ type: \"SET_LOADING\", payload: true });\n      \n      try {\n        // Check if user is already authenticated\n        const response = await api.getCurrentUser();\n        \n        if (response.data?.user && !response.error) {\n          const user = convertApiUserToUser(response.data.user);\n          dispatch({ type: \"LOGIN\", payload: user });\n          \n          // Load initial data\n          // await Promise.all([\n          //   loadProjects(),\n          //   loadUsers()\n          // ]);\n        }\n      } catch (error) {\n        console.log('No existing session found');\n      } finally {\n        dispatch({ type: \"SET_LOADING\", payload: false });\n      }\n    };\n    \n    initializeAuth();\n  }, []);\n\n  // API methods\n  const login = async (email: string, password: string): Promise<boolean> => {\n    dispatch({ type: \"SET_LOADING\", payload: true });\n    \n    try {\n      const response = await api.login(email, password);\n      \n      if (response.error) {\n        return false;\n      }\n      \n      if (response.data?.user) {\n        const user = convertApiUserToUser(response.data.user);\n        dispatch({ type: \"LOGIN\", payload: user });\n        \n        // Load initial data\n        // await Promise.all([\n        //   loadProjects(),\n        //   loadUsers()\n        // ]);\n        \n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      console.error('Login failed:', error);\n      return false;\n    } finally {\n      dispatch({ type: \"SET_LOADING\", payload: false });\n    }\n  };\n\n  const logout = async (): Promise<void> => {\n    try {\n      await api.logout();\n    } catch (error) {\n      console.error('Logout error:', error);\n    } finally {\n      dispatch({ type: \"LOGOUT\" });\n    }\n  };\n\n  const loadProjects = useCallback(async (): Promise<void> => {\n    try {\n      const response = await api.getProjects();\n      \n      if (response.error) {\n        console.error('Load projects error:', response.error);\n        return;\n      }\n      \n      if (response.data?.projects) {\n        const projects = response.data.projects.map(convertApiProjectToProject);\n        dispatch({ type: \"SET_PROJECTS\", payload: projects });\n      }\n    } catch (error) {\n      console.error('Failed to load projects:', error);\n    }\n  }, [dispatch]);\n\n  const loadBoards = useCallback(async (projectId?: string): Promise<void> => {\n    try {\n      const response = await api.getBoards(projectId);\n      \n      if (response.error) {\n        console.error('Load boards error:', response.error);\n        return;\n      }\n      \n      if (response.data?.boards) {\n        const boards = response.data.boards.map(convertApiBoardToBoard);\n        \n        // Загружаем колонки для каждой доски\n        for (const board of boards) {\n          try {\n            const columnsResponse = await api.getColumns(board.id.toString());\n            if (columnsResponse.data?.columns) {\n              board.columns = columnsResponse.data.columns.map((col: any) => ({\n                id: col.id.toString(), // Convert to string for consistency\n                name: col.name,\n                title: col.name, // Add title for compatibility\n                color: col.color,\n                position: col.position,\n                tasks: [] // Tasks will be loaded separately\n              }));\n            }\n          } catch (error) {\n            console.error(`Failed to load columns for board ${board.id}:`, error);\n          }\n        }\n        \n        dispatch({ type: \"SET_BOARDS\", payload: boards });\n        \n        // Автоматически выбираем первую доску, если нет выбранной доски или она не принадлежит текущему проекту\n        if (boards.length > 0) {\n          const currentSelectedBoard = state.selectedBoard;\n          const shouldSelectNewBoard = !currentSelectedBoard || \n            !boards.find(board => board.id === currentSelectedBoard.id);\n          \n          if (shouldSelectNewBoard) {\n            dispatch({ type: \"SELECT_BOARD\", payload: boards[0] });\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Failed to load boards:', error);\n    }\n  }, [dispatch, state.selectedBoard]);\n\n  const loadTasks = useCallback(async (params?: { projectId?: string; boardId?: string }): Promise<void> => {\n    try {\n      const response = await api.getTasks(params);\n      \n      if (response.error) {\n        console.error('Load tasks error:', response.error);\n        return;\n      }\n      \n      if (response.data?.tasks) {\n        const tasks = response.data.tasks.map(convertApiTaskToTask);\n        dispatch({ type: \"SET_TASKS\", payload: tasks });\n      }\n    } catch (error) {\n      console.error('Failed to load tasks:', error);\n    }\n  }, [dispatch]);\n\n  const loadUsers = useCallback(async (): Promise<void> => {\n    try {\n      const response = await api.getUsers();\n      \n      if (response.error) {\n        console.error('Load users error:', response.error);\n        return;\n      }\n      \n      if (response.data?.users) {\n        const users = response.data.users.map(convertApiUserToUser);\n        dispatch({ type: \"SET_USERS\", payload: users });\n      }\n    } catch (error) {\n      console.error('Failed to load users:', error);\n    }\n  }, [dispatch]);\n\n  const createProject = async (projectData: {\n    name: string;\n    description?: string;\n    color?: string;\n  }): Promise<boolean> => {\n    try {\n      const response = await api.createProject({\n        ...projectData,\n        color: projectData.color || '#6366f1'\n      });\n      \n      if (response.error) {\n        console.error('Create project error:', response.error);\n        return false;\n      }\n      \n      if (response.data?.project) {\n        const project = convertApiProjectToProject(response.data.project);\n        dispatch({ type: \"ADD_PROJECT\", payload: project });\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      console.error('Failed to create project:', error);\n      return false;\n    }\n  };\n\n  const createBoard = async (boardData: {\n    name: string;\n    description?: string;\n    projectId: string;\n  }): Promise<boolean> => {\n    try {\n      const response = await api.createBoard({\n        name: boardData.name,\n        description: boardData.description,\n        projectId: boardData.projectId,\n        visibility: 'public',\n        color: '#6366f1',\n        allowComments: true,\n        allowAttachments: true,\n        autoArchive: false\n      });\n      \n      if (response.error) {\n        console.error('Create board error:', response.error);\n        return false;\n      }\n      \n      if (response.data?.board) {\n        const board = convertApiBoardToBoard(response.data.board);\n        dispatch({ type: \"ADD_BOARD\", payload: board });\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      console.error('Failed to create board:', error);\n      return false;\n    }\n  };\n\n  const createTask = async (taskData: {\n    title: string;\n    description?: string;\n    status?: string;\n    priority?: string;\n    assigneeId?: string;\n    columnId: string;\n    position?: number;\n    dueDate?: Date;\n    estimatedHours?: number;\n    tags?: string[];\n  }): Promise<boolean> => {\n    try {\n      const response = await api.createTask({\n        title: taskData.title,\n        description: taskData.description,\n        status: taskData.status || 'todo',\n        priority: taskData.priority || 'medium',\n        assigneeId: taskData.assigneeId,\n        columnId: taskData.columnId,\n        position: taskData.position || 0,\n        dueDate: taskData.dueDate,\n        estimatedHours: taskData.estimatedHours,\n        tags: taskData.tags || []\n      });\n      \n      if (response.error) {\n        console.error('Create task error:', response.error);\n        return false;\n      }\n      \n      if (response.data?.task) {\n        const task = convertApiTaskToTask(response.data.task);\n        dispatch({ type: \"ADD_TASK\", payload: task });\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      console.error('Failed to create task:', error);\n      return false;\n    }\n  };\n\n  const updateTask = async (taskId: string, updateData: any): Promise<boolean> => {\n    try {\n      const response = await api.updateTask(taskId, updateData);\n      \n      if (response.error) {\n        console.error('Update task error:', response.error);\n        return false;\n      }\n      \n      if (response.data?.task) {\n        const task = convertApiTaskToTask(response.data.task);\n        dispatch({ type: \"UPDATE_TASK\", payload: task });\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      console.error('Failed to update task:', error);\n      return false;\n    }\n  };\n\n  const deleteTask = async (taskId: string): Promise<boolean> => {\n    try {\n      const response = await api.deleteTask(taskId);\n      \n      if (response.error) {\n        console.error('Delete task error:', response.error);\n        return false;\n      }\n      \n      dispatch({ type: \"DELETE_TASK\", payload: taskId });\n      return true;\n    } catch (error) {\n      console.error('Failed to delete task:', error);\n      return false;\n    }\n  };\n\n  const deleteProject = async (projectId: string): Promise<boolean> => {\n    try {\n      const response = await api.deleteProject(projectId);\n      \n      if (response.error) {\n        console.error('Delete project error:', response.error);\n        return false;\n      }\n      \n      dispatch({ type: \"DELETE_PROJECT\", payload: projectId });\n      return true;\n    } catch (error) {\n      console.error('Failed to delete project:', error);\n      return false;\n    }\n  };\n\n  const deleteBoard = async (boardId: string): Promise<boolean> => {\n    try {\n      const response = await api.deleteBoard(boardId);\n      \n      if (response.error) {\n        console.error('Delete board error:', response.error);\n        return false;\n      }\n      \n      dispatch({ type: \"DELETE_BOARD\", payload: boardId });\n      return true;\n    } catch (error) {\n      console.error('Failed to delete board:', error);\n      return false;\n    }\n  };\n\n  const updateUser = async (userId: string, updateData: { role?: string; status?: string }): Promise<boolean> => {\n    try {\n      const response = await api.updateUser(userId, updateData);\n      \n      if (response.error) {\n        console.error('Update user error:', response.error);\n        return false;\n      }\n      \n      if (response.data?.user) {\n        const updatedUser = convertApiUserToUser(response.data.user);\n        dispatch({ type: \"UPDATE_USER\", payload: updatedUser });\n      }\n      \n      return true;\n    } catch (error) {\n      console.error('Failed to update user:', error);\n      return false;\n    }\n  };\n\n  const deleteUser = async (userId: string): Promise<boolean> => {\n    try {\n      const response = await api.deleteUser(userId);\n      \n      if (response.error) {\n        console.error('Delete user error:', response.error);\n        return false;\n      }\n      \n      dispatch({ type: \"REJECT_USER\", payload: userId });\n      return true;\n    } catch (error) {\n      console.error('Failed to delete user:', error);\n      return false;\n    }\n  };\n\n  const contextValue = {\n    state,\n    dispatch,\n    login,\n    logout,\n    loadProjects,\n    loadBoards,\n    loadTasks,\n    loadUsers,\n    createProject,\n    createBoard,\n    createTask,\n    updateTask,\n    deleteTask,\n    deleteProject,\n    updateUser,\n    deleteUser\n  };\n\n  return (\n    <AppContext.Provider value={contextValue}>\n      {children}\n    </AppContext.Provider>\n  );\n}\n\nexport function useApp() {\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error(\"useApp must be used within an AppProvider\");\n  }\n  return context;\n}\n\nexport { createNotification };\nexport type { Notification, AppState, AppAction };"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2232, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/contexts/AuthContext.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext, useReducer, useEffect, useCallback } from 'react';\nimport { \n  User, \n  AuthContextType, \n  LoginDto, \n  RegisterDto, \n  UpdateProfileDto, \n  ChangePasswordDto, \n  AuthResponse,\n  UserStatus,\n  AuthError,\n  AUTH_ERROR_CODES\n} from '@/types/auth.types';\nimport { authApi } from '@/lib/auth-api';\nimport { useNotification } from '@/components/notifications/NotificationSystem';\n\n// Состояние аутентификации\ninterface AuthState {\n  user: User | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  error: string | null;\n}\n\n// Действия для reducer\ntype AuthAction =\n  | { type: 'SET_LOADING'; payload: boolean }\n  | { type: 'SET_USER'; payload: User | null }\n  | { type: 'SET_ERROR'; payload: string | null }\n  | { type: 'LOGIN_SUCCESS'; payload: User }\n  | { type: 'LOGOUT' }\n  | { type: 'UPDATE_USER'; payload: User };\n\n// Начальное состояние\nconst initialState: AuthState = {\n  user: null,\n  isAuthenticated: false,\n  isLoading: true,\n  error: null\n};\n\n// Reducer для управления состоянием\nfunction authReducer(state: AuthState, action: AuthAction): AuthState {\n  switch (action.type) {\n    case 'SET_LOADING':\n      return { ...state, isLoading: action.payload };\n    \n    case 'SET_USER':\n      return {\n        ...state,\n        user: action.payload,\n        isAuthenticated: !!action.payload,\n        error: null\n      };\n    \n    case 'SET_ERROR':\n      return { ...state, error: action.payload, isLoading: false };\n    \n    case 'LOGIN_SUCCESS':\n      return {\n        ...state,\n        user: action.payload,\n        isAuthenticated: true,\n        isLoading: false,\n        error: null\n      };\n    \n    case 'LOGOUT':\n      return {\n        ...state,\n        user: null,\n        isAuthenticated: false,\n        isLoading: false,\n        error: null\n      };\n    \n    case 'UPDATE_USER':\n      return {\n        ...state,\n        user: action.payload,\n        error: null\n      };\n    \n    default:\n      return state;\n  }\n}\n\n// Создание контекста\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\n// Провайдер аутентификации\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [state, dispatch] = useReducer(authReducer, initialState);\n  const { showNotification } = useNotification();\n\n  // Проверка аутентификации при загрузке\n  const checkAuth = useCallback(async () => {\n    try {\n      dispatch({ type: 'SET_LOADING', payload: true });\n      const user = await authApi.getCurrentUser();\n      \n      if (user) {\n        dispatch({ type: 'SET_USER', payload: user });\n      } else {\n        dispatch({ type: 'SET_USER', payload: null });\n      }\n    } catch (error) {\n      console.error('Auth check failed:', error);\n      dispatch({ type: 'SET_USER', payload: null });\n    } finally {\n      dispatch({ type: 'SET_LOADING', payload: false });\n    }\n  }, []);\n\n  // Вход в систему\n  const login = useCallback(async (credentials: LoginDto): Promise<AuthResponse> => {\n    try {\n      dispatch({ type: 'SET_LOADING', payload: true });\n      dispatch({ type: 'SET_ERROR', payload: null });\n      \n      const response = await authApi.login(credentials);\n      \n      // Проверяем статус пользователя\n      if (response.user.status === 'pending') {\n        showNotification({\n          type: 'info',\n          title: 'Ожидание одобрения',\n          message: 'Ваш аккаунт ожидает одобрения администратора',\n          duration: 8000\n        });\n      } else if (response.user.status === 'rejected') {\n        throw new AuthError(\n          'Ваш аккаунт был отклонен администратором',\n          AUTH_ERROR_CODES.USER_SUSPENDED\n        );\n      } else if (response.user.status === 'suspended') {\n        throw new AuthError(\n          'Ваш аккаунт заблокирован',\n          AUTH_ERROR_CODES.USER_SUSPENDED\n        );\n      }\n      \n      dispatch({ type: 'LOGIN_SUCCESS', payload: response.user });\n      \n      showNotification({\n        type: 'success',\n        title: 'Добро пожаловать!',\n        message: `Привет, ${response.user.name}!`\n      });\n      \n      return response;\n    } catch (error) {\n      const errorMessage = error instanceof AuthError \n        ? error.message \n        : 'Ошибка входа в систему';\n      \n      dispatch({ type: 'SET_ERROR', payload: errorMessage });\n      \n      showNotification({\n        type: 'error',\n        title: 'Ошибка входа',\n        message: errorMessage\n      });\n      \n      throw error;\n    } finally {\n      dispatch({ type: 'SET_LOADING', payload: false });\n    }\n  }, [showNotification]);\n\n  // Регистрация\n  const register = useCallback(async (userData: RegisterDto): Promise<{ success: boolean; message: string }> => {\n    try {\n      dispatch({ type: 'SET_LOADING', payload: true });\n      dispatch({ type: 'SET_ERROR', payload: null });\n      \n      const result = await authApi.register(userData);\n      \n      showNotification({\n        type: 'success',\n        title: 'Регистрация успешна!',\n        message: 'Ваш аккаунт создан и ожидает одобрения администратора',\n        duration: 8000\n      });\n      \n      return result;\n    } catch (error) {\n      const errorMessage = error instanceof AuthError \n        ? error.message \n        : 'Ошибка регистрации';\n      \n      dispatch({ type: 'SET_ERROR', payload: errorMessage });\n      \n      showNotification({\n        type: 'error',\n        title: 'Ошибка регистрации',\n        message: errorMessage\n      });\n      \n      throw error;\n    } finally {\n      dispatch({ type: 'SET_LOADING', payload: false });\n    }\n  }, [showNotification]);\n\n  // Выход из системы\n  const logout = useCallback(async () => {\n    try {\n      await authApi.logout();\n      dispatch({ type: 'LOGOUT' });\n      \n      showNotification({\n        type: 'info',\n        title: 'До свидания!',\n        message: 'Вы успешно вышли из системы'\n      });\n    } catch (error) {\n      console.error('Logout error:', error);\n      // Принудительный выход даже при ошибке\n      dispatch({ type: 'LOGOUT' });\n    }\n  }, [showNotification]);\n\n  // Обновление профиля\n  const updateProfile = useCallback(async (data: UpdateProfileDto): Promise<User> => {\n    try {\n      dispatch({ type: 'SET_LOADING', payload: true });\n      \n      const updatedUser = await authApi.updateProfile(data);\n      dispatch({ type: 'UPDATE_USER', payload: updatedUser });\n      \n      showNotification({\n        type: 'success',\n        title: 'Профиль обновлен',\n        message: 'Ваши данные успешно сохранены'\n      });\n      \n      return updatedUser;\n    } catch (error) {\n      const errorMessage = error instanceof AuthError \n        ? error.message \n        : 'Ошибка обновления профиля';\n      \n      showNotification({\n        type: 'error',\n        title: 'Ошибка обновления',\n        message: errorMessage\n      });\n      \n      throw error;\n    } finally {\n      dispatch({ type: 'SET_LOADING', payload: false });\n    }\n  }, [showNotification]);\n\n  // Смена пароля\n  const changePassword = useCallback(async (data: ChangePasswordDto): Promise<{ success: boolean; message: string }> => {\n    try {\n      dispatch({ type: 'SET_LOADING', payload: true });\n      \n      const result = await authApi.changePassword(data);\n      \n      showNotification({\n        type: 'success',\n        title: 'Пароль изменен',\n        message: 'Ваш пароль успешно обновлен'\n      });\n      \n      return result;\n    } catch (error) {\n      const errorMessage = error instanceof AuthError \n        ? error.message \n        : 'Ошибка смены пароля';\n      \n      showNotification({\n        type: 'error',\n        title: 'Ошибка смены пароля',\n        message: errorMessage\n      });\n      \n      throw error;\n    } finally {\n      dispatch({ type: 'SET_LOADING', payload: false });\n    }\n  }, [showNotification]);\n\n  // Обновление токена\n  const refreshToken = useCallback(async (): Promise<AuthResponse | null> => {\n    try {\n      const response = await authApi.refreshToken();\n      if (response) {\n        dispatch({ type: 'SET_USER', payload: response.user });\n      }\n      return response;\n    } catch (error) {\n      console.error('Token refresh failed:', error);\n      dispatch({ type: 'LOGOUT' });\n      return null;\n    }\n  }, []);\n\n  // Проверка аутентификации при монтировании\n  useEffect(() => {\n    checkAuth();\n  }, [checkAuth]);\n\n  // Автоматическое обновление токена\n  useEffect(() => {\n    if (!state.isAuthenticated) return;\n\n    const interval = setInterval(async () => {\n      try {\n        await refreshToken();\n      } catch (error) {\n        console.error('Auto token refresh failed:', error);\n      }\n    }, 15 * 60 * 1000); // Каждые 15 минут\n\n    return () => clearInterval(interval);\n  }, [state.isAuthenticated, refreshToken]);\n\n  const contextValue: AuthContextType = {\n    user: state.user,\n    isAuthenticated: state.isAuthenticated,\n    isLoading: state.isLoading,\n    login,\n    register,\n    logout,\n    updateProfile,\n    changePassword,\n    refreshToken,\n    checkAuth\n  };\n\n  return (\n    <AuthContext.Provider value={contextValue}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\n// Хук для использования контекста аутентификации\nexport function useAuth(): AuthContextType {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n\n// HOC для защищенных маршрутов\nexport function withAuth<P extends object>(Component: React.ComponentType<P>) {\n  return function AuthenticatedComponent(props: P) {\n    const { isAuthenticated, isLoading } = useAuth();\n\n    if (isLoading) {\n      return (\n        <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500\"></div>\n        </div>\n      );\n    }\n\n    if (!isAuthenticated) {\n      return null; // AuthModal будет показан в Layout\n    }\n\n    return <Component {...props} />;\n  };\n}\n\n// HOC для проверки ролей\nexport function withRole(allowedRoles: string[]) {\n  return function <P extends object>(Component: React.ComponentType<P>) {\n    return function RoleProtectedComponent(props: P) {\n      const { user, isAuthenticated } = useAuth();\n\n      if (!isAuthenticated || !user || !allowedRoles.includes(user.role)) {\n        return (\n          <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center\">\n            <div className=\"text-center text-white\">\n              <h1 className=\"text-2xl font-bold mb-4\">Доступ запрещен</h1>\n              <p className=\"text-gray-400\">У вас нет прав для просмотра этой страницы</p>\n            </div>\n          </div>\n        );\n      }\n\n      return <Component {...props} />;\n    };\n  };\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2726, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/hooks/useConfirmation.tsx"],"sourcesContent":["import { useState, useCallback } from 'react';\nimport ConfirmationModal from '@/components/ConfirmationModal';\n\ninterface ConfirmationOptions {\n  title: string;\n  message: string;\n  confirmText?: string;\n  cancelText?: string;\n  type?: 'danger' | 'warning' | 'info';\n}\n\ninterface UseConfirmationReturn {\n  ConfirmationComponent: () => React.ReactNode;\n  confirm: (options: ConfirmationOptions) => Promise<boolean>;\n}\n\nexport const useConfirmation = (): UseConfirmationReturn => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [options, setOptions] = useState<ConfirmationOptions | null>(null);\n  const [resolvePromise, setResolvePromise] = useState<((value: boolean) => void) | null>(null);\n\n  const confirm = useCallback((confirmationOptions: ConfirmationOptions): Promise<boolean> => {\n    return new Promise((resolve) => {\n      setOptions(confirmationOptions);\n      setResolvePromise(() => resolve);\n      setIsOpen(true);\n    });\n  }, []);\n\n  const handleConfirm = useCallback(() => {\n    if (resolvePromise) {\n      resolvePromise(true);\n    }\n    setIsOpen(false);\n    setOptions(null);\n    setResolvePromise(null);\n  }, [resolvePromise]);\n\n  const handleCancel = useCallback(() => {\n    if (resolvePromise) {\n      resolvePromise(false);\n    }\n    setIsOpen(false);\n    setOptions(null);\n    setResolvePromise(null);\n  }, [resolvePromise]);\n\n  const ConfirmationComponent = useCallback(() => {\n    if (!options) return null;\n\n    return (\n      <ConfirmationModal\n        isOpen={isOpen}\n        onClose={handleCancel}\n        onConfirm={handleConfirm}\n        title={options.title}\n        message={options.message}\n        confirmText={options.confirmText}\n        cancelText={options.cancelText}\n        type={options.type}\n      />\n    );\n  }, [isOpen, options, handleCancel, handleConfirm]);\n\n  return {\n    ConfirmationComponent,\n    confirm\n  };\n};\n\nexport default useConfirmation;"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;AAeO,MAAM,kBAAkB;;IAC7B,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAA8B;IACnE,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAqC;IAExF,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;gDAAE,CAAC;YAC3B,OAAO,IAAI;wDAAQ,CAAC;oBAClB,WAAW;oBACX;gEAAkB,IAAM;;oBACxB,UAAU;gBACZ;;QACF;+CAAG,EAAE;IAEL,MAAM,gBAAgB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;sDAAE;YAChC,IAAI,gBAAgB;gBAClB,eAAe;YACjB;YACA,UAAU;YACV,WAAW;YACX,kBAAkB;QACpB;qDAAG;QAAC;KAAe;IAEnB,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;qDAAE;YAC/B,IAAI,gBAAgB;gBAClB,eAAe;YACjB;YACA,UAAU;YACV,WAAW;YACX,kBAAkB;QACpB;oDAAG;QAAC;KAAe;IAEnB,MAAM,wBAAwB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;8DAAE;YACxC,IAAI,CAAC,SAAS,OAAO;YAErB,qBACE,6LAAC,0IAAA,CAAA,UAAiB;gBAChB,QAAQ;gBACR,SAAS;gBACT,WAAW;gBACX,OAAO,QAAQ,KAAK;gBACpB,SAAS,QAAQ,OAAO;gBACxB,aAAa,QAAQ,WAAW;gBAChC,YAAY,QAAQ,UAAU;gBAC9B,MAAM,QAAQ,IAAI;;;;;;QAGxB;6DAAG;QAAC;QAAQ;QAAS;QAAc;KAAc;IAEjD,OAAO;QACL;QACA;IACF;AACF;GApDa;uCAsDE","debugId":null}},
    {"offset": {"line": 2819, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/utils/taskLogger.ts"],"sourcesContent":["import { TaskAction } from '@/types';\nimport { v4 as uuidv4 } from 'uuid';\n\nexport const createTaskAction = (\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  userId: string,\n  userName: string,\n  action: TaskAction['action'],\n  description: string,\n  oldValue?: string,\n  newValue?: string,\n  changes?: TaskAction['changes']\n): TaskAction => {\n  return {\n    id: uuidv4(),\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    action,\n    description,\n    timestamp: new Date().toISOString(),\n    oldValue,\n    newValue,\n    changes\n  };\n};\n\nexport const logTaskCreated = (\n  dispatch: any,\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  taskTitle: string,\n  userId: string,\n  userName: string\n) => {\n  const action = createTaskAction(\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    'created',\n    `Создана задача \"${taskTitle}\"`\n  );\n  dispatch({ type: 'ADD_TASK_ACTION', payload: action });\n};\n\nexport const logTaskDeleted = (\n  dispatch: any,\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  taskTitle: string,\n  userId: string,\n  userName: string\n) => {\n  const action = createTaskAction(\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    'deleted',\n    `Удалена задача \"${taskTitle}\"`\n  );\n  dispatch({ type: 'ADD_TASK_ACTION', payload: action });\n};\n\nexport const logTaskMoved = (\n  dispatch: any,\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  taskTitle: string,\n  userId: string,\n  userName: string,\n  fromColumn: string,\n  toColumn: string\n) => {\n  const action = createTaskAction(\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    'moved',\n    `Перемещена задача \"${taskTitle}\" из \"${fromColumn}\" в \"${toColumn}\"`,\n    fromColumn,\n    toColumn\n  );\n  dispatch({ type: 'ADD_TASK_ACTION', payload: action });\n};\n\nexport const logTaskAssigned = (\n  dispatch: any,\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  taskTitle: string,\n  userId: string,\n  userName: string,\n  assigneeName: string\n) => {\n  const action = createTaskAction(\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    'assigned',\n    `Назначен исполнитель \"${assigneeName}\" для задачи \"${taskTitle}\"`\n  );\n  dispatch({ type: 'ADD_TASK_ACTION', payload: action });\n};\n\nexport const logTaskAssigneesChanged = (\n  dispatch: any,\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  taskTitle: string,\n  userId: string,\n  userName: string,\n  oldAssignees: string[],\n  newAssignees: string[]\n) => {\n  const added = newAssignees.filter(name => !oldAssignees.includes(name));\n  const removed = oldAssignees.filter(name => !newAssignees.includes(name));\n  \n  let description = `Изменены исполнители задачи \"${taskTitle}\"`;\n  if (added.length > 0) {\n    description += `. Добавлены: ${added.join(', ')}`;\n  }\n  if (removed.length > 0) {\n    description += `. Удалены: ${removed.join(', ')}`;\n  }\n  \n  const action = createTaskAction(\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    'assigned',\n    description,\n    oldAssignees.join(', '),\n    newAssignees.join(', ')\n  );\n  dispatch({ type: 'ADD_TASK_ACTION', payload: action });\n};\n\nexport const logTaskUnassigned = (\n  dispatch: any,\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  taskTitle: string,\n  userId: string,\n  userName: string,\n  assigneeName: string\n) => {\n  const action = createTaskAction(\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    'unassigned',\n    `Снят исполнитель \"${assigneeName}\" с задачи \"${taskTitle}\"`\n  );\n  dispatch({ type: 'ADD_TASK_ACTION', payload: action });\n};\n\nexport const logTaskStatusChanged = (\n  dispatch: any,\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  taskTitle: string,\n  userId: string,\n  userName: string,\n  oldStatus: string,\n  newStatus: string\n) => {\n  const action = createTaskAction(\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    'status_changed',\n    `Изменен статус задачи \"${taskTitle}\" с \"${oldStatus}\" на \"${newStatus}\"`,\n    oldStatus,\n    newStatus\n  );\n  dispatch({ type: 'ADD_TASK_ACTION', payload: action });\n};\n\nexport const logTaskPriorityChanged = (\n  dispatch: any,\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  taskTitle: string,\n  userId: string,\n  userName: string,\n  oldPriority: string,\n  newPriority: string\n) => {\n  const action = createTaskAction(\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    'priority_changed',\n    `Изменен приоритет задачи \"${taskTitle}\" с \"${oldPriority}\" на \"${newPriority}\"`,\n    oldPriority,\n    newPriority\n  );\n  dispatch({ type: 'ADD_TASK_ACTION', payload: action });\n};\n\nexport const logTaskUpdated = (\n  dispatch: any,\n  taskId: string,\n  boardId: string,\n  projectId: string,\n  taskTitle: string,\n  userId: string,\n  userName: string,\n  changes: TaskAction['changes']\n) => {\n  const changeDescriptions = changes?.map(change => {\n    const fieldNames: Record<string, string> = {\n      title: 'название',\n      description: 'описание',\n      priority: 'приоритет',\n      assignees: 'исполнители',\n      deadline: 'срок выполнения',\n      tags: 'теги'\n    };\n    return `${fieldNames[change.field] || change.field}: \"${change.oldValue}\" → \"${change.newValue}\"`;\n  }) || [];\n  \n  const action = createTaskAction(\n    taskId,\n    boardId,\n    projectId,\n    userId,\n    userName,\n    'updated',\n    `Обновлена задача \"${taskTitle}\": ${changeDescriptions.join(', ')}`,\n    undefined,\n    undefined,\n    changes\n  );\n  dispatch({ type: 'ADD_TASK_ACTION', payload: action });\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2941, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/types/auth.types.ts"],"sourcesContent":["/**\n * Типы для системы аутентификации и авторизации\n * Обеспечивает строгую типизацию и безопасность\n */\n\n// Базовые типы пользователей\nexport type UserRole = 'admin' | 'manager' | 'user';\nexport type UserStatus = 'pending' | 'approved' | 'rejected' | 'suspended';\nexport type SessionStatus = 'active' | 'expired' | 'revoked';\n\n// Интерфейс пользователя\nexport interface User {\n  id: string;\n  name: string;\n  email: string;\n  avatar?: string;\n  role: UserRole;\n  status: UserStatus;\n  isApproved: boolean;\n  lastLoginAt?: Date;\n  createdAt: Date;\n  updatedAt: Date;\n  deletedAt?: Date;\n  \n  // Настройки уведомлений\n  notificationSettings: {\n    email: boolean;\n    telegram: boolean;\n    browser: boolean;\n    taskAssigned: boolean;\n    taskCompleted: boolean;\n    projectUpdates: boolean;\n    deadlineReminders: boolean;\n  };\n  \n  // Telegram интеграция\n  telegramChatId?: number;\n  telegramUsername?: string;\n}\n\n// Интерфейс сессии\nexport interface UserSession {\n  id: string;\n  userId: string;\n  sessionToken: string;\n  refreshToken?: string;\n  ipAddress?: string;\n  userAgent?: string;\n  status: SessionStatus;\n  expiresAt: Date;\n  createdAt: Date;\n  lastActivityAt: Date;\n}\n\n// DTO для регистрации\nexport interface RegisterDto {\n  name: string;\n  email: string;\n  password: string;\n  confirmPassword: string;\n}\n\n// DTO для входа\nexport interface LoginDto {\n  email: string;\n  password: string;\n  rememberMe?: boolean;\n}\n\n// DTO для обновления профиля\nexport interface UpdateProfileDto {\n  name?: string;\n  avatar?: string;\n  notificationSettings?: Partial<User['notificationSettings']>;\n  telegramUsername?: string;\n}\n\n// DTO для смены пароля\nexport interface ChangePasswordDto {\n  currentPassword: string;\n  newPassword: string;\n  confirmPassword: string;\n}\n\n// Ответ аутентификации\nexport interface AuthResponse {\n  user: User;\n  accessToken: string;\n  refreshToken?: string;\n  expiresIn: number;\n}\n\n// Контекст аутентификации\nexport interface AuthContextType {\n  user: User | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  login: (credentials: LoginDto) => Promise<AuthResponse>;\n  register: (userData: RegisterDto) => Promise<{ success: boolean; message: string }>;\n  logout: () => Promise<void>;\n  updateProfile: (data: UpdateProfileDto) => Promise<User>;\n  changePassword: (data: ChangePasswordDto) => Promise<{ success: boolean; message: string }>;\n  refreshToken: () => Promise<AuthResponse | null>;\n  checkAuth: () => Promise<void>;\n}\n\n// Права доступа\nexport interface Permission {\n  id: string;\n  name: string;\n  description: string;\n  resource: string;\n  action: string;\n}\n\n// Роль пользователя с правами\nexport interface UserRoleWithPermissions {\n  id: string;\n  name: string;\n  description: string;\n  permissions: Permission[];\n  isDefault: boolean;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// Проверка прав доступа\nexport interface AccessControl {\n  canViewProject: (projectId: string, userId: string) => Promise<boolean>;\n  canEditProject: (projectId: string, userId: string) => Promise<boolean>;\n  canDeleteProject: (projectId: string, userId: string) => Promise<boolean>;\n  canManageUsers: (userId: string) => Promise<boolean>;\n  canApproveUsers: (userId: string) => Promise<boolean>;\n  canViewAdminPanel: (userId: string) => Promise<boolean>;\n}\n\n// Ошибки аутентификации\nexport class AuthError extends Error {\n  constructor(\n    message: string,\n    public code: string,\n    public statusCode: number = 401\n  ) {\n    super(message);\n    this.name = 'AuthError';\n  }\n}\n\n// Типы ошибок\nexport const AUTH_ERROR_CODES = {\n  INVALID_CREDENTIALS: 'INVALID_CREDENTIALS',\n  USER_NOT_FOUND: 'USER_NOT_FOUND',\n  USER_NOT_APPROVED: 'USER_NOT_APPROVED',\n  USER_SUSPENDED: 'USER_SUSPENDED',\n  EMAIL_ALREADY_EXISTS: 'EMAIL_ALREADY_EXISTS',\n  INVALID_TOKEN: 'INVALID_TOKEN',\n  TOKEN_EXPIRED: 'TOKEN_EXPIRED',\n  SESSION_EXPIRED: 'SESSION_EXPIRED',\n  INSUFFICIENT_PERMISSIONS: 'INSUFFICIENT_PERMISSIONS',\n  PASSWORD_TOO_WEAK: 'PASSWORD_TOO_WEAK',\n  INVALID_EMAIL_FORMAT: 'INVALID_EMAIL_FORMAT'\n} as const;\n\nexport type AuthErrorCode = typeof AUTH_ERROR_CODES[keyof typeof AUTH_ERROR_CODES];\n\n// Валидация\nexport interface ValidationResult {\n  isValid: boolean;\n  errors: string[];\n}\n\n// Утилиты для валидации\nexport interface AuthValidators {\n  validateEmail: (email: string) => ValidationResult;\n  validatePassword: (password: string) => ValidationResult;\n  validateName: (name: string) => ValidationResult;\n  validatePasswordMatch: (password: string, confirmPassword: string) => ValidationResult;\n}"],"names":[],"mappings":"AAAA;;;CAGC,GAED,6BAA6B;;;;;AAoItB,MAAM,kBAAkB;;;IAC7B,YACE,OAAe,EACf,AAAO,IAAY,EACnB,AAAO,aAAqB,GAAG,CAC/B;QACA,KAAK,CAAC,eAHC,OAAA,WACA,aAAA;QAGP,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAGO,MAAM,mBAAmB;IAC9B,qBAAqB;IACrB,gBAAgB;IAChB,mBAAmB;IACnB,gBAAgB;IAChB,sBAAsB;IACtB,eAAe;IACf,eAAe;IACf,iBAAiB;IACjB,0BAA0B;IAC1B,mBAAmB;IACnB,sBAAsB;AACxB","debugId":null}},
    {"offset": {"line": 2979, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/axele/Downloads/encore-tasks/encore-tasks-main/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { AppProvider } from \"@/contexts/AppContext\";\nimport { Layout } from \"@/components/Layout\";\nimport { KanbanBoard } from \"@/components/KanbanBoard\";\nimport { NotificationProvider } from \"@/components/notifications\";\n\nexport default function Page() {\n  return (\n    <AppProvider data-oid=\"ih2_dzp\">\n      <NotificationProvider>\n        <Layout data-oid=\"zy0y3-c\">\n          <KanbanBoard data-oid=\":_ayqqp\" />\n        </Layout>\n      </NotificationProvider>\n    </AppProvider>);\n\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AAAA;AALA;;;;;;AAOe,SAAS;IACtB,qBACE,6LAAC,iIAAA,CAAA,cAAW;QAAC,YAAS;kBACpB,cAAA,6LAAC,4JAAA,CAAA,uBAAoB;sBACnB,cAAA,6LAAC,+HAAA,CAAA,SAAM;gBAAC,YAAS;0BACf,cAAA,6LAAC,oIAAA,CAAA,cAAW;oBAAC,YAAS;;;;;;;;;;;;;;;;;;;;;AAKhC;KAVwB","debugId":null}}]
}